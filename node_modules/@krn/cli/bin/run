#!/usr/bin/env node

function sleep(time) {
    return new Promise((resolve) => {
        setTimeout(() => {
            resolve();
        }, time);
    });
}

const isCIEnvironment = () => !!process.env.JENKINS_URL;

require('@oclif/command')
    .run()
    .then(require('@oclif/command/flush'))
    .catch(async (err) => {
        if (!isCIEnvironment()) {
            return require('@oclif/errors/handle')(err);
        } else {
            console.log('[CI Environment] Build failed');
            console.log(err.stack);
            await sleep(5000);
        }
    });
