[文档地址](https://ks-frontend-live-krn-bridge-doc.kproxy.corp.kuaishou.com/)

## 分类
* [krn 公共](https://ks-frontend-live-krn-bridge-doc.kproxy.corp.kuaishou.com/modules/common.html)
* [直播公共](https://ks-frontend-live-krn-bridge-doc.kproxy.corp.kuaishou.com/modules/liveCommon.html)
* [直播间公共](https://ks-frontend-live-krn-bridge-doc.kproxy.corp.kuaishou.com/modules/liveStream.html)
* [直播间主播侧](https://ks-frontend-live-krn-bridge-doc.kproxy.corp.kuaishou.com/modules/liveStreamStreamer.html)
* [直播间观众侧](https://ks-frontend-live-krn-bridge-doc.kproxy.corp.kuaishou.com/modules/liveStreamViewer.html)
* [直播开播页](https://ks-frontend-live-krn-bridge-doc.kproxy.corp.kuaishou.com/modules/liveEntrance.html)

## 安装
```bash
## npm
npm config set registry https://npm.corp.kuaishou.com/
npm install @krn/live-bridge -save

## yarn
yarn config set registry https://npm.corp.kuaishou.com/
yarn add @krn/live-bridge
```

## 初始化
```tsx
import bridge from '@krn/live-bridge';
import { IInitAPPProps } from '@krn/live-bridge/dist/common';
import { IInitLiveAPPProps } from '@krn/live-bridge/dist/liveStream';

// 非直播间页面
const App = (props: IInitAPPProps ) => {
    bridge.init(props); // 初始化
    return (<View/>)
};

// 直播间页面
const LiveApp = (props: IInitLiveAPPProps ) => {
    bridge.init(props); // 初始化
    return (<View/>)
};
```

## 调用
```ts
import bridge from "@krn/live-bridge";

// KRN 公共 bridge, 快手 app 内可用
bridge.common.forExample();

// 直播公共可用
bridge.liveCommon.forExample();

// 直播开播页可用
bridge.liveEntrance.forExample();

// 直播间可用
bridge.liveStream.forExample();

// 直播间主播侧可用
bridge.liveStreamStreamer.forExample();

// 直播间观众侧可用
bridge.liveStreamViewer.forExample();
```

## Demo
<img src="media/demo-video.gif" width="30%"/>

### 打开直播间扫码功能
按文档操作：[直播间内如何调试KRN页面](https://docs.corp.kuaishou.com/k/home/VYWHX1gtle8E/fcAAvqi7uCsyFYo3N6cQSzF2c?ro=false)
### 拉取 Demo Bundle
使用直播间扫码拉取 Demo Bundle
* android

<img src="http://keep.corp.kuaishou.com/api/common/qrcode/text?url=kwai://krn_download?data={%22md5%22:%20%222b4cb12d601a03eb438ae207d525f94c%22,%20%22zipMd5%22:%20%22f37accebc08e46507a62015ebc677b4e%22,%20%22url%22:%20%22https://js.a.kspkg.com/kos/nlav10814/client_android_livebridgedemo_2b4cb12d601a03eb438ae207d525f94c_12_677b4e.png%22,%20%22bundleId%22:%20%22livebridgedemo%22,%20%22rnVersion%22:%20%220.62.2%22,%20%22version%22:%20%220.0.12%22,%20%22versionCode%22:%2012,%20%22scheme%22:%20%22kwai%3A//krn%3FbundleId%3Dlivebridgedemo%26componentName%3D%22,%20%22platform%22:%20%22android%22}&box_size=10" width="30%"/>

* ios

<img src="http://keep.corp.kuaishou.com/api/common/qrcode/text?url=kwai://krn_download?data={%22md5%22:%20%225399b57e07c7fdd16c0aaddb426b6efe%22,%20%22zipMd5%22:%20%22a9d968d79c296d476642a7fac7fe750e%22,%20%22url%22:%20%22https://js.a.kspkg.com/kos/nlav10814/client_ios_livebridgedemo_5399b57e07c7fdd16c0aaddb426b6efe_12_fe750e.png%22,%20%22bundleId%22:%20%22livebridgedemo%22,%20%22rnVersion%22:%20%220.62.2%22,%20%22version%22:%20%220.0.12%22,%20%22versionCode%22:%2012,%20%22scheme%22:%20%22kwai%3A//krn%3FbundleId%3Dlivebridgedemo%26componentName%3D%22,%20%22platform%22:%20%22ios%22}&box_size=10" width="30%"/>

### 直播间扫码打开 Demo

<img src="media/demo-page.png" width="30%"/>

## Todo
* 对接 yoda；
* 对接 bridge center;

## 文档
* [KDS](https://kds-doc.webdev.test.gifshow.com/kds-react/api/01-%E5%8F%91%E9%80%81%E4%BA%8B%E4%BB%B6.html)
* [Yoda](https://yoda.corp.kuaishou.com/docs/)
* [直播 Bridge](http://live-client.corp.kuaishou.com/js-api/)

## Change Log
* V0.0.32  [ 2022年7月1日 ]
>  修改多人PK Bridge 参数名
* V0.0.31  [ 2022年6月17日 ]
>  增加直播间特效资源下载桥getMaterialResourcePath
* V0.0.28  [ 2022年4月21日 ]
>  增加直播间全屏页曝光埋点接口logLivePageEnter
* V0.0.27  [ 2022年04月11日 ]
>  增加批量获取资源路径batchFetchResourcePath 
* V 0.0.26 [ 2022年04月7日 ]
>  开始多人PKBridge- startMultiPK 2 新增监听直播间在线互动用户信息channel-onlineInteractiveUsers </br>

* V 0.0.23-0.0.25废弃 [ 2022年04月7日 ]

* V 0.0.22 [ 2022年02月24日 ]
> 新增 getStoreage泛型 </br>
> mobileQuickLoginInfo 返回值phoneNumber类型修改为string </br>

* V 0.0.21 [ 2022年02月23日 ]
> followUser增加一个选项参数 bizCustomParams, 一键登录信息 mobileQuickLoginInfo</br>

* V 0.0.20 [ 2022年02月09日 ]
> 新增 popPage </br>

* V 0.0.19 [ 2022年01月26日 ]
> logger 支持 Task 埋点</br>

* V 0.0.18 [ 2022年01月24日 ]
> sendGiftToAnchor 和 logger 参数和返回值更新</br>

* V 0.0.17 [ 2022年01月21日 ]
> openCustomH5 入参 dismissTouchOutside 调整为 enableClickOutsideDismiss</br>

* V 0.0.16 [ 2022年01月11日 ]
> 增加获取余额 queryWalletBalance </br>

* V 0.0.15 [ 2022年01月06日 ]
> 增加主播送礼 sendGiftToAnchor </br>
> dispatchLiveRouter 标记废弃 </br>
> 优化未初始化报错日志 </br>
> 优化信令枚举导出方式 </br>

* V 0.0.14 [ 2021年12月28日 ]
> 新增PK相关Bridge </br>

* V 0.0.13 [ 2021年12月16日 ]
> 兼容低版本 app 本地 server 无 onCreateTimestamp 问题 </br>

* V 0.0.12 [ 2021年12月11日 ]
> 增加 openWithInfo 方法 </br>

* V 0.0.11 [ 2021年12月6日 ]
> 兼容 liveStream.logger 参数 contentPackage 不能为 undefined 的问题</br>

* V 0.0.10 [ 2021年12月1日 ]
> 增加 open 方法 </br>

* v 0.0.9 [ 2021年11月22日 ]
> 增加客户端[播放特效方法](https://ks-frontend-live-krn-bridge-doc.kproxy.corp.kuaishou.com/modules/liveStream.html#mockEffectInfo) </br>

* v 0.0.8
> 增加获取容器初始化数据的方法 </br>
>```
> // 可同步获取容器初始化参数
> // 公共容器数据结构：IInitAPPProps
> // 直播间容器数据结构: IInitLiveAPPProps
> bridge.getInitData();
>```

* v 0.0.7
> 增加 toast </br>

* v 0.0.6
> 增加退出直播间 </br>

* v 0.0.5
> 增加 Demo 说明</br>
> 增加 [直接加入粉丝团](https://ks-frontend-live-krn-bridge-doc.kproxy.corp.kuaishou.com/modules/liveStreamViewer.html#joinFansGroup)</br>

* v 0.0.4
> 直播 bridge 执行结果为字符串时 JSON.parse 处理 </br>
> 优化 Interface 导出方式 </br>

* v 0.0.3
> bridge.common.request 返回值为字符串时 JSON.parse 处理</br>
> 新增[城市选择组件](https://ks-frontend-live-krn-bridge-doc.kproxy.corp.kuaishou.com/modules/common.html#selectCity) </br>

* v 0.0.2
> [直播间信令订阅](https://ks-frontend-live-krn-bridge-doc.kproxy.corp.kuaishou.com/modules/liveStream.html#subscribeSocketMessage) </br>
> [直播间信令取消订阅](https://ks-frontend-live-krn-bridge-doc.kproxy.corp.kuaishou.com/modules/liveStream.html#unsubscribeSocketMessage) </br>
> [krn 可用性测试 T1 埋点](https://ks-frontend-live-krn-bridge-doc.kproxy.corp.kuaishou.com/modules/common.html#reportAppDidMount) </br>

* v 0.0.1
> 直播业务 bridge 已全量支持；</br>
> kds bridge 部分支持；</br>
> bridge center 待支持；</br>
