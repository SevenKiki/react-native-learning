import { invoke } from '@kds/bridge-lite';
import { Linking } from 'react-native';

export default (phoneArr: Array<string>) => {
    if (!phoneArr || !phoneArr.length) {
        return;
    }
    const phoneOptions = phoneArr.map((item) => {
        return {
            text: `呼叫 ${item}`,
            value: 'tel:' + item,
            type: 0 as any,
        };
    });
    return invoke('ui.showBottomSheet', {
        options: phoneOptions,
        title: ''
    })
        .then(
            (res) => {
                const tel = res.value;
                Linking.canOpenURL(tel).then((supported) => {
                    if (!supported) {
                        console.log('Can not handle tel:' + tel);
                    } else {
                        return Linking.openURL(tel);
                    }
                });
            },
            (err) => {
                console.log('调用失败:');
                console.log(err);
            },
        )
        .catch((e) => {
            console.log('调用出错:');
            console.log(e);
        });
};
