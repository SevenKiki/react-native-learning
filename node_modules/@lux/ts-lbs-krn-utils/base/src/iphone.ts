import { Dimensions, Platform, StatusBar } from 'react-native';
// https://git.corp.kuaishou.com/kds/third-party-component/js-third-party-component/react-native-iphone-x-helper/-/blob/master/index.js
// prettier-ignore
const checkDemension = (size: number) => {
    const window = Dimensions.get('window');
    const windowRes = window.width === size || window.height === size;
    const screen = Dimensions.get('screen');
    const screenRes = screen.width === size || screen.height === size;
    return windowRes || screenRes;
};

export function isIphoneX() {
    return (
        Platform.OS === 'ios' &&
        !Platform.isPad &&
        !Platform.isTV &&
        (checkDemension(780) ||
            checkDemension(812) ||
            checkDemension(844) ||
            checkDemension(896) ||
            checkDemension(926) ||
            checkDemension(852) ||
            checkDemension(932))
    );
}

const checkDimensions = (portraitWidth: number, portraitHeight: number) => {
    const window = Dimensions.get('window');
    const windowRes =
        (window.height === portraitHeight && window.width === portraitWidth) ||
        (window.width === portraitHeight && window.height === portraitWidth);

    const screen = Dimensions.get('screen');
    const screenRes =
        (screen.height === portraitHeight && screen.width === portraitWidth) ||
        (screen.width === portraitHeight && screen.height === portraitWidth);

    return windowRes || screenRes;
};
// 14 Pro, 14 Pro Max
const _isStatusBarHeight59 = () => {
    return checkDimensions(393, 852) || checkDimensions(430, 932);
};

const _getIphoneStatusBarHeight = () => {
    if (isIphoneX()) {
        if (_isStatusBarHeight59()) {
            return 59;
        }
        return 44;
    }
    return 20;
};

export const safeAreaTop = Platform.select({
    ios: _getIphoneStatusBarHeight(),
    android: StatusBar.currentHeight,
    default: 0,
});

export const safeAreaBottom = isIphoneX() ? 34 : 0;
