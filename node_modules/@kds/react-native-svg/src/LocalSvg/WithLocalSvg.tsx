import React, { Component } from 'react';
import { LocalProps, LocalState } from './common';
import loadLocalRawResource from './loadLocalRawResource';
import SvgWithCss from '../css/SvgWithCss';


export class WithLocalSvg extends Component<LocalProps, LocalState> {
    state = { xml: null };
    componentDidMount() {
        this.load(this.props.asset);
    }
    componentDidUpdate(prevProps: { asset?: string | number }) {
        const { asset } = this.props;
        if (asset !== prevProps.asset) {
            this.load(asset);
        }
    }
    async load(asset?: string | number) {
        try {
            this.setState({ xml: asset ? await loadLocalRawResource(asset) : null });
        } catch (e) {
            console.error(e);
        }
    }
    render() {
        const {
            props,
            state: { xml },
        } = this;
        return <SvgWithCss xml={xml} override={props} />;
    }
}

export default WithLocalSvg;