import React, { Component } from 'react';
import { UriProps, UriState, fetchText } from '../xml/common';
import SvgWithCss from './SvgWithCss';

export class SvgWithCssUri extends Component<UriProps, UriState> {
    state = { xml: null };
    componentDidMount() {
        this.fetch(this.props.uri);
    }
    componentDidUpdate(prevProps: { uri: string | null }) {
        const { uri } = this.props;
        if (uri !== prevProps.uri) {
            this.fetch(uri);
        }
    }
    async fetch(uri: string | null) {
        try {
            this.setState({ xml: uri ? await fetchText(uri) : null });
        } catch (e) {
            console.error(e);
        }
    }
    render() {
        const {
            props,
            state: { xml },
        } = this;
        return <SvgWithCss xml={xml} override={props} />;
    }
}

export default SvgWithCss;