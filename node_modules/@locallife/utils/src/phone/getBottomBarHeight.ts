import { NativeModules, Platform } from 'react-native';
import { isIphoneX } from './isIphoneX';

/**
 * 获取bottom bar的高度
 * @returns bottom bar高度
 */
export function getBottomBarHeight(
    rootTag: number,
    callback: (height: number) => void,
) {
    if (Platform.OS === 'ios') {
        return isIphoneX() ? 34 : 0;
    } else if (Platform.OS === 'android') {
        NativeModules.Kds.invoke(
            'system',
            'isBottomNavigationBarShown',
            JSON.stringify({
                rootTag,
            }),
        )
            .then((res) => {
                if (res.shown === true) {
                    NativeModules.Kds.invoke(
                        'system',
                        'getNavigationBarHeight',
                        JSON.stringify({
                            rootTag,
                        }),
                    )
                        .then((navBarRes) => {
                            callback(navBarRes.height);
                        })
                        .catch((e) => {
                            console.log('getNavigationBarHeight' + e);
                        });
                }
            })
            .catch((e) => {
                console.log('isBottomNavigationBarShown' + e);
            });
    }
}
