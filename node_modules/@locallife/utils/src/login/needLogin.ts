import { NativeModules } from 'react-native';
import { logException } from '../log/logException';
import { isUserLogin } from './isUserLogin';

/**
 * 跳转登陆页面，登陆成功后执行callback
 * @param callback 登陆后继续做的操作
 */
export function needLogin(onSuccess: () => void, onFail?: () => void) {
    if (!isUserLogin()) {
        NativeModules.Kds.invoke('social', 'login', null)
            .then(onSuccess)
            .catch((e) => {
                logException('登录失败', JSON.stringify(e));
                onFail?.();
            });
    } else {
        onSuccess();
    }
}
