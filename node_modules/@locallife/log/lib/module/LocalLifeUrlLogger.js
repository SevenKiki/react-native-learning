import { NativeModules, Platform } from 'react-native';
import AppVersion from './AppVersion';
import LocalLifeCustomLogger from './LocalLifeCustomLogger';
import LocalLifeInitLogger from './LocalLifeInitLogger';
import { VersionUtil } from './VersionUtil';

function inValidVersion() {
  if (Platform.OS === 'android') {
    return VersionUtil.currentGreaterThanEqualVersion(AppVersion.VERSION_11_2_10);
  } else if (Platform.OS === 'ios') {
    return VersionUtil.currentGreaterThanEqualVersion(AppVersion.VERSION_11_3_10);
  }

  return false;
}

export default class LocalLifeUrlLogger {
  static async logUrl(tag, url, desc) {
    try {
      let rootTag = LocalLifeInitLogger.getRootTag();

      if (inValidVersion()) {
        NativeModules.Kds.invoke('poi', 'reportKwaiUrlLog', JSON.stringify({
          tag,
          url,
          desc,
          rootTag
        }));
      } else {
        LocalLifeCustomLogger.logCustomEvent('LOCAL_LIFE_LOG_KWAI_URL', {
          tag,
          url,
          desc
        });
      }

      console.log('[customEventKey: LOCAL_LIFE_LOG_KWAI_URL]' + '[tag:' + tag + '][url:' + url + ']' + '[desc:' + (desc || {}) + ']');
    } catch (e) {
      console.error(`LocalLifeUrlLogger error:${e || ''}`);
    }
  }

}
//# sourceMappingURL=LocalLifeUrlLogger.js.map