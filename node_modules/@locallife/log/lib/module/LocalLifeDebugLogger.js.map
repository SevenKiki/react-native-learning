{"version":3,"names":["NativeModules","Platform","AppVersion","LocalLifeInitLogger","VersionUtil","LoggerType","inValidVersion","OS","currentGreaterThanEqualVersion","VERSION_11_2_10","VERSION_11_3_10","log","logType","tag","msg","params","error","args","message","rootTag","getRootTag","Error","errorInfo","errorStack","stack","toString","JSON","stringify","console","bundleId","componentName","getAppModel","bundleInfo","KRNBasic","getBundleInfo","Kds","invoke","module","logBiz","e","LocalLifeDebugLogger","v","VERBOSE","d","DEBUG","i","INFO","w","WARN","ERROR"],"sources":["LocalLifeDebugLogger.ts"],"sourcesContent":["import { NativeModules, Platform } from 'react-native';\nimport AppVersion from './AppVersion';\nimport LocalLifeInitLogger from './LocalLifeInitLogger';\nimport { VersionUtil } from './VersionUtil';\n\nenum LoggerType {\n    VERBOSE = 1,\n    DEBUG = 2,\n    INFO = 3,\n    WARN = 4,\n    ERROR = 5,\n}\n\nfunction inValidVersion(): boolean {\n    if (Platform.OS === 'android') {\n        return VersionUtil.currentGreaterThanEqualVersion(\n            AppVersion.VERSION_11_2_10,\n        );\n    } else if (Platform.OS === 'ios') {\n        return VersionUtil.currentGreaterThanEqualVersion(\n            AppVersion.VERSION_11_3_10,\n        );\n    }\n    return false;\n}\n\nasync function log(\n    logType: LoggerType,\n    tag: string,\n    msg?: string,\n    params?: object,\n    error?: object,\n) {\n    try {\n        let args = params || {};\n        let message = null;\n        let rootTag = LocalLifeInitLogger.getRootTag();\n        if (error) {\n            if (error instanceof Error) {\n                args = {\n                    ...args,\n                    errorInfo: error.message,\n                    errorStack: error.stack,\n                };\n                if (!msg) {\n                    message = error.toString();\n                }\n            } else {\n                args = { ...args, errorInfo: JSON.stringify(error) };\n                if (!msg) {\n                    console.log('传入的error非Error类型,请传递msg字段!!');\n                }\n            }\n        }\n\n        let { bundleId, componentName } =\n            LocalLifeInitLogger.getAppModel() || {};\n        if (!bundleId || !componentName) {\n            let bundleInfo = NativeModules.KRNBasic.getBundleInfo(rootTag);\n            bundleId = bundleInfo.bundleId;\n            componentName = bundleInfo.componentName;\n        }\n        args = { ...args, bundleId, componentName };\n        if (inValidVersion()) {\n            NativeModules.Kds.invoke(\n                'poi',\n                'printLocalLifeLog',\n                JSON.stringify({\n                    logType,\n                    module: '[KSLocalLife_RN]',\n                    logBiz: `BundleId_${bundleId}`,\n                    tag,\n                    msg: msg || message || '',\n                    params: args || {},\n                    rootTag,\n                }),\n            );\n        }\n        console.log(\n            '[logBiz:BundleId_' +\n                bundleId +\n                '][tag:' +\n                tag +\n                '][msg:' +\n                (msg || message) +\n                ']' +\n                '[params:' +\n                JSON.stringify(args || {}) +\n                ']',\n        );\n    } catch (e) {\n        console.error(`LocalLifeLogger error:${e || ''}`);\n    }\n}\n\nexport default class LocalLifeDebugLogger {\n    static async v(tag: string, message?: string, params?: object) {\n        log(LoggerType.VERBOSE, tag, message, params, null);\n    }\n\n    static async d(tag: string, message?: string, params?: object) {\n        log(LoggerType.DEBUG, tag, message, params, null);\n    }\n\n    static async i(tag: string, message?: string, params?: object) {\n        log(LoggerType.INFO, tag, message, params, null);\n    }\n\n    static async w(tag: string, message?: string, params?: object) {\n        log(LoggerType.WARN, tag, message, params, null);\n    }\n\n    static async e(\n        tag: string,\n        message: string,\n        params?: object,\n        error?: object,\n    ) {\n        log(LoggerType.ERROR, tag, message, params, error);\n    }\n}\n"],"mappings":"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"}