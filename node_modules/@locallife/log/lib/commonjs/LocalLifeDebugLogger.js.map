{"version":3,"names":["LoggerType","inValidVersion","Platform","OS","VersionUtil","currentGreaterThanEqualVersion","AppVersion","VERSION_11_2_10","VERSION_11_3_10","log","logType","tag","msg","params","error","args","message","rootTag","LocalLifeInitLogger","getRootTag","Error","errorInfo","errorStack","stack","toString","JSON","stringify","console","bundleId","componentName","getAppModel","bundleInfo","NativeModules","KRNBasic","getBundleInfo","Kds","invoke","module","logBiz","e","LocalLifeDebugLogger","v","VERBOSE","d","DEBUG","i","INFO","w","WARN","ERROR"],"sources":["LocalLifeDebugLogger.ts"],"sourcesContent":["import { NativeModules, Platform } from 'react-native';\nimport AppVersion from './AppVersion';\nimport LocalLifeInitLogger from './LocalLifeInitLogger';\nimport { VersionUtil } from './VersionUtil';\n\nenum LoggerType {\n    VERBOSE = 1,\n    DEBUG = 2,\n    INFO = 3,\n    WARN = 4,\n    ERROR = 5,\n}\n\nfunction inValidVersion(): boolean {\n    if (Platform.OS === 'android') {\n        return VersionUtil.currentGreaterThanEqualVersion(\n            AppVersion.VERSION_11_2_10,\n        );\n    } else if (Platform.OS === 'ios') {\n        return VersionUtil.currentGreaterThanEqualVersion(\n            AppVersion.VERSION_11_3_10,\n        );\n    }\n    return false;\n}\n\nasync function log(\n    logType: LoggerType,\n    tag: string,\n    msg?: string,\n    params?: object,\n    error?: object,\n) {\n    try {\n        let args = params || {};\n        let message = null;\n        let rootTag = LocalLifeInitLogger.getRootTag();\n        if (error) {\n            if (error instanceof Error) {\n                args = {\n                    ...args,\n                    errorInfo: error.message,\n                    errorStack: error.stack,\n                };\n                if (!msg) {\n                    message = error.toString();\n                }\n            } else {\n                args = { ...args, errorInfo: JSON.stringify(error) };\n                if (!msg) {\n                    console.log('传入的error非Error类型,请传递msg字段!!');\n                }\n            }\n        }\n\n        let { bundleId, componentName } =\n            LocalLifeInitLogger.getAppModel() || {};\n        if (!bundleId || !componentName) {\n            let bundleInfo = NativeModules.KRNBasic.getBundleInfo(rootTag);\n            bundleId = bundleInfo.bundleId;\n            componentName = bundleInfo.componentName;\n        }\n        args = { ...args, bundleId, componentName };\n        if (inValidVersion()) {\n            NativeModules.Kds.invoke(\n                'poi',\n                'printLocalLifeLog',\n                JSON.stringify({\n                    logType,\n                    module: '[KSLocalLife_RN]',\n                    logBiz: `BundleId_${bundleId}`,\n                    tag,\n                    msg: msg || message || '',\n                    params: args || {},\n                    rootTag,\n                }),\n            );\n        }\n        console.log(\n            '[logBiz:BundleId_' +\n                bundleId +\n                '][tag:' +\n                tag +\n                '][msg:' +\n                (msg || message) +\n                ']' +\n                '[params:' +\n                JSON.stringify(args || {}) +\n                ']',\n        );\n    } catch (e) {\n        console.error(`LocalLifeLogger error:${e || ''}`);\n    }\n}\n\nexport default class LocalLifeDebugLogger {\n    static async v(tag: string, message?: string, params?: object) {\n        log(LoggerType.VERBOSE, tag, message, params, null);\n    }\n\n    static async d(tag: string, message?: string, params?: object) {\n        log(LoggerType.DEBUG, tag, message, params, null);\n    }\n\n    static async i(tag: string, message?: string, params?: object) {\n        log(LoggerType.INFO, tag, message, params, null);\n    }\n\n    static async w(tag: string, message?: string, params?: object) {\n        log(LoggerType.WARN, tag, message, params, null);\n    }\n\n    static async e(\n        tag: string,\n        message: string,\n        params?: object,\n        error?: object,\n    ) {\n        log(LoggerType.ERROR, tag, message, params, error);\n    }\n}\n"],"mappings":"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"}