{"version":3,"names":["React","View","Text","TouchableWithoutFeedback","isUserLogin","needLogin","showToast","KwaiImage","styles","isEligibility","ShowWithData","NewUserZoneEntrance","memo","entranceData","_entranceData$data","_entranceData$data2","_entranceData$data2$p","_entranceData$data3","_entranceData$data3$p","_entranceData$data3$p2","doCheckEligibility","source","then","result","data","newUser","handleClick","_entranceData$refresh","refreshData","call","catch","entranceHandleClick","icon","createElement","onPress","style","rootContainer","contentContainerStyle","bgStyle","uri","resizeMode","disCountArea","disCountAreaStyle","disCountContentType","disCountContentTypeStyle","params","price","disCountContent","disCountContentStyle","subIcons","length","disCountTitleImg","disCountTitleImgStyle"],"sources":["index.tsx"],"sourcesContent":["import React from 'react';\nimport {\n    StyleProp,\n    View,\n    ViewStyle,\n    Text,\n    ImageStyle,\n    TouchableWithoutFeedback,\n} from 'react-native';\nimport { isUserLogin, needLogin, showToast } from '@locallife/utils';\nimport KwaiImage from '@kds/image';\n\nimport styles from './styles';\nimport { CheckIsNewUserResp, isEligibility } from './api';\nimport { ShowWithData } from '@locallife/base-component';\n\ninterface ContentData {\n    subIcons: string[]; // 折扣价后跟随折扣名图片\n    price: string; // 折扣价\n}\n\ninterface FetchEntraceData {\n    id?: string;\n    attributeType?: number;\n    params?: ContentData;\n    icon?: string;\n}\n\ninterface EntranceData {\n    data: FetchEntraceData;\n    refreshData?: () => void; // 刷新数据处理\n    handleClick: (isAllowJump) => void; // 处理点击事件\n    contentContainerStyle?: StyleProp<ViewStyle>; // 根容器Style\n    bgStyle?: StyleProp<ImageStyle>; // 背景图Style\n    disCountAreaStyle?: StyleProp<ViewStyle>; // 信息区域Style\n    disCountContentTypeStyle?: StyleProp<ViewStyle>; // 折扣价格$Style\n    disCountContentStyle?: StyleProp<ViewStyle>; // 折扣价格Style\n    disCountTitleImgStyle?: StyleProp<ImageStyle>; // 折扣名称Img Style\n}\n\n/**\n * 新人专区入口\n *      货架列表页Banner位置\n *      POI页\n */\nexport const NewUserZoneEntrance = React.memo((entranceData: EntranceData) => {\n    function doCheckEligibility() {\n        // 核验资格\n        isEligibility({\n            source: 1, // banner检查是否新用户取source=1的固定值\n        })\n            .then((result: CheckIsNewUserResp) => {\n                if (result?.data) {\n                    if (result.data.newUser) {\n                        // 有资格\n                        entranceData.handleClick(true);\n                    } else {\n                        // 无资格\n                        entranceData.handleClick(false);\n                        // 提示\n                        showToast('您当前不满足新用户身份哦，看看其他商品吧。');\n                        // 刷新\n                        entranceData.refreshData?.();\n                    }\n                } else {\n                    // 数据返回异常\n                    showToast('数据异常，请重试。');\n                }\n            })\n            .catch(() => {\n                // 异常提示\n                showToast('网络异常，请重试。');\n            });\n    }\n\n    function entranceHandleClick() {\n        if (isUserLogin()) {\n            // 已经登录\n            doCheckEligibility();\n        } else {\n            // 未登录，不跳转\n            entranceData.handleClick(false);\n            // 唤起登录页面\n            needLogin(\n                () => {\n                    // 成功登录\n                    doCheckEligibility();\n                },\n                () => {\n                    // 登录失败，不做处理\n                },\n            );\n        }\n    }\n\n    return entranceData.data?.icon ? (\n        // eslint-disable-next-line react/jsx-no-bind\n        <TouchableWithoutFeedback onPress={entranceHandleClick}>\n            <View\n                style={[\n                    styles.rootContainer,\n                    entranceData.contentContainerStyle,\n                ]}\n            >\n                {/* 背景图 */}\n                <KwaiImage\n                    style={[styles.bgStyle, entranceData.bgStyle]}\n                    source={{ uri: entranceData.data.icon }}\n                    resizeMode={'cover'}\n                >\n                    <View\n                        style={[\n                            styles.disCountArea,\n                            entranceData.disCountAreaStyle,\n                        ]}\n                    >\n                        {/* 货币类型 */}\n                        <Text\n                            style={[\n                                styles.disCountContentType,\n                                entranceData.disCountContentTypeStyle,\n                            ]}\n                        >\n                            {'¥'}\n                        </Text>\n                        {/* 折扣价格 */}\n                        <ShowWithData data={entranceData.data?.params?.price}>\n                            <Text\n                                style={[\n                                    styles.disCountContent,\n                                    entranceData.disCountContentStyle,\n                                ]}\n                            >\n                                {entranceData.data.params.price}\n                            </Text>\n                        </ShowWithData>\n                        {/* 折扣类型img */}\n                        <ShowWithData\n                            data={\n                                entranceData.data?.params?.subIcons?.length > 0\n                            }\n                        >\n                            <KwaiImage\n                                style={[\n                                    styles.disCountTitleImg,\n                                    entranceData.disCountTitleImgStyle,\n                                ]}\n                                source={{\n                                    uri: entranceData.data.params.subIcons[0],\n                                }}\n                                resizeMode={'cover'}\n                            />\n                        </ShowWithData>\n                    </View>\n                </KwaiImage>\n            </View>\n        </TouchableWithoutFeedback>\n    ) : (\n        <View />\n    );\n});\n"],"mappings":"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"}