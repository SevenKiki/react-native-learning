{"version":3,"names":["React","useMemo","View","Text","TouchableOpacity","KidIcon","styles","CommonText","dayjs","REFUNDED_RULE","BUY_LIMIT_RULE","screenUnit","VALIDATE_RULE","USE_TIME_RULE","formatTime","date","format","formatUseTime","useTimeArr","Array","isArray","useTimeStr","i","length","item","startTime","endTime","push","join","PurchaseInfo","_ref","_productData$itemShow","_productData$itemShow2","_productData$itemShow3","_productData$itemShow4","_productData$itemShow5","_productData$itemShow6","_productData$itemRule","_productData$itemRule2","_productData$itemRule3","_productData$itemShow7","_productData$itemRule4","_productData$itemRule5","_productData$itemShow8","_productData$itemShow9","productData","handleShowAlert","validTimeRule","itemShowRule","itemValidRule","expiryDateText","type","CUSTOM_TIME","AFTER_BUY_LIMIT_DAY","afterBuyLimitDay","FROM_TIME_LIMIT_DAY","fromTime","limitDay","useTimeRule","useTimeRuleText","OPENING_HOURS","typeDesc","CUSTOM_USE_TIME","specialConditionStr","specialCondition","useTime","refundRule","refundText","unavailableTime","itemRuleDTO","useRule","invalidDateTextList","invalidDateTextArr","holidays","weeks","customTimeArr","customTimes","customTimeStr","reservationRule","purchaseNotesRule","reservationText","reservationFlag","buyLimitRules","buyLimitRule","limitText","limitTextArr","map","rules","buyLimitType","_BUY_LIMIT_RULE$type","text","forEach","key","replace","useRuleTextList","useRuleTextArr","instruction","instructionList","split","filter","concat","useScopeLimit","singleUseLimit","handleShowPopup","getSubView","title","content","createElement","Fragment","customizationUlPoint","style","subtitle","subContentLine","subContentDistance","subContent","container","packageDetailItemWrapper","invalidDateText","useRuleText","activeOpacity","onPress","priceItemContianer","rowFlexAlignCenter","kid","kidColor","size","screenSize","priceItemArrow"],"sources":["index.tsx"],"sourcesContent":["import React, { useMemo } from 'react';\nimport { View, Text, TouchableOpacity } from 'react-native';\nimport { KidIcon } from '@kid-ui/krn';\nimport styles from './styles';\nimport CommonText from '../commonText';\nimport { IProductData } from './types';\nimport dayjs from 'dayjs';\nimport { REFUNDED_RULE, BUY_LIMIT_RULE } from '../../utils/config';\nimport { screenUnit } from '@lux/ts-lbs-krn-utils';\ninterface IProductInfo {\n    productData: IProductData;\n    handleShowAlert: () => void;\n}\n\nenum VALIDATE_RULE {\n    AFTER_BUY_LIMIT_DAY = 'AFTER_BUY_LIMIT_DAY',\n    FROM_TIME_LIMIT_DAY = 'FROM_TIME_LIMIT_DAY',\n    CUSTOM_TIME = 'CUSTOM_TIME',\n}\n\nenum USE_TIME_RULE {\n    OPENING_HOURS = 1,\n    CUSTOM_USE_TIME = 2,\n}\n\n// 时间格式化\nfunction formatTime(date: number) {\n    return dayjs(date).format('YYYY.MM.DD');\n}\n\nfunction formatUseTime(useTimeArr: string[][]) {\n    if (Array.isArray(useTimeArr)) {\n        let useTimeStr = [];\n        for (let i = 0; i < useTimeArr.length && useTimeStr.length <= 5; i++) {\n            const item = useTimeArr[i];\n            if (Array.isArray(item) && item.length === 2) {\n                let startTime = item[0];\n                let endTime = item[1];\n                if (startTime && endTime) {\n                    useTimeStr.push(`${startTime}-${endTime}`);\n                }\n            }\n        }\n        if (useTimeStr.length > 0) {\n            return useTimeStr.join('，');\n        }\n    }\n    return '';\n}\n\n/**\n * 使用须知\n */\nexport const PurchaseInfo = ({\n    productData,\n    handleShowAlert,\n}: IProductInfo) => {\n    /**\n     * 有效期\n     */\n    const validTimeRule =\n        productData?.itemShowRule?.itemValidRule?.validTimeRule;\n\n    const expiryDateText = useMemo(() => {\n        if (validTimeRule?.type === VALIDATE_RULE.CUSTOM_TIME) {\n            const startTime = formatTime(validTimeRule?.startTime);\n            const endTime = formatTime(validTimeRule?.endTime);\n            return `${startTime} 至 ${endTime}`;\n        }\n        if (validTimeRule?.type === VALIDATE_RULE.AFTER_BUY_LIMIT_DAY) {\n            return `购买之日起${validTimeRule?.afterBuyLimitDay}天内可用`;\n        }\n        if (validTimeRule?.type === VALIDATE_RULE.FROM_TIME_LIMIT_DAY) {\n            const fromTime = formatTime(validTimeRule?.fromTime);\n            return `${fromTime}起${validTimeRule?.limitDay}日可用`;\n        }\n    }, [validTimeRule]);\n\n    /**\n     * 可用时间\n     */\n    const useTimeRule = productData?.itemShowRule?.itemValidRule?.useTimeRule;\n    const useTimeRuleText = useMemo(() => {\n        if (useTimeRule?.type === USE_TIME_RULE.OPENING_HOURS) {\n            return `${useTimeRule?.typeDesc ?? '商家营业时间均可使用'}`;\n        }\n        if (useTimeRule?.type === USE_TIME_RULE.CUSTOM_USE_TIME) {\n            const specialConditionStr = useTimeRule?.specialCondition\n                ? useTimeRule?.specialCondition + '\\n'\n                : '';\n            return `${formatUseTime(\n                useTimeRule?.useTime,\n            )}\\n${specialConditionStr}`;\n        }\n        return '';\n    }, [useTimeRule]);\n\n    /**\n     * 退款政策\n     */\n    const refundRule = productData?.itemShowRule?.itemValidRule?.refundRule;\n    const refundText = useMemo(() => {\n        if (!refundRule?.type) {\n            return '';\n        }\n        return REFUNDED_RULE[refundRule.type];\n    }, [refundRule]);\n\n    /**\n     * 不可用日期\n     */\n    const unavailableTime =\n        productData?.itemRuleDTO?.useRule?.useRule?.unavailableTime;\n    const invalidDateTextList = useMemo(() => {\n        const invalidDateTextArr = [];\n        if (\n            unavailableTime?.holidays &&\n            Array.isArray(unavailableTime?.holidays) &&\n            unavailableTime.holidays.length > 0\n        ) {\n            invalidDateTextArr.push(\n                `${unavailableTime.holidays.join('、')}不可用`,\n            );\n        }\n        if (\n            unavailableTime?.weeks &&\n            Array.isArray(unavailableTime?.weeks) &&\n            unavailableTime.weeks.length > 0\n        ) {\n            invalidDateTextArr.push(\n                `${unavailableTime.weeks.join('、')}不可用`,\n            );\n        }\n\n        let customTimeArr = unavailableTime?.customTimes;\n        if (Array.isArray(customTimeArr) && customTimeArr?.length > 0) {\n            const customTimeStr = [];\n            for (\n                let i = 0;\n                i < customTimeArr.length && customTimeStr.length <= 5;\n                i++\n            ) {\n                const item = customTimeArr[i];\n                const startTime = formatTime(item?.startTime);\n                const endTime = formatTime(item?.endTime);\n                invalidDateTextArr.push(`${startTime} 至 ${endTime}`);\n            }\n        }\n        if (unavailableTime?.specialCondition) {\n            invalidDateTextArr.push(`${unavailableTime?.specialCondition}`);\n        }\n\n        return invalidDateTextArr;\n    }, [unavailableTime]);\n\n    // 预约规则\n    const reservationRule =\n        productData.itemShowRule?.purchaseNotesRule.reservationRule;\n    const reservationText = useMemo(() => {\n        if (reservationRule?.reservationFlag) {\n            return '需提前联系店家预约';\n        } else {\n            return '到店消费前，无需预约';\n        }\n    }, [reservationRule]);\n\n    /**\n     * 限购政策\n     */\n    const buyLimitRules = productData?.itemRuleDTO?.buyLimitRule?.buyLimitRules;\n    const limitText = useMemo(() => {\n        const limitTextArr = [];\n        buyLimitRules &&\n            buyLimitRules.map((rules: any) => {\n                const type = rules?.buyLimitType;\n                if (type) {\n                    let text = '';\n                    BUY_LIMIT_RULE[type]?.forEach((item: any) => {\n                        if (rules[item.key]) {\n                            text += (item?.text || '').replace(\n                                /\\{\\s*num\\s*\\}/,\n                                rules[item?.key],\n                            );\n                        }\n                    });\n                    text && limitTextArr.push(text);\n                }\n            });\n        if (!limitTextArr.length) {\n            return '不限购';\n        }\n        return limitTextArr.join('、');\n    }, [buyLimitRules]);\n\n    /**\n     * 使用规则\n     */\n    const useRule = productData?.itemShowRule?.purchaseNotesRule?.useRule;\n    const useRuleTextList = useMemo(() => {\n        let useRuleTextArr = [];\n        // 如果商家编辑了文案，则展示商家文案\n        if (useRule?.instruction) {\n            const instructionList =\n                useRule?.instruction &&\n                useRule?.instruction.split('\\n').filter((item: string) => item);\n            if (instructionList) {\n                useRuleTextArr = useRuleTextArr.concat(instructionList);\n            }\n        } else {\n            // 否则默认展示\n            // 使用范围：XXX\n            // 退款规则：XXX\n            // 单次最多使用XX张团购券\n            if (\n                useRule?.useScopeLimit &&\n                Array.isArray(useRule?.useScopeLimit) &&\n                useRule?.useScopeLimit.length > 0\n            ) {\n                useRuleTextArr.push(\n                    `使用范围：${useRule?.useScopeLimit.join('、')}`,\n                );\n            }\n            if (refundText) {\n                useRuleTextArr.push(`退款规则：${refundText}`);\n            }\n            if (useRule?.singleUseLimit) {\n                useRuleTextArr.push(\n                    `单次最多使用${useRule?.singleUseLimit}张团购券`,\n                );\n            }\n        }\n\n        return useRuleTextArr;\n    }, [useRule, refundText]);\n    // 是否唤起电话弹窗\n    const handleShowPopup = () => {\n        handleShowAlert && handleShowAlert();\n    };\n    const getSubView = (title: string, content?: any) => {\n        return (\n            <>\n                {title && (\n                    <CommonText\n                        customizationUlPoint={styles.customizationUlPoint}\n                    >\n                        <Text style={styles.subtitle}>{title}</Text>\n                    </CommonText>\n                )}\n                {content && (\n                    <View\n                        style={[\n                            styles.subContentLine,\n                            styles.subContentDistance,\n                        ]}\n                    >\n                        <Text style={[styles.subContent]}>{content}</Text>\n                    </View>\n                )}\n            </>\n        );\n    };\n    return (\n        <View style={styles.container}>\n            <Text style={styles.title}>使用须知</Text>\n            {/* 有效期 */}\n            {!!expiryDateText && (\n                <View style={styles.packageDetailItemWrapper}>\n                    {getSubView('有效期', expiryDateText)}\n                </View>\n            )}\n\n            {/* 可用时间 */}\n            {!!useTimeRuleText && (\n                <View style={styles.packageDetailItemWrapper}>\n                    {getSubView('可用时间', useTimeRuleText)}\n                </View>\n            )}\n            {/* 不可用日期 */}\n            {invalidDateTextList.length > 0 && (\n                <View style={[styles.packageDetailItemWrapper]}>\n                    {getSubView('不可用日期')}\n                    {invalidDateTextList &&\n                        invalidDateTextList.length &&\n                        invalidDateTextList.map((invalidDateText) => {\n                            return (\n                                <View style={[styles.subContentDistance]}>\n                                    <Text style={styles.subContent}>\n                                        {invalidDateText}\n                                    </Text>\n                                </View>\n                            );\n                        })}\n                    <View\n                        style={[\n                            styles.subContentLine,\n                            styles.subContentDistance,\n                        ]}\n                    />\n                </View>\n            )}\n\n            {/* 限购政策 */}\n            {!!limitText && (\n                <View style={styles.packageDetailItemWrapper}>\n                    {getSubView('限购政策', limitText)}\n                </View>\n            )}\n\n            {/* 预约规则 */}\n            <View style={styles.packageDetailItemWrapper}>\n                {getSubView('预约规则', reservationText)}\n            </View>\n\n            {/* 使用规则 */}\n            {useRuleTextList.length > 0 && (\n                <View style={styles.packageDetailItemWrapper}>\n                    {getSubView('使用规则')}\n                    {useRuleTextList &&\n                        useRuleTextList.length &&\n                        useRuleTextList.map((useRuleText) => {\n                            return (\n                                <View\n                                    style={[styles.subContentDistance]}\n                                    key={useRuleText}\n                                >\n                                    <Text style={styles.subContent}>\n                                        {useRuleText}\n                                    </Text>\n                                </View>\n                            );\n                        })}\n                    <View\n                        style={[\n                            styles.subContentLine,\n                            styles.subContentDistance,\n                        ]}\n                    />\n                </View>\n            )}\n            {/* 价格和销量说明 */}\n\n            <TouchableOpacity activeOpacity={1} onPress={handleShowPopup}>\n                <View style={styles.priceItemContianer}>\n                    {getSubView('价格和销量说明')}\n                    <View\n                        style={[\n                            styles.rowFlexAlignCenter,\n                            styles.subContentDistance,\n                        ]}\n                    >\n                        <Text style={styles.subContent}>查看全部</Text>\n                        <KidIcon\n                            kid={'common_base_next_24'}\n                            kidColor={'color_base_black_6'}\n                            size={screenUnit.screenSize(14)}\n                            style={styles.priceItemArrow}\n                        />\n                    </View>\n                </View>\n            </TouchableOpacity>\n        </View>\n    );\n};\n"],"mappings":"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"}