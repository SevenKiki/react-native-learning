{"version":3,"names":["_react","_interopRequireDefault","require","_reactNative","_utils","_image","_styles","_api","_baseComponent","obj","__esModule","default","NewUserZoneEntrance","React","memo","entranceData","_entranceData$data","_entranceData$data2","_entranceData$data2$p","_entranceData$data3","_entranceData$data3$p","_entranceData$data3$p2","doCheckEligibility","isEligibility","source","then","result","data","newUser","handleClick","_entranceData$refresh","showToast","refreshData","call","catch","entranceHandleClick","isUserLogin","needLogin","icon","createElement","TouchableWithoutFeedback","onPress","View","style","styles","rootContainer","contentContainerStyle","bgStyle","uri","resizeMode","disCountArea","disCountAreaStyle","Text","disCountContentType","disCountContentTypeStyle","ShowWithData","params","price","disCountContent","disCountContentStyle","subIcons","length","disCountTitleImg","disCountTitleImgStyle","exports"],"sources":["index.tsx"],"sourcesContent":["import React from 'react';\nimport {\n    StyleProp,\n    View,\n    ViewStyle,\n    Text,\n    ImageStyle,\n    TouchableWithoutFeedback,\n} from 'react-native';\nimport { isUserLogin, needLogin, showToast } from '@locallife/utils';\nimport KwaiImage from '@kds/image';\n\nimport styles from './styles';\nimport { CheckIsNewUserResp, isEligibility } from './api';\nimport { ShowWithData } from '@locallife/base-component';\n\ninterface ContentData {\n    subIcons: string[]; // 折扣价后跟随折扣名图片\n    price: string; // 折扣价\n}\n\ninterface FetchEntraceData {\n    id?: string;\n    attributeType?: number;\n    params?: ContentData;\n    icon?: string;\n}\n\ninterface EntranceData {\n    data: FetchEntraceData;\n    refreshData?: () => void; // 刷新数据处理\n    handleClick: (isAllowJump) => void; // 处理点击事件\n    contentContainerStyle?: StyleProp<ViewStyle>; // 根容器Style\n    bgStyle?: StyleProp<ImageStyle>; // 背景图Style\n    disCountAreaStyle?: StyleProp<ViewStyle>; // 信息区域Style\n    disCountContentTypeStyle?: StyleProp<ViewStyle>; // 折扣价格$Style\n    disCountContentStyle?: StyleProp<ViewStyle>; // 折扣价格Style\n    disCountTitleImgStyle?: StyleProp<ImageStyle>; // 折扣名称Img Style\n}\n\n/**\n * 新人专区入口\n *      货架列表页Banner位置\n *      POI页\n */\nexport const NewUserZoneEntrance = React.memo((entranceData: EntranceData) => {\n    function doCheckEligibility() {\n        // 核验资格\n        isEligibility({\n            source: 1, // banner检查是否新用户取source=1的固定值\n        })\n            .then((result: CheckIsNewUserResp) => {\n                if (result?.data) {\n                    if (result.data.newUser) {\n                        // 有资格\n                        entranceData.handleClick(true);\n                    } else {\n                        // 无资格\n                        entranceData.handleClick(false);\n                        // 提示\n                        showToast('您当前不满足新用户身份哦，看看其他商品吧。');\n                        // 刷新\n                        entranceData.refreshData?.();\n                    }\n                } else {\n                    // 数据返回异常\n                    showToast('数据异常，请重试。');\n                }\n            })\n            .catch(() => {\n                // 异常提示\n                showToast('网络异常，请重试。');\n            });\n    }\n\n    function entranceHandleClick() {\n        if (isUserLogin()) {\n            // 已经登录\n            doCheckEligibility();\n        } else {\n            // 未登录，不跳转\n            entranceData.handleClick(false);\n            // 唤起登录页面\n            needLogin(\n                () => {\n                    // 成功登录\n                    doCheckEligibility();\n                },\n                () => {\n                    // 登录失败，不做处理\n                },\n            );\n        }\n    }\n\n    return entranceData.data?.icon ? (\n        // eslint-disable-next-line react/jsx-no-bind\n        <TouchableWithoutFeedback onPress={entranceHandleClick}>\n            <View\n                style={[\n                    styles.rootContainer,\n                    entranceData.contentContainerStyle,\n                ]}\n            >\n                {/* 背景图 */}\n                <KwaiImage\n                    style={[styles.bgStyle, entranceData.bgStyle]}\n                    source={{ uri: entranceData.data.icon }}\n                    resizeMode={'cover'}\n                >\n                    <View\n                        style={[\n                            styles.disCountArea,\n                            entranceData.disCountAreaStyle,\n                        ]}\n                    >\n                        {/* 货币类型 */}\n                        <Text\n                            style={[\n                                styles.disCountContentType,\n                                entranceData.disCountContentTypeStyle,\n                            ]}\n                        >\n                            {'¥'}\n                        </Text>\n                        {/* 折扣价格 */}\n                        <ShowWithData data={entranceData.data?.params?.price}>\n                            <Text\n                                style={[\n                                    styles.disCountContent,\n                                    entranceData.disCountContentStyle,\n                                ]}\n                            >\n                                {entranceData.data.params.price}\n                            </Text>\n                        </ShowWithData>\n                        {/* 折扣类型img */}\n                        <ShowWithData\n                            data={\n                                entranceData.data?.params?.subIcons?.length > 0\n                            }\n                        >\n                            <KwaiImage\n                                style={[\n                                    styles.disCountTitleImg,\n                                    entranceData.disCountTitleImgStyle,\n                                ]}\n                                source={{\n                                    uri: entranceData.data.params.subIcons[0],\n                                }}\n                                resizeMode={'cover'}\n                            />\n                        </ShowWithData>\n                    </View>\n                </KwaiImage>\n            </View>\n        </TouchableWithoutFeedback>\n    ) : (\n        <View />\n    );\n});\n"],"mappings":"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"}