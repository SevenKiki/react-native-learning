import React, { memo, useCallback } from 'react';
import { StyleSheet, TouchableWithoutFeedback, View } from 'react-native';
import { BizTags, TagContent } from '@locallife/biz-component';
import { CustomText } from './CustomText';
import { CustomIcon } from './CustomIcon';
import { useCommonStyleHook } from './hooks/useCommonStyleHook';
import { ShowWithData } from '@locallife/base-component';

type Props = {
    data: TagContent | undefined;
    onPress?: (bizTags?: BizTags) => void;
    bizTags?: BizTags;
    adaptScreen?: boolean;
    adaptDark?: boolean; // 是否适配暗黑
};

const styles = StyleSheet.create({
    container: {
        flexDirection: 'row',
        alignItems: 'center',
    },
});

// text icon text 的 tag
export const SingleLineTextIconText = memo(
    ({ data, onPress, bizTags, adaptScreen, adaptDark = true }: Props) => {
        const { textInfos, contentStyle, iconInfos } = data || {};
        const leftPriceInfo = textInfos?.[0];
        const middleInfo = iconInfos?.[0];
        const rightPriceInfo = textInfos?.[1];
        const onPressCard = useCallback(() => {
            onPress && onPress(bizTags);
        }, [bizTags, onPress]);

        const customStyle = useCommonStyleHook(contentStyle, adaptScreen);

        return (
            <ShowWithData
                data={!!leftPriceInfo && !!middleInfo && !!rightPriceInfo}
            >
                <TouchableWithoutFeedback onPress={onPressCard}>
                    <View style={[styles.container, customStyle]}>
                        <CustomText
                            adaptDark={adaptDark}
                            textModel={leftPriceInfo}
                            adaptScreen={adaptScreen}
                        />
                        <CustomIcon
                            adaptDark={adaptDark}
                            iconModel={middleInfo}
                            adaptScreen={adaptScreen}
                        />
                        <CustomText
                            adaptDark={adaptDark}
                            textModel={rightPriceInfo}
                            adaptScreen={adaptScreen}
                        />
                    </View>
                </TouchableWithoutFeedback>
            </ShowWithData>
        );
    },
);
