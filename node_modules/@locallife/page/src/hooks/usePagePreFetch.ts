import { CustomQueryClient } from '@locallife/page';
import { useMemo } from 'react';
import {
    FetchInfiniteQueryOptions,
    FetchQueryOptions,
    QueryFunction,
} from 'react-query';

export function usePagePreFetch(
    key: any,
    queryFn: QueryFunction<unknown, any>,
    options?: FetchQueryOptions<unknown, unknown, unknown, any> &
        FetchInfiniteQueryOptions<unknown, unknown, unknown, any>,
    infinite = false,
) {
    return useMemo(() => {
        if (!key || !queryFn) {
            return null;
        }
        if (infinite) {
            return CustomQueryClient.get().prefetchInfiniteQuery(key, queryFn, {
                ...options,
                meta: { prefetch: 1 },
            });
        }
        return CustomQueryClient.get().prefetchQuery(key, queryFn, {
            ...options,
            meta: { prefetch: 1 },
        });
    }, []);
}
