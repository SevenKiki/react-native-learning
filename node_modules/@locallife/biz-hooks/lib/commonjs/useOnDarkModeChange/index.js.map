{"version":3,"names":["useOnDarkModeChange","dispatchUpdateTheme","changing","updateState","React","useState","isDarkMode","setIsDarkMode","eventEmitter","NativeEventEmitter","NativeModules","KSAppearance","colorListener","addListener","colorScheme","isDark","remove"],"sources":["index.tsx"],"sourcesContent":["import React from 'react';\nimport { useEffect } from 'react';\nimport { NativeEventEmitter, NativeModules } from 'react-native';\n\n/**\n * iOS 监听暗黑模式变化\n *\n * @param dispatchUpdateTheme 通知更新主题，需要业务侧实现\n */\nexport default function useOnDarkModeChange(\n    dispatchUpdateTheme?: (isDark: boolean) => void,\n) {\n    const [changing, updateState] = React.useState(false);\n    const [isDarkMode, setIsDarkMode] = React.useState(null);\n    useEffect(() => {\n        const eventEmitter = new NativeEventEmitter(NativeModules.KSAppearance);\n        const colorListener = eventEmitter.addListener(\n            'ksAppearanceChanged',\n            ({ colorScheme }) => {\n                updateState(true);\n                const isDark = colorScheme === 'dark';\n                setIsDarkMode(isDark);\n                dispatchUpdateTheme && dispatchUpdateTheme(isDark);\n                updateState(false);\n            },\n        );\n        return () => {\n            colorListener.remove();\n        };\n    });\n    return { changing, isDarkMode };\n}\n"],"mappings":";;;;;;;AAAA;;AAEA;;;;;;AAEA;AACA;AACA;AACA;AACA;AACe,SAASA,mBAAT,CACXC,mBADW,EAEb;EACE,MAAM,CAACC,QAAD,EAAWC,WAAX,IAA0BC,eAAMC,QAAN,CAAe,KAAf,CAAhC;;EACA,MAAM,CAACC,UAAD,EAAaC,aAAb,IAA8BH,eAAMC,QAAN,CAAe,IAAf,CAApC;;EACA,sBAAU,MAAM;IACZ,MAAMG,YAAY,GAAG,IAAIC,+BAAJ,CAAuBC,2BAAcC,YAArC,CAArB;IACA,MAAMC,aAAa,GAAGJ,YAAY,CAACK,WAAb,CAClB,qBADkB,EAElB,QAAqB;MAAA,IAApB;QAAEC;MAAF,CAAoB;MACjBX,WAAW,CAAC,IAAD,CAAX;MACA,MAAMY,MAAM,GAAGD,WAAW,KAAK,MAA/B;MACAP,aAAa,CAACQ,MAAD,CAAb;MACAd,mBAAmB,IAAIA,mBAAmB,CAACc,MAAD,CAA1C;MACAZ,WAAW,CAAC,KAAD,CAAX;IACH,CARiB,CAAtB;IAUA,OAAO,MAAM;MACTS,aAAa,CAACI,MAAd;IACH,CAFD;EAGH,CAfD;EAgBA,OAAO;IAAEd,QAAF;IAAYI;EAAZ,CAAP;AACH"}