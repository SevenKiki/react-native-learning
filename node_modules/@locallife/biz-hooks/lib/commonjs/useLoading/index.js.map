{"version":3,"names":["LoadingStatus","useLoading","onlyOnce","status","setStatus","initial","withLoading","task","disabledStates","loading","success","includes","err","fail","isLoading"],"sources":["index.tsx"],"sourcesContent":["import { useState } from 'react';\n\nexport enum LoadingStatus {\n    initial,\n    loading,\n    success,\n    fail,\n}\n\n/**\n * 根据传入方法状态判断页面状态\n * @param\n * onlyOnce: 是否只能请求成功一次。\n *   --true: 只能请求成功一次。如：【入驻】请求成功后不允许再次请求入驻\n *   --false：允许请求多次。如：页面加载数据失败允许重新请求\n * @example const { status, withLoading, isLoading } = useLoading()\n */\nexport default function useLoading({ onlyOnce = false } = {}) {\n    const [status, setStatus] = useState(LoadingStatus.initial);\n\n    async function withLoading(task: () => Promise<any>) {\n        const disabledStates = onlyOnce\n            ? [LoadingStatus.loading, LoadingStatus.success]\n            : [LoadingStatus.loading];\n        if (disabledStates.includes(status)) {\n            return;\n        }\n        try {\n            setStatus(LoadingStatus.loading);\n            await task();\n            setStatus(LoadingStatus.success);\n        } catch (err) {\n            setStatus(LoadingStatus.fail);\n            throw err;\n        }\n    }\n\n    return {\n        status,\n        withLoading,\n        isLoading: LoadingStatus.loading === status,\n    };\n}\n"],"mappings":";;;;;;;;AAAA;;IAEYA,a;AAOZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;WAdYA,a;EAAAA,a,CAAAA,a;EAAAA,a,CAAAA,a;EAAAA,a,CAAAA,a;EAAAA,a,CAAAA,a;GAAAA,a,6BAAAA,a;;AAeG,SAASC,UAAT,GAA+C;EAAA,IAA3B;IAAEC,QAAQ,GAAG;EAAb,CAA2B,uEAAJ,EAAI;EAC1D,MAAM,CAACC,MAAD,EAASC,SAAT,IAAsB,qBAASJ,aAAa,CAACK,OAAvB,CAA5B;;EAEA,eAAeC,WAAf,CAA2BC,IAA3B,EAAqD;IACjD,MAAMC,cAAc,GAAGN,QAAQ,GACzB,CAACF,aAAa,CAACS,OAAf,EAAwBT,aAAa,CAACU,OAAtC,CADyB,GAEzB,CAACV,aAAa,CAACS,OAAf,CAFN;;IAGA,IAAID,cAAc,CAACG,QAAf,CAAwBR,MAAxB,CAAJ,EAAqC;MACjC;IACH;;IACD,IAAI;MACAC,SAAS,CAACJ,aAAa,CAACS,OAAf,CAAT;MACA,MAAMF,IAAI,EAAV;MACAH,SAAS,CAACJ,aAAa,CAACU,OAAf,CAAT;IACH,CAJD,CAIE,OAAOE,GAAP,EAAY;MACVR,SAAS,CAACJ,aAAa,CAACa,IAAf,CAAT;MACA,MAAMD,GAAN;IACH;EACJ;;EAED,OAAO;IACHT,MADG;IAEHG,WAFG;IAGHQ,SAAS,EAAEd,aAAa,CAACS,OAAd,KAA0BN;EAHlC,CAAP;AAKH"}