import React from 'react';
import { useEffect } from 'react';
import { NativeEventEmitter, NativeModules } from 'react-native';
/**
 * iOS 监听暗黑模式变化
 *
 * @param dispatchUpdateTheme 通知更新主题，需要业务侧实现
 */

export default function useOnDarkModeChange(dispatchUpdateTheme) {
  const [changing, updateState] = React.useState(false);
  const [isDarkMode, setIsDarkMode] = React.useState(null);
  useEffect(() => {
    const eventEmitter = new NativeEventEmitter(NativeModules.KSAppearance);
    const colorListener = eventEmitter.addListener('ksAppearanceChanged', _ref => {
      let {
        colorScheme
      } = _ref;
      updateState(true);
      const isDark = colorScheme === 'dark';
      setIsDarkMode(isDark);
      dispatchUpdateTheme && dispatchUpdateTheme(isDark);
      updateState(false);
    });
    return () => {
      colorListener.remove();
    };
  });
  return {
    changing,
    isDarkMode
  };
}
//# sourceMappingURL=index.js.map