{"version":3,"names":["React","useEffect","NativeEventEmitter","NativeModules","useOnDarkModeChange","dispatchUpdateTheme","changing","updateState","useState","isDarkMode","setIsDarkMode","eventEmitter","KSAppearance","colorListener","addListener","colorScheme","isDark","remove"],"sources":["index.tsx"],"sourcesContent":["import React from 'react';\nimport { useEffect } from 'react';\nimport { NativeEventEmitter, NativeModules } from 'react-native';\n\n/**\n * iOS 监听暗黑模式变化\n *\n * @param dispatchUpdateTheme 通知更新主题，需要业务侧实现\n */\nexport default function useOnDarkModeChange(\n    dispatchUpdateTheme?: (isDark: boolean) => void,\n) {\n    const [changing, updateState] = React.useState(false);\n    const [isDarkMode, setIsDarkMode] = React.useState(null);\n    useEffect(() => {\n        const eventEmitter = new NativeEventEmitter(NativeModules.KSAppearance);\n        const colorListener = eventEmitter.addListener(\n            'ksAppearanceChanged',\n            ({ colorScheme }) => {\n                updateState(true);\n                const isDark = colorScheme === 'dark';\n                setIsDarkMode(isDark);\n                dispatchUpdateTheme && dispatchUpdateTheme(isDark);\n                updateState(false);\n            },\n        );\n        return () => {\n            colorListener.remove();\n        };\n    });\n    return { changing, isDarkMode };\n}\n"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,SAAT,QAA0B,OAA1B;AACA,SAASC,kBAAT,EAA6BC,aAA7B,QAAkD,cAAlD;AAEA;AACA;AACA;AACA;AACA;;AACA,eAAe,SAASC,mBAAT,CACXC,mBADW,EAEb;EACE,MAAM,CAACC,QAAD,EAAWC,WAAX,IAA0BP,KAAK,CAACQ,QAAN,CAAe,KAAf,CAAhC;EACA,MAAM,CAACC,UAAD,EAAaC,aAAb,IAA8BV,KAAK,CAACQ,QAAN,CAAe,IAAf,CAApC;EACAP,SAAS,CAAC,MAAM;IACZ,MAAMU,YAAY,GAAG,IAAIT,kBAAJ,CAAuBC,aAAa,CAACS,YAArC,CAArB;IACA,MAAMC,aAAa,GAAGF,YAAY,CAACG,WAAb,CAClB,qBADkB,EAElB,QAAqB;MAAA,IAApB;QAAEC;MAAF,CAAoB;MACjBR,WAAW,CAAC,IAAD,CAAX;MACA,MAAMS,MAAM,GAAGD,WAAW,KAAK,MAA/B;MACAL,aAAa,CAACM,MAAD,CAAb;MACAX,mBAAmB,IAAIA,mBAAmB,CAACW,MAAD,CAA1C;MACAT,WAAW,CAAC,KAAD,CAAX;IACH,CARiB,CAAtB;IAUA,OAAO,MAAM;MACTM,aAAa,CAACI,MAAd;IACH,CAFD;EAGH,CAfQ,CAAT;EAgBA,OAAO;IAAEX,QAAF;IAAYG;EAAZ,CAAP;AACH"}