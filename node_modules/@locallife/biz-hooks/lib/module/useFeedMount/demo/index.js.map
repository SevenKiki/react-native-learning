{"version":3,"names":["React","FlatList","Text","StyleSheet","SafeAreaView","useFeedMount","useRef","styles","create","container","flex","text","width","height","textAlign","lineHeight","color","fontSize","blue","backgroundColor","orange","purple","green","bottom","ItemModel","onFeedMount","item","index","console","log","data","Array","fill","map","_","backgroundArray","renderItem","length","onViewableItemChange","changed","forEach","viewToken","isViewable","current"],"sources":["index.tsx"],"sourcesContent":["/* eslint-disable react/jsx-no-bind */\nimport React from 'react';\nimport {\n    FlatList,\n    Text,\n    StyleSheet,\n    SafeAreaView,\n    ViewToken,\n} from 'react-native';\nimport useFeedMount from '..';\nimport { useRef } from 'react';\n\n// 本Demo展示了useFeedMount的使用，通过该Hook可以对列表每个item展现的上报打点进行控制，保证每个item只会上报一次展现点\nconst styles = StyleSheet.create({\n    container: {\n        flex: 1,\n    },\n    text: {\n        width: '100%',\n        height: 300,\n        textAlign: 'center',\n        lineHeight: 300,\n        color: '#ffffff',\n        fontSize: 22,\n    },\n    blue: {\n        backgroundColor: 'blue',\n    },\n    orange: {\n        backgroundColor: 'orange',\n    },\n    purple: {\n        backgroundColor: 'purple',\n    },\n    green: {\n        backgroundColor: 'green',\n    },\n    bottom: {\n        backgroundColor: 'black',\n        color: '#ffffff',\n        textAlign: 'center',\n        lineHeight: 50,\n    },\n});\n\nclass ItemModel {\n    data: string;\n    index: string;\n}\n\nexport default () => {\n    const onFeedMount = useFeedMount<ItemModel>(\n        (item) => item.index,\n        (item) => {\n            console.log(`第${item.index + 1}个文本 已展现, 上报该展现点`);\n        },\n    );\n    let data = Array(100).fill({ data: '0', index: '0' });\n    data = data.map((_, index) => {\n        return { data: `第${index + 1}个文本`, index: index };\n    });\n\n    const backgroundArray = [\n        styles.blue,\n        styles.orange,\n        styles.purple,\n        styles.green,\n    ];\n\n    const renderItem = ({ index }) => {\n        return (\n            <Text\n                style={[\n                    styles.text,\n                    backgroundArray[index % backgroundArray.length],\n                ]}\n            >\n                {data[index].data}\n            </Text>\n        );\n    };\n\n    const onViewableItemChange = useRef(\n        ({ changed }: { changed: Array<ViewToken> }) => {\n            changed.forEach((viewToken) => {\n                if (viewToken.isViewable) {\n                    onFeedMount && onFeedMount(viewToken.item, viewToken.index);\n                    console.log(`第${viewToken.index + 1}个文本 is visible`);\n                } else {\n                    console.log(\n                        `第${viewToken.index + 1}个文本 is not visible`,\n                    );\n                }\n            });\n        },\n    );\n\n    return (\n        <SafeAreaView style={styles.container}>\n            <FlatList\n                data={data}\n                renderItem={renderItem}\n                keyExtractor={(_, index) => `${index}`}\n                onViewableItemsChanged={onViewableItemChange.current}\n            />\n        </SafeAreaView>\n    );\n};\n"],"mappings":"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"}