import React, { useState, useEffect } from 'react';
import { Text } from 'react-native';
import useLatest from '../index';

// 本Demo中，使用useLatest始终获得count最新的值
// setCount(lastestCount.current + 1)等价于setCount((c) => c + 1)
export default () => {
    const [count, setCount] = useState(0);
    const lastestCount = useLatest(count);

    useEffect(() => {
        const intervalId = setInterval(() => {
            setCount(lastestCount.current + 1);
            // 使用最新值的优势在于，调用setCount后，如果打印count的值始终是0，而lastestCount.current的值是实时更新的
            // console.log(
            //     `count = ${count}; lastestCount.current = ${lastestCount.current}`,
            // );
        }, 1000);
        return () => clearInterval(intervalId);
    }, [lastestCount]);
    return <Text>{count}</Text>;
};
