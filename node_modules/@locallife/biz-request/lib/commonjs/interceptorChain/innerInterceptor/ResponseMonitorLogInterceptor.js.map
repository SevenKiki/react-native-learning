{"version":3,"names":["ResponseMonitorLogInterceptor","Interceptor","proceed","model","endTime","extra","sysTimeRequestEnd","Date","now","startTime","sysTimeRequestStart","costTime","String","LocalLifeRequestLogger","logRequest","requestParams","url","Promise","resolve","error","code","reason","status","result","message","reject"],"sources":["ResponseMonitorLogInterceptor.ts"],"sourcesContent":["import { Interceptor, InterceptorModel } from '@locallife/base-request';\nimport { LocalLifeRequestLogger } from '@locallife/log';\n\n/**\n * 请求耗时纪录\n */\nexport default class ResponseMonitorLogInterceptor extends Interceptor {\n    proceed(): (model: InterceptorModel) => Promise<InterceptorModel> {\n        return function (model: InterceptorModel) {\n            const endTime = (model.extra?.sysTimeRequestEnd ??\n                Date.now()) as number;\n            const startTime = (model.extra?.sysTimeRequestStart ??\n                endTime) as number;\n            const costTime = String(endTime - startTime);\n            LocalLifeRequestLogger.logRequest(\n                model.requestParams?.url ?? '',\n                true,\n                -1,\n                '',\n                { costTime },\n            );\n            return Promise.resolve(model);\n        };\n    }\n\n    error(): (model: InterceptorModel) => Promise<InterceptorModel> {\n        return function (model: InterceptorModel) {\n            const code =\n                model.reason?.code ??\n                model.reason?.status ??\n                model.reason?.result ??\n                -1;\n\n            const endTime = (model.extra?.sysTimeRequestEnd ??\n                Date.now()) as number;\n            const startTime = (model.extra?.sysTimeRequestStart ??\n                endTime) as number;\n            const costTime = String(endTime - startTime);\n\n            LocalLifeRequestLogger.logRequest(\n                model.requestParams?.url ?? '',\n                false,\n                code,\n                model.reason?.message ?? '',\n                { costTime },\n            );\n            return Promise.reject(model);\n        };\n    }\n}\n"],"mappings":";;;;;;;AAAA;;AACA;;AAEA;AACA;AACA;AACe,MAAMA,6BAAN,SAA4CC,wBAA5C,CAAwD;EACnEC,OAAO,GAA2D;IAC9D,OAAO,UAAUC,KAAV,EAAmC;MAAA;;MACtC,MAAMC,OAAO,4CAAID,KAAK,CAACE,KAAV,iDAAI,aAAaC,iBAAjB,yEACTC,IAAI,CAACC,GAAL,EADJ;MAEA,MAAMC,SAAS,8CAAIN,KAAK,CAACE,KAAV,kDAAI,cAAaK,mBAAjB,2EACXN,OADJ;MAEA,MAAMO,QAAQ,GAAGC,MAAM,CAACR,OAAO,GAAGK,SAAX,CAAvB;;MACAI,4BAAuBC,UAAvB,kDACIX,KAAK,CAACY,aADV,yDACI,qBAAqBC,GADzB,yEACgC,EADhC,EAEI,IAFJ,EAGI,CAAC,CAHL,EAII,EAJJ,EAKI;QAAEL;MAAF,CALJ;;MAOA,OAAOM,OAAO,CAACC,OAAR,CAAgBf,KAAhB,CAAP;IACH,CAdD;EAeH;;EAEDgB,KAAK,GAA2D;IAC5D,OAAO,UAAUhB,KAAV,EAAmC;MAAA;;MACtC,MAAMiB,IAAI,2DACNjB,KAAK,CAACkB,MADA,kDACN,cAAcD,IADR,qFAENjB,KAAK,CAACkB,MAFA,mDAEN,eAAcC,MAFR,2DAGNnB,KAAK,CAACkB,MAHA,mDAGN,eAAcE,MAHR,uCAIN,CAAC,CAJL;MAMA,MAAMnB,OAAO,8CAAID,KAAK,CAACE,KAAV,kDAAI,cAAaC,iBAAjB,2EACTC,IAAI,CAACC,GAAL,EADJ;MAEA,MAAMC,SAAS,8CAAIN,KAAK,CAACE,KAAV,kDAAI,cAAaK,mBAAjB,2EACXN,OADJ;MAEA,MAAMO,QAAQ,GAAGC,MAAM,CAACR,OAAO,GAAGK,SAAX,CAAvB;;MAEAI,4BAAuBC,UAAvB,oDACIX,KAAK,CAACY,aADV,0DACI,sBAAqBC,GADzB,2EACgC,EADhC,EAEI,KAFJ,EAGII,IAHJ,6CAIIjB,KAAK,CAACkB,MAJV,mDAII,eAAcG,OAJlB,yEAI6B,EAJ7B,EAKI;QAAEb;MAAF,CALJ;;MAOA,OAAOM,OAAO,CAACQ,MAAR,CAAetB,KAAf,CAAP;IACH,CArBD;EAsBH;;AA1CkE"}