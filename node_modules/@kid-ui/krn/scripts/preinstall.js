const fs = require('fs');

// Keep打包机node版本过低，依赖安装时会失败，需要remove依赖
if (process.env.JENKINS_URL) {
  const packageJson = JSON.parse(fs.readFileSync("./package.json").toString());
  delete packageJson.devDependencies["@kds/vue-cli-plugin-kds"];
  delete packageJson.devDependencies["@kds/vue-cli-plugin-keep"];
  delete packageJson.devDependencies["@kds/vue-cli-plugin-rn-adapter"];
  delete packageJson.devDependencies["@vue/cli-plugin-babel"];
  delete packageJson.devDependencies["@vue/cli-service"];
  delete packageJson.devDependencies["vue-template-compiler"];
  delete packageJson.devDependencies["babel-loader"];
  fs.writeFileSync("./package.json", JSON.stringify(packageJson));
}
