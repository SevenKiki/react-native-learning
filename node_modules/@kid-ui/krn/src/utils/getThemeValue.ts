import { NativeModules } from 'react-native';
import { ThemeValue } from "../theme/useThemeValue";

type UnWrap<T> = T extends {
  light?: any;
  dark?: any;
}
  ? T[keyof T]
  : T;

//useThemeValue非hooks用法
export const getThemeValue = <T>(
  kidKey: ThemeValue<T>,
  customTheme?: string,
): UnWrap<ThemeValue<T>> => {
  const theme = NativeModules.KSAppearance?.getColorScheme?.() || customTheme || 'light';

  if (!kidKey || typeof kidKey !== 'object') {
    return kidKey as UnWrap<ThemeValue<T>>;
  }

  return (
    (kidKey as any)[customTheme || theme] ??
    (kidKey as any)[theme] ??
    (kidKey as any).normal ??
    kidKey
  );
}