import React from 'react';
import { render, fireEvent } from '@testing-library/react-native';
import { KidNoticeBar } from '../NoticeBar';

jest.useFakeTimers()

describe('testing KidNoticeBar', () => {
  it('props: mode', () => {
    const { toJSON, UNSAFE_getByType } = render(
      <KidNoticeBar
        mode=""
        text='测试消息'
        leftIconKid="common_baseflat_announcement_24"
      />,
    );
    const ele = UNSAFE_getByType(KidNoticeBar)
    expect(ele.props.mode).toEqual('')
    expect(toJSON()).toMatchSnapshot();
  });

  it('props: mode-closeable : ', () => {
    const { toJSON } = render(
      <KidNoticeBar
        type="default"
        text='消息1、这里是一条提醒条内容'
        mode="closeable"
        rightAreaText="不再提示"
        leftIconKid="common_baseflat_announcement_24"
      />,
    );
    expect(toJSON()).toMatchSnapshot();
  });

  it('props: mode-link : ', () => {
    const { toJSON } = render(
      <KidNoticeBar
        type="safe"
        text='消息2、这里是一条提醒条内容'
        mode="link"
        rightAreaText="点击跳转"
        leftIconKid="common_baseflat_announcement_24"
        borderRadius={5}
      />,
    );
    expect(toJSON()).toMatchSnapshot();
  });

  it('props: direction-left  scrollable', () => {
    const { toJSON } = render(
      <KidNoticeBar
        type="safe"
        text='这里是一条提醒条内容支持滚动很长很长很长很长很长很长很长很长'
        mode="link"
        rightAreaText="点击跳转"
        leftIconKid="common_baseflat_announcement_24"
        direction='left'
        scrollable
      />,
    );
    expect(toJSON()).toMatchSnapshot();
  });


  it('props: direction-right  scrollable', () => {
    const { toJSON } = render(
      <KidNoticeBar
        type="safe"
        text='这里是一条提醒条内容支持滚动很长很长很长很长很长很长很长很长'
        mode="link"
        rightAreaText="点击跳转"
        leftIconKid="common_baseflat_announcement_24"
        direction='right'
        scrollable
      />,
    );
    expect(toJSON()).toMatchSnapshot();
  });

  it('props: direction-up  scrollable', () => {
    const { toJSON } = render(
      <KidNoticeBar
        type="safe"
        text={['1、这里是第一条提醒条内容','2、这里是第二条提醒条内容']}
        mode="link"
        rightAreaText="点击跳转"
        leftIconKid="common_baseflat_announcement_24"
        direction='up'
        scrollable
      />,
    );
    expect(toJSON()).toMatchSnapshot();
  });

  it('props: direction-down  scrollable', () => {
    const { toJSON } = render(
      <KidNoticeBar
        type="safe"
        text={['1、这里是第一条提醒条内容','2、这里是第二条提醒条内容']}
        mode="link"
        rightAreaText="点击跳转"
        leftIconKid="common_baseflat_announcement_24"
        direction='down'
        scrollable
      />,
    );
    expect(toJSON()).toMatchSnapshot();
  });

  it('events: onPress', () => {
    const onPress = jest.fn();
    const { getByText } = render(
      <KidNoticeBar
        type="default"
        text='测试消息'
        mode="closeable"
        onPress={onPress}
      />
    );
    const ele = getByText('测试消息');
    fireEvent.press(ele);
    expect(onPress).toHaveBeenCalled();
  });

  it('events: onPressRightArea', () => {
    const onPressRightArea = jest.fn();
    const { getByTestId } = render(
      <KidNoticeBar
        type="default"
        text='测试消息'
        mode="closeable"
        onPressRightArea={onPressRightArea}
      />
    );
    const ele = getByTestId('notice-bar-right-area');
    fireEvent.press(ele);
    expect(onPressRightArea).toHaveBeenCalled();
  });
});
