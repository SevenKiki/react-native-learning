import React from 'react';
import { View, Text } from 'react-native';
import { render, fireEvent } from '@testing-library/react-native';
import { LinearGradientText } from '../index';

describe('testing LinearGradientText', () => {
  it('props: text', () => {
    const { toJSON } = render(
      <View>
        <LinearGradientText text="渐变文字" />
        <LinearGradientText>渐变文字</LinearGradientText>
      </View>
    );

    expect(toJSON()).toMatchSnapshot();
  })

  it('props: textFont colors useAngle angle locations', () => {
    const { toJSON } = render(
      <View>
        <LinearGradientText
          text="渐变角度和位置、文字大小"
          textFont={18}
          colors={['#000', '#ccc']}
          useAngle
          angle={90}
          locations={[0.7, 0.7]}
        />
        <LinearGradientText
          text="多种颜色试一下文本很长很长很长很长很长很长很长很长很长"
          numberOfLines={1}
          ellipsizeMode='middle'
          textFont={24}
          colors={[
            { light: '#F0F', dark: '#808' },
            { light: '#F00', dark: '#800' },
            { light: '#FF0', dark: '#880' },
            { light: '#0F0', dark: '#080' },
            { light: '#0FF', dark: '#088' },
            { light: '#00F', dark: '#008' },
          ]}
        />
        <LinearGradientText
          colors={[
            { light: '#F0F', dark: '#808' },
            { light: '#F00', dark: '#800' },
            { light: '#FF0', dark: '#880' },
            { light: '#0F0', dark: '#080' },
            { light: '#0FF', dark: '#088' },
            { light: '#00F', dark: '#008' },
          ]}
          useAngle
          angle={90}
          textFont={24}
        >
          文
          <Text style={{ fontSize: 22, fontWeight: 'bold' }}>
            本
            <Text style={{ fontSize: 20, fontWeight: 'normal' }}>
              里
              <Text style={{ fontSize: 18, fontStyle: 'italic' }}>
                面
                <Text style={{ fontSize: 16, fontStyle: 'normal' }}>可以</Text>
                嵌
              </Text>
              套
            </Text>
            文
          </Text>
          本
        </LinearGradientText>
      </View>
    );

    expect(toJSON()).toMatchSnapshot();
  })

  it('events: ', () => {
    const press = jest.fn();
    const longPress = jest.fn();
    const layout = jest.fn();
    const textLayout = jest.fn();

    const { toJSON, getByTestId } = render(
      <View>
        <LinearGradientText
          text="渐变角度和位置、文字大小"
          onPress={press}
          onLongPress={longPress}
          onLayout={layout}
          // @ts-ignore
          onTextLayout={textLayout}
        />
      </View>
    );

    const text = getByTestId('LinearGradientTextText');
    fireEvent(text, 'onPress');
    fireEvent(text, 'longPress');
    fireEvent(text, 'layout');
    fireEvent(text, 'textLayout');
    expect(press).toHaveBeenCalled();
    expect(longPress).toHaveBeenCalled();
    expect(layout).toHaveBeenCalled();
    expect(textLayout).toHaveBeenCalled();
  })
})