var e=function(){return(e=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function t(e,a,s,c){return new(s=s||Promise)(function(n,t){function r(e){try{i(c.next(e))}catch(e){t(e)}}function o(e){try{i(c.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(r,o)}i((c=c.apply(e,a||[])).next())})}function n(r,o){var i,a,s,c={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(n){return function(e){var t=[n,e];if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return c.label++,{value:t[1],done:!1};case 5:c.label++,a=t[1],t=[0];continue;case 7:t=c.ops.pop(),c.trys.pop();continue;default:if(!(s=0<(s=c.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){c=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){c.label=t[1];break}if(6===t[0]&&c.label<s[1]){c.label=s[1],s=t;break}if(s&&c.label<s[2]){c.label=s[2],c.ops.push(t);break}s[2]&&c.ops.pop(),c.trys.pop();continue}t=o.call(r,c)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}}function r$1(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function o$1(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||((r=r||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}var l$3,f$4,i="ksurl.cn/csHfgepO",a$2=console,c$1=a$2.log.bind(a$2,i+", radar:"),s$2=a$2.warn.bind(a$2,i+", radar:"),u$4=a$2.error.bind(a$2,i+", radar:"),p$3=function(){function e(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.middlewares=[],(e=this.middlewares).push.apply(e,o$1([],r$1(t),!1))}return e.prototype.use=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=this.middlewares.pop();(e=this.middlewares).push.apply(e,o$1([],r$1(t),!1)),this.middlewares.push(r)},e.prototype.invoke=function(e){return a=this.middlewares,r=e,i=-1,function e(t){if(t<=i)return new Error("`next` 被重复调用");var n=a[i=t];if(n=t===a.length?o:n)try{return n(r,e.bind(null,t+1))}catch(t){return t}}(0);var r,o,i,a},e}(),d$3=((f$4=l$3=l$3||{}).LOAD="load",f$4.RES="resource",f$4.API="api",f$4.ERROR="error",f$4.SDK_ERROR="sdk_error",f$4.CUSTOM="custom",f$4.BATCH="batch",f$4.EVENT="event",f$4.BLOOD="blood",function(){function t(e){void 0===e&&(e={});var t=this;this.broadcastSampleFb=function(){var e=t.getSample(t.baseOptions.sampling);e!==t.sampling&&(t.sampling=e,t.sampling&&(t.isHit=t.samplingControl(t.sampling)))},void 0===e&&De("100"),e.key||De("101"),!e.core||"object"==typeof e.core.sampleData&&"function"==typeof e.core.collect||De("121"),this.baseOptions=e,this.key=e.key,this.version=e.version,this.name=e.name,this.isHit=!1,e.core&&this.updateCore(e.core)}return t.prototype.updateCore=function(e){var t;"object"==typeof e.sampleData&&"function"==typeof e.collect||De("121"),null!=(t=this.core)&&t.broadcastSample.off(this.broadcastSampleFb),this.core=e,this.sampling=this.getSample(this.baseOptions.sampling),this.sampling&&(this.isHit=this.samplingControl(this.sampling)),null!=(e=null==(t=this.core)?void 0:t.broadcastSample)&&e.on(this.broadcastSampleFb)},t.prototype.getSample=function(e){var t=null!=(t=null==(t=this.core)?void 0:t.sampleData.core)?t:1;if(this.key===l$3.LOAD)return t;if("number"!=typeof(e=void 0===e?1:e)||e<0||1<e)return s$2("102","".concat(this.key,"，采用Core的采样率").concat(null==(n=this.core)?void 0:n.sampleData.core)),t;var n=null!=(n=this.core)&&n.isInYoda?void 0===(null==(n=this.core)?void 0:n.sampleData[this.key])?1:this.core.sampleData[this.key]:e;return t&&t<n?(s$2("115","".concat(this.key)),t):n},t.prototype.samplingControl=function(e){var t;return!(null==(t=this.core)||!t.sampleData.isHit)&&(null==(t=this.core)?void 0:t.samplingControl(e/this.core.sampleData.core))},t.prototype.baseCollect=function(t){if(this.core){if(this.isHit){var r=t.value||{},r=Object.keys(r).filter(function(e){return null!==r[e]&&void 0!==r[e]}).reduce(function(t,n){return e(e({},t),((t={})[n]=r[n],t))},{});try{this.core.collect(t.key||this.key,e(e({collect_version:this.version,collect_name:this.name},t.dimension),{sample_rate:this.sampling}),r)}catch(t){s$2("126")}}}else s$2("110","".concat(this.key))},t}());function h$3(){var e,t="undefined"!=typeof window?window.performance:null;return t&&t.timing?"function"==typeof t.timing.toJSON?((e=t.timing.toJSON())&&!e.redirectStart&&(e.redirectStart=e.navigationStart),e):t.timing:null}var v$4=["//wlog.kuaishou.com/rest/n/log/web/collect","/rest/wd/common/log/collect/misc2","/rest/wd/common/log/collect/radar","/rest/kd/log/collect"],m$2=window,_$3="__radarSeedStore__",b$3="isCoreReady",x="isRuning",S$2="radarSessionId",R="resource",O$1="error",E="event",k$1="Queue",T=O$1+k$1,j=R+k$1,A$1=E+k$1,M={start_time:{custom:function(e,t){return Math.round(t.startTime)}},fetch_start:{custom:function(e,t){return Math.round(t.fetchStart)}},dns:{end:"domainLookupEnd",start:"domainLookupStart",cachedSkip:!0,crossOriginSkip:!0},tcp:{end:"connectEnd",start:"connectStart",cachedSkip:!0,crossOriginSkip:!0},ssl:{custom:function(e,t){return t.connectEnd&&t.secureConnectionStart?t.connectEnd-t.secureConnectionStart:null}},ttfb:{end:"responseStart",start:"requestStart",cachedSkip:!0,crossOriginSkip:!0},trans:{end:"responseEnd",start:"responseStart",cachedSkip:!0,crossOriginSkip:!0},fb:{end:"responseStart",start:"fetchStart",cachedSkip:!0,crossOriginSkip:!0},total:{end:"responseEnd",start:"fetchStart"},size:{custom:function(e,t){return t.encodedBodySize},cachedSkip:!0,crossOriginSkip:!0},protocol:{custom:function(e,t){return t.nextHopProtocol}},file:{custom:function(e,t){return t.name}},res_type:{custom:function(e,t){return t.initiatorType}},cached:{custom:function(e,t){return 0===t.transferSize||0===t.duration||null==t.transferSize&&(0===t.domainLookupStart||t.responseStart===t.fetchStart)},crossOriginSkip:!0},has_timing_allow:{custom:function(e,t){return G(t)}}},N=/^(https?:)?\/\//;function D(e,t){if(!e)return!1;var n=e.replace(N,"");return t.some(function(e){return 0<=n.indexOf(e.replace(N,""))})}function H(e){if("string"!=typeof e)return"";try{var t=e.lastIndexOf(".");return e.substr(t+1)}catch(e){return""}}function W(t){return"object"==typeof t&&Object.keys(t).every(function(e){return"number"==typeof t[e]})}function X(e){return"function"==typeof e}function U(e){return e&&X(e.then)&&X(e.catch)}function G(e){return void 0===e.nextHopProtocol?null:""!==e.nextHopProtocol}function J(e){return"resource"===e.entryType?"fetch"!==(null==e?void 0:e.initiatorType)&&"xmlhttprequest"!==(null==e?void 0:e.initiatorType)||"js"===H(e.name)||"css"===H(e.name)?"resource":"api":"other"}function K(n,r){var o={};return Object.keys(n).forEach(function(e){var t=Y(e,n,r);null!=t&&(o[e]=t)}),o}function Y(e,t,n){var r=t[e];if(r||De("129，".concat(e)),(!r.crossOriginSkip||G(n))&&(!r.cachedSkip||!Y("cached",t,n)))return"function"==typeof r.custom?r.custom(e,n):(t=r.end,e=r.start,!r.notCatchIfUndefined||void 0!==n[t]&&void 0!==n[e]?(+n[t]||0)-(+n[e]||0):void 0)}function B(e,t,n,r){return e.addEventListener(t,n,r)}function $(e,t,n,r){return e.removeEventListener(t,n,r)}function Q(e){return e.message||null!=e.lineno}var Z=["ktrace-str"];function ee(e){return"__radar_".concat(e=void 0===e?"":e).concat(Math.random().toString(36).substring(2,8))}function te(o,u){var i=window.XMLHttpRequest;return i?(window.XMLHttpRequest=function(){var n,s,t,c=new i,r=(c._radarRequest={},c._radarResponse={},ee()),l=(c._radarRequest.id=r,{});return c.addEventListener("readystatechange",function(){if(4===c.readyState&&"function"==typeof u){c._radarResponse.status=c.status,c._radarResponse.statusText=c.statusText;var e,t,n,r,o,i=function(e,t){switch(null==t&&(t={}),typeof e){case"object":var n,r=[];for(n in e){var o=e[n],i=n.toLowerCase();r.push("".concat(i,":\t").concat(o))}return r.join("\n")+"\n";case"string":for(var a=0,s=(r=e.split("\n")).length;a<s;a++){var c=r[a];/([^:]+):\s*(.+)/.test(c)&&(c=null!=(c=RegExp.$1)?c.toLowerCase():void 0,o=RegExp.$2,c&&null==t[c]&&(t[c]=o))}return t}}(c.getAllResponseHeaders());for(e in i)n=i[e],c._radarResponse&&c._radarResponse.headers&&!c._radarResponse.headers[e]&&(t=e.toLowerCase(),c._radarResponse.headers[t]=n);if(c.responseType&&"text"!==c.responseType)"document"===c.responseType?(c._radarResponse.xml=c.responseXML,c._radarResponse.data=c.responseXML):c._radarResponse.data=c.response;else{c._radarResponse.text=c.responseText,c._radarResponse.data=c.responseText;try{c._radarResponse.xml=c.responseXML}catch(e){}}"responseURL"in c&&(c._radarResponse.finalUrl=c.responseURL);try{var a=null!=(r=l["ktrace-str"])?r:"";a&&window.parseWedTraceId&&(c._radarRequest.trace_id=window.parseWedTraceId(null!=(o=a.split("|")[1])?o:""))}catch(e){s$2("traceId 解析异常")}u(c._radarRequest,c._radarResponse)}}),"function"==typeof c.setRequestHeader&&(n=c.setRequestHeader,c.setRequestHeader=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Z.includes(e[0])&&(l[e[0]]=e[1]),n.apply(this,e)}),"function"==typeof c.open&&(s=c.open,c.open=function(t,n,r,o,i){var a=[].slice.call(arguments);return this._radarRequest=e({method:t,url:n,async:r,user:o,pass:i},this._radarRequest),this._radarResponse.headers={},s.apply(this,a)}),"function"==typeof c.send&&(t=c.send,c.send=function(){var e=[].slice.call(arguments);return"function"==typeof o&&(this._radarRequest._config=e[0],o(this._radarRequest)),t.apply(this,e)}),c},["DONE","HEADERS_RECEIVED","LOADING","OPENED","UNSENT"].forEach(function(e){window.XMLHttpRequest[e]=i[e]}),window.XMLHttpRequest.prototype=i.prototype,function(){i&&(window.XMLHttpRequest=i)}):(u$4("118"),!1)}function ne(n,r){var e=function(e){if("function"!=typeof e.fetch)return null;var n,t=e.fetch;return e.fetch=(n=e.fetch,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ie.apply(void 0,o$1([n],r$1(e),!1))}),{register:function(t){return re.push(t),function(){var e=re.indexOf(t);0<=e&&re.splice(e,1)}},clear:function(){re=[]},unRegister:function(){t&&(e.fetch=t)}}}("function"==typeof importScripts?self:window);return e&&e.register({request:function(e,t){"function"==typeof n&&n(e)},response:function(e,t){"function"==typeof r&&r(t,e)},responseError:function(e,t){"function"==typeof r&&r(t,{status:0,statusText:e})}}),null==e?void 0:e.unRegister}var re=[],oe=["application/json","text/html","text/plain"];function ie(e){for(var o=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var a=re.reduce(function(e,t){return[t].concat(e)},[]),s="string"==typeof r[0]?new Request(r[0],r[1]):r[0],c=(s.id=ee(),a.forEach(function(e){e=e.request,s=e(s)||s}),s.clone()),l=e.apply(void 0,o$1([],r$1(r),!1)),u=null,p=null,f=!1;return l.then(function(e){var t,n=null==(t=e.headers)?void 0:t.get("content-type");return n&&oe.some(function(e){return-1<n.indexOf(e)})?(f=!0,t=e.clone(),u=t.clone(),t.clone().text()):(u=e,"[object Object]")}).then(function(r){return t(o,void 0,void 0,function(){return n(this,function(e){switch(e.label){case 0:p=r,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,c.text()];case 2:return[2,e.sent()];case 3:return e.sent(),[2,"Radar: Request.text()失败"];case 4:return[2]}})})}).then(function(e){s._config=e;var t=null;return f?(t=u.clone()).data=p:t=u,a.forEach(function(e){(e=e.response)&&(t=e(t,s)||t)}),u},function(t){throw a.forEach(function(e){(e=e.responseError)&&(t=e(t,s)||t)}),t})}function ae(){var n=[];function t(e){-1!==(e=n.indexOf(e))&&n.splice(e,1)}function e(e){return n.push(e),t.bind(void 0,e)}return{on:e,off:t,once:function(t){var n=e(function(e){t(e),n()});return n},emit:function(t){n.forEach(function(e){return e(t)})}}}function se(e){return(e=new RegExp("(?:^|; ?)".concat(e,"=(1|0)(;|$)")).exec(document.cookie))&&e[1]}var ue=["radar_init","h5_load","fmp","main_api","h5_custom_metric"];function le(e){var t=e.dimension,n=e.value;if(e=t.event_name,ue.indexOf(e)<0)return!1;if(!W(n))return!1;switch(e){case"fmp":var r=n.fmp_time;return!(!n.fmp||!r);case"h5_load":return r=n.total,!(!n.load_event_time||!r);case"h5_custom_metric":return r=n.custom_metric_timestamp,!(!t.custom_metric_name||!r)}return!0}function fe(e){var t=e.dimension,n=(e=e.value,t.custom_failed),r=t.api,o=t.status,i=t.res_type,a=t.protocol,s=(t=t.cached,e.duration),c=e.size;return"boolean"==typeof(void 0!==n&&n)&&"string"==typeof(void 0===r?"":r)&&"number"==typeof(void 0===o?0:o)&&"string"==typeof(void 0===i?"":i)&&"string"==typeof(void 0===a?"":a)&&"boolean"==typeof(void 0!==t&&t)&&"number"==typeof(void 0===s?0:s)&&"number"==typeof(void 0===c?0:c)&&W(e)}function pe(e){var t=(e=e.dimension).error_type;if([e.error_cons_type,t,e.msg].some(function(e){return null==e}))return!1;var n,t=e.col,r=e.line;return e.sample_rate,e.event_client_timestamp,e=function(e,t){var n={};for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]]);return n}(e,["col","line","sample_rate","event_client_timestamp"]),!(t&&"number"!=typeof t||r&&"number"!=typeof r)&&("object"==typeof(n=e)&&Object.keys(n).every(function(e){return void 0===n[e]||"string"==typeof n[e]}))}function de(e){var t=e.dimension,n=(e=e.value,t.failed);if("boolean"!=typeof n)return!1;if(n){var r=t.res_path;if("string"!=typeof t.file||"string"!=typeof r)return!1}return!!n||"string"==typeof t.file&&W(e)}function he(e){var t=e.value;return e=e.dimension.name,!(void 0!==t&&!W(t)||!e)}function ve(e){var t=!0;if((e=e.dimension.data)instanceof Array){if(0===e.length)return!1;e.forEach(function(e){"string"!=typeof e.com&&(t=!1)})}return t}var me={load:le,api:fe,resource:de,error:pe,event:he,blood:ve};function ge(e){return e?Object.keys(l$3).map(function(e){return l$3[e]}).indexOf(e.key)<0?(u$4("117"),!1):me[e.key](e):(u$4("116"),!1)}function we(n){function r(){n=n.replace(/^\s*/,"")}function e(e){return r(),n[0]===e&&(n=n.slice(1),1)}function o(){r();var e=/^([^\s,;=\\]+)(.*)/.exec(n);if(e)return n=e[2],e[1]}if(n&&"string"==typeof n){for(var t,i=[];t=o();){for(var a={name:t},s={};e(";");){var c,l,u=void 0;(u=o())&&(c=void 0,e("=")&&(c=function(){if(r(),'"'!==n[0])return o();n=n.slice(1);for(var e="";n.length;){var t=/^([^"\\]*)(.*)/.exec(n);if(t){if(e+=t[1],'"'===t[2][0])return n=t[2].slice(1),e;e+=t[2][1],n=t[2].slice(2)}}}(),l=void 0,(l=/([,;].*)/.exec(n))&&(n=l[1])),s[l=u.toLowerCase()]||(s[l]=1,"dur"===l?a.duration=parseFloat(c)||0:"desc"===l?a.description=c||"":a[u]=c))}if("sec"===a.unit&&a.duration&&(a.duration*=1e3),delete a.unit,i.push(a),!e(","))break}return i.length?i:void 0}}function _e(){m$2[_$3]&&(m$2[_$3][b$3]=!0)}function be(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function Re(e,t){var n;return null!=(n=null==m$2?void 0:m$2[_$3])&&n[e],null!=(n=null==m$2?void 0:m$2[_$3])&&n[x]?m$2[_$3][e]:void 0===t?null:t}function Oe(e,t){try{m$2[_$3][e]=t}catch(e){u$4("1000")}}function Te(e){return JSON.parse(JSON.stringify(e))}function je(e){try{if(window&&window.localStorage){var t=window.localStorage.getItem(e);if(t)try{return JSON.parse(t)}catch(e){return t}}}catch(e){return null}return null}function Ae(e,t){try{if(window&&window.localStorage)return window.localStorage.setItem(e,JSON.stringify(t)),!0}catch(e){return!1}return!1}function Ie(e){try{var t;if(window&&window.localStorage&&"undefined"!=typeof Storage&&window.localStorage instanceof Storage)return Ae(e,(t=1e8<(t=Number(je(e))||0)+1?0:t)+1),t}catch(e){}}function Le(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];1==+Ce(location.search.slice(1)).debug&&s$2.apply(void 0,o$1(["[radar] ".concat(e,": ")],r$1(t),!1))}function Ce(e){var t,n,r={};e=e.split("&");try{for(var o=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&r>=e.length?void 0:e)&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),i=o.next();!i.done;i=o.next()){var a=r$1(i.value.split("="),2),s=a[0],c=a[1];s in r?r[s]instanceof Array?r[s].push(c):r[s]=[r[s],c]:r[s]=c}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r}function qe(e,t){null!==window&&void 0!==window&&window.__RADAR_PERFORMANCE_TIMING_||(window.__RADAR_PERFORMANCE_TIMING_={}),window.__RADAR_PERFORMANCE_TIMING_[e]=t}function Ne(e){if(-1===(n=(e=void 0===e?location.href:e).lastIndexOf("?")))return{page:e};var t=e.slice(0,n),n=e.slice(n+1);return{url:e,page:t,params:Ce(n)}}function De(e){throw new Error("radar error "+e)}var v$3=function(){return(v$3=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function _$2(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function y$4(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||((r=r||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}var b$2=["c_dimension1","c_dimension2","c_dimension3","release_tag","product_version","sub_app"],w=function(){function e(e){var t,a=this,n=(this.queueConfig={wait:1e3,maxBatchLength:200},this.logQueue=[],this.preStoredLogQueue=[],this.batchTimer=0,this.eventName="onpagehide"in window?"pagehide":"beforeunload",this.customDimension={},this.runtimeIdMap={},this.randomSampling=Math.random(),this.commonDimension={},this.isInYoda=!1,this.sampleData={isHit:!0,core:1},this.ignoreList=["https://web-trace.ksapisrv.com/ktrace/collect"],this.broadcastSample=ae(),this.didRate=void 0,this.collect=function(e,t,n){var r=Te({key:e,dimension:t=void 0===t?{}:t,value:n=void 0===n?{}:n});if(!a.sampleData||!1!==a.sampleData.isHit){if(!ge(r))return u$4("107","key: ".concat(r.key)),void a.collect(l$3.EVENT,{sample_rate:t.sample_rate,message:"radar上报日志类型错误",name:"radar_log_error",extra_info:JSON.stringify(r)},{});Object.keys(r.value).forEach(function(e){r.value[e]=r.value[e].toString()}),a.decorateLog(r);var o=a.getCommonData(),i=o.app_version_name;if(delete o.app_version_name,(e=new p$3(function(e,t){e.dimension.app_version_name=i,e.dimension.did_rate=a.didRate;var n=(null==(n=null==e?void 0:e.dimension)?void 0:n.event_client_timestamp)||Date.now(),r=(null==(r=null==e?void 0:e.dimension)?void 0:r.radar_session_id)||a.radarSessionId;return v$3(v$3(v$3({},e),o),{event_client_timestamp:n,event_trigger_source:"H5",radar_session_id:r})})).use(function(e,t){return e.key&&"load"===e.key&&(e.dimension=v$3(v$3({},e.dimension),{load_device_increase_id:Ie("LOAD_DEVICE_INCREASE_ID"),load_session_increase_id:a.genSessionIncreaseId("LOAD_SESSION_INCREASE_ID")})),e.key&&"load"!==e.key&&(e.dimension=v$3(v$3({},e.dimension),{other_device_increase_id:Ie("OTHER_DEVICE_INCREASE_ID"),other_session_increase_id:a.genSessionIncreaseId("OTHER_SESSION_INCREASE_ID")})),t()}),(r=e.invoke(r))instanceof Error)throw r;try{window.dispatchEvent(new CustomEvent("get-radar-next-data",{detail:{kv:Te(r)}}))}catch(e){}if(delete r.dimension.broadcast_info,a.weblog?a.logQueue.push(r):(r.base_href=location.href,a.preStoredLogQueue.push(r)),Le("radarLogNext",JSON.parse(JSON.stringify(r))),a.logQueue.length>a.queueConfig.maxBatchLength-1)return a.flush(),clearTimeout(a.batchTimer),void(a.batchTimer=0);a.batchTimer||(a.batchTimer=window.setTimeout(function(){a.flush(),clearTimeout(a.batchTimer),a.batchTimer=0},a.queueConfig.wait))}},this.flush=function(){var e;a.logQueue.length<=0||(e=null,(e=a.config.httpReportFirst?e:a.reportByBridge())&&!a.config.httpReportFirst||a.reportByHttp(),a.logQueue=[])},"object"==typeof e&&null!==e||De("108"),"string"!=typeof e.projectId&&De("109"),Re(S$2));this.radarSessionId=null!=n?n:be(),this.config=e,this.sampling="number"==typeof(t=null!=(n=this.config.sampling)?n:1)&&0<=t&&t<=1?t:(u$4("110"),1),this.bindWeblogger(e.weblogger),null!=(n=this.config)&&n.ignoreList&&Array.isArray(null==(e=this.config)?void 0:e.ignoreList)&&(this.ignoreList=this.ignoreList.concat(this.config.ignoreList.map(function(e){return e.replace(/^(https?:)?\/\//,"")}))),this.queueConfig=v$3(v$3({},this.queueConfig),null!=(n=this.config)&&n.queueConfig?this.config.queueConfig:{}),null!=(e=this.config)&&e.customDimensions&&this.setDimensions(null==(n=this.config)?void 0:n.customDimensions),B(window,this.eventName,this.flush),"undefined"!=typeof window&&window.yodaCollectErrorDataDestroy&&window.yodaCollectErrorDataDestroy()}return e.prototype.genSessionIncreaseId=function(e){return this.runtimeIdMap[e]||(this.runtimeIdMap[e]=0),this.runtimeIdMap[e]++},e.prototype.bindWeblogger=function(e){var t,s=this;if(null!=e&&"object"!=typeof e)De("106");else{if(this.weblog)return void s$2("122");this.weblog=e,this.updateUrlPackage(),void 0!==(null==(t=null==e?void 0:e.logger)?void 0:t.radarUrl)&&this.ignoreList.push(null==(t=null==e?void 0:e.logger)?void 0:t.radarUrl),void 0!==(null==(t=null==e?void 0:e.logger)?void 0:t.url)&&this.ignoreList.push(null==(t=null==e?void 0:e.logger)?void 0:t.url),this.isInYoda=!(null==(t=null==(e=this.weblog)?void 0:e.Utils)||!t.yoda),this.getSampleData()}0<this.preStoredLogQueue.length&&(this.preStoredLogQueue.forEach(function(e){if(void 0!==(t=s.sampleData["load"===e.key?"core":e.key])&&(e.dimension.sample_rate=t),"load"===e.key?s.sampleData.core:e.dimension.sample_rate*s.sampleData.core>=s.randomSampling){var t=s.getCommonData(),n=(e.dimension.app_version_name=t.app_version_name,e.h5_extra_attr=JSON.stringify(v$3(v$3({},null==(t=s.weblog.commonPackage)?void 0:t.getH5ExtraAttr()),JSON.parse(e.h5_extra_attr))),Ne(e.base_href)),r=null==(t=s.weblog.logConfig)?void 0:t.urlMap,t={};if("function"==typeof r)try{var o=r(n);"string"==typeof o?t={page:o}:"object"==typeof o&&(t={page:o.page,params:o.params})}catch(e){}else if("object"==typeof r){var i,a="";for(i in r)if(-1<(n.page||n.url||"").indexOf(i)){a=r[i];break}a&&(t={page:a})}e.url_package={page:t&&t.page||n.page},o=s.referUrlPackage&&s.referUrlPackage.toJSON(),e.refer_url_package=o,delete e.base_href,s.logQueue.push(e)}}),this.preStoredLogQueue=[],this.flush())},e.prototype.getSampleData=function(){var e,t,n=this;this.isInYoda?(this.sampleData={isHit:!0,core:this.sampling,api:1,resource:.1,error:1,event:1},t=window.updateYodaSampleRateWithParams,window.updateYodaSampleRateWithParams=function(e){c$1("104",e),n.updateYodaSampleRate(e),n.broadcastSample.emit(n.sampleData),t&&t(e)},window.__yodaCommonDataObject__&&window.__yodaCommonDataObject__.sampleData?(this.updateYodaSampleRate(window.__yodaCommonDataObject__.sampleData),this.collect(l$3.EVENT,{name:"客户端采样率注入成功",event_type:"radar_sample_inject_success"},{})):"function"==typeof(null==(e=null==(e=null==(e=this.weblog)?void 0:e.Utils)?void 0:e.yoda)?void 0:e.getWebviewLoadPerf)&&null!=(e=this.weblog)&&e.Utils.yoda.getWebviewLoadPerf().then(function(e){null!=e&&e.sampleData&&n.updateYodaSampleRate(e.sampleData)})):this.sampleData={isHit:this.samplingControl(this.sampling),core:this.sampling}},e.prototype.updateYodaSampleRate=function(e){var t=this,n=null;try{var r=e,n="string"==typeof r?JSON.parse(r):r}catch(e){return void c$1("error: ",e)}n&&Object.keys(n).forEach(function(e){"load"===e?t.sampleData.core=n[e]:"did_rate"===e?t.didRate=n[e]:t.sampleData[e]=n[e]})},e.prototype.updateUrlPackage=function(){var e;null!=(e=this.weblog)&&e.currentUrlPackage&&(this.currentUrlPackage=this.weblog.currentUrlPackage,this.referUrlPackage=this.weblog.referUrlPackage)},e.prototype.setDimensions=function(t){var n=this,e=Object.keys(t);e.some(function(e){return-1===b$2.indexOf(e)})&&u$4("113","".concat(e.join("、"))),e.forEach(function(e){null==t[e]?delete n.customDimension[e]:n.customDimension[e]=t[e]})},e.prototype.setCommonDimension=function(e,t,n){this.commonDimension[e]=(n=void 0===n||n)||null==(n=this.commonDimension[e])?t:n},e.prototype.decorateLog=function(e){this.currentUrlPackage||this.updateUrlPackage(),0<Object.keys(this.customDimension).length&&Object.assign(e.dimension,this.customDimension),0<Object.keys(this.commonDimension).length&&Object.assign(e.dimension,this.commonDimension),this.currentUrlPackage&&this.currentUrlPackage.page!==(null==(e=null==(e=this.weblog)?void 0:e.currentUrlPackage)?void 0:e.page)&&(this.flush(),this.updateUrlPackage())},e.prototype.samplingControl=function(e){return null!==e&&"number"==typeof e&&this.randomSampling<e},e.prototype.getCommonData=function(){var e,t=null==(t=null==(t=null==(t=this.weblog)?void 0:t.commonPackage)?void 0:t.app_package)?void 0:t.version_name,t={h5_extra_attr:JSON.stringify(v$3(v$3({},null==(e=null==(e=this.weblog)?void 0:e.commonPackage)?void 0:e.getH5ExtraAttr()),{app_version_name:t,url:location.href,hash:location.hash,online:null===navigator||void 0===navigator?void 0:navigator.onLine,downlink:null==(e=null===navigator||void 0===navigator?void 0:navigator.connection)?void 0:e.downlink,rtt:null==(e=null===navigator||void 0===navigator?void 0:navigator.connection)?void 0:e.rtt})),url_package:this.currentUrlPackage&&this.currentUrlPackage.toJSON(),refer_url_package:this.referUrlPackage&&this.referUrlPackage.toJSON(),app_version_name:t,project_id:null==(e=this.config)?void 0:e.projectId};return"1"===se("radar_report_test")&&(t.is_report_test=!0),t},e.prototype.reportByHttp=function(){var e=this.getCommonData(),t=(e={project_id:this.config.projectId,radar_session_id:this.radarSessionId,h5_extra_attr:e.h5_extra_attr},this.logQueue.filter(function(e){return"load"===e.key})),n=this.logQueue.filter(function(e){return"load"!==e.key});Array.isArray(t)&&t.length&&this.collectLog(e,t,"radarSDK"),Array.isArray(n)&&n.length&&this.collectLog(e,n,"radarSDKSupplement")},e.prototype.collectLog=function(e,t,n){var r;"function"!=typeof(null==(r=this.weblog)?void 0:r.collect)&&"function"!=typeof(null==(r=this.weblog)?void 0:r.sendByHttp)?u$4("114"):(this.weblog.sendByHttp||this.weblog.collect).call(this.weblog,"RADAR",{name:"radar_log",params:v$3(v$3({},e),{data:y$4([],_$2(t),!1)}),serviceName:n})},e.prototype.reportByBridge=function(){var t=null==(n=null==(n=this.weblog)?void 0:n.Utils)?void 0:n.yoda;if(!t)return!1;var e,n=this.logQueue.filter(function(e){return"load"===e.key}),r=this.logQueue.filter(function(e){return"load"!==e.key});try{return n.forEach(function(e){"function"==typeof(null==(e=t.sendSummarizedLog({key:"h5_load",data:e}))?void 0:e.catch)&&e.catch(function(e){u$4("123",e)})}),r.length&&"function"==typeof(null==(e=t.sendRadarLog({data:r}))?void 0:e.catch)&&e.catch(function(e){u$4("124",e)}),!0}catch(e){return!1}},e}(),d$2=function(e,t){return(d$2=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},p$2=function(){return(p$2=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function l$2(e,t){var n={};for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]]);return n}var u$3={redirect:{end:"redirectEnd",start:"redirectStart"},dns:{end:"domainLookupEnd",start:"domainLookupStart"},dns_start:{end:"domainLookupEnd",start:"navigationStart"},tcp:{end:"connectEnd",start:"connectStart"},tcp_start:{end:"connectEnd",start:"navigationStart"},redirect_count:{custom:function(e,t){return t.redirectCount}},ssl:{custom:function(e,t){return t.connectEnd&&t.secureConnectionStart?t.connectEnd-t.secureConnectionStart:null}},ssl_start:{custom:function(e,t){return t.secureConnectionStart&&t.navigationStart?t.secureConnectionStart-t.navigationStart:null}},ttfb:{end:"responseStart",start:"requestStart"},request_start:{end:"requestStart",start:"navigationStart"},trans:{end:"responseEnd",start:"responseStart"},dom_parse:{end:"domInteractive",start:"responseEnd"},dom_parse_start:{end:"domInteractive",start:"navigationStart"},blank:{end:"domLoading",start:"navigationStart"},fb:{end:"responseStart",start:"navigationStart"},dom_ready:{end:"domContentLoadedEventEnd",start:"navigationStart"},total:{end:"loadEventStart",start:"navigationStart"},resource:{end:"loadEventStart",start:"domInteractive"},fp:{custom:function(){if("function"!=typeof performance.getEntries)return null;var e=performance.getEntries().filter(function(e){return"first-paint"===e.name})[0];return e?Math.ceil(e.startTime+e.duration):null}},js_cost:{custom:function(){if("function"!=typeof performance.getEntries)return null;var e=h$3(),t=performance.getEntries(),n=performance.getEntries().filter(function(e){return"navigation"===e.initiatorType})[0],t=t.filter(function(e){return"script"===e.initiatorType})[0],n=n?n.domComplete:e.domComplete-e.navigationStart;return t&&n?n-t.fetchStart:null}},tti:{end:"domInteractive",start:"navigationStart"},protocol:{custom:function(e,t){return t.nextHopProtocol}},dom_num:{custom:function(){return"undefined"!=typeof document&&void 0!==document.all?document.all.length:null}}},f$3={main_api:{end:"apiEnd",start:"apiStart",notCatchIfUndefined:!0},main_api_offset:{end:"apiStart",start:"responseEnd",notCatchIfUndefined:!0},fmp:{end:"fmp_time",start:"navigationStart",notCatchIfUndefined:!0}},_$1={navigation_start_time:"navigationStart",fetch_start_time:"fetchStart",dns_start_time:"domainLookupStart",dns_end_time:"domainLookupEnd",connect_start_time:"connectStart",ssl_start_time:"secureConnectionStart",request_start_time:"requestStart",response_start_time:"responseStart",response_end_time:"responseEnd",dom_interactive_time:"domInteractive",dom_loading_time:"domLoading",dom_ready_time:"domContentLoadedEventEnd",load_event_time:"loadEventStart",connect_end_time:"connectEnd",load_event_end:"loadEventEnd",dom_complete:"domComplete",dom_content_loaded_event_start:"domContentLoadedEventStart",redirect_start:"redirectStart",redirect_end:"redirectEnd",radar_init_time:"radar_init_time",fmp_time:"fmp_time"};function h$2(n,e){if(!Array.isArray(e))return-1;var r=-1;return e.forEach(function(e,t){new RegExp(e).test(n)&&(r=t)}),r}var v$2=function(t){function e(e){var _=this;return(_=t.call(this,{core:null==e?void 0:e.core,key:l$3.LOAD,version:"1.2.5",name:"RadarNavigationCollect"})||this).hasFMP=!1,_.syncMetricNum=0,_.customKeys=[],_.custom_metric={},_.optionsMainAPI=[],_.mainAPIList=[],_.radarMainApiList=[],_.mainJSList=[],_.radarMainJSList=[],_.radarTiming={radar_init_time:void 0,fmp_time:void 0,fmp:void 0,apiStart:void 0,apiEnd:void 0},_.h5Load=function(){var e=_.getPerformanceData();_.collect(p$2({event_name:"h5_load"},e))},_.dealAPI=function(e){return _.cacheAndCalculateMainAPI(e),_.addMainApiResult(e),_.mainAPIList.filter(function(e){return!!e.url}).length!==_.mainAPIList.length||void 0===_.radarTiming.fmp},_.addMainJSResult=function(e){if(!_.mainJSList||0===_.mainJSList.length)return!1;var t,n,r,o,i,a,s,c,l,u,p,f,d,m,h,v=h$2((e.file||"").replace(/\?.+$/,""),_.mainJSList);return-1<v&&!_.radarMainJSList[v].file&&(t=e.file,n=e.cached,r=e.size,o=e.failed,i=e.res_type,a=e.protocol,s=e.fb,c=e.dns,l=e.tcp,u=e.ssl,p=e.ttfb,f=e.trans,d=e.total,m=e.fetch_start,h=e.duration,e=e.start_time,_.radarMainJSList[v]={file:t,cached:n,size:r,failed:o,res_type:i,protocol:a,fb:s,dns:c,tcp:l,ssl:u,ttfb:p,trans:f,total:d,fetch_start:m,duration:h,start_time:e,reg:_.mainJSList[v]}),_.radarMainJSList.filter(function(e){return!!e.file}).length!==_.mainJSList.length},e.core||De("212"),"string"==typeof e.mainApi?(_.optionsMainAPI.push(e.mainApi),_.mainAPIList.push({}),_.radarMainApiList.push({})):Array.isArray(e.mainApi)&&(3<e.mainApi.length&&s$2("207"),_.optionsMainAPI=e.mainApi.slice(0,3),_.optionsMainAPI.forEach(function(){_.mainAPIList.push({}),_.radarMainApiList.push({})})),"string"==typeof e.mainJs?(_.mainJSList.push(e.mainJs),_.radarMainJSList.push({})):Array.isArray(e.mainJs)&&(3<e.mainJs.length&&s$2("211"),_.mainJSList=e.mainJs.slice(0,3),_.mainJSList.forEach(function(){return _.radarMainJSList.push({})})),performance.timing?_.init():(null!=(e=_.core)&&e.collect("event",{name:"radar_error",message:"performance.timing 不存在无法收集数据",category:l$3.LOAD}),u$4("208")),_}var n=e,r=t;if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=n}return d$2(n,r),n.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o),e.prototype.init=function(){this.radarTiming.radar_init_time=Date.now();var e,t=this.getPerformanceData();this.collect(p$2({event_name:"radar_init"},t)),null!=(e=null==(t=this.core)?void 0:t.setCommonDimension)&&e.call(t,"happen_stage","during_fmp"),0<performance.timing.loadEventStart?this.h5Load():B(window,"load",this.h5Load)},e.prototype.customStage=function(e,t){var n,r;void 0===t&&(t={sendTimeline:!0}),this.isHit?(void 0!==e&&"string"==typeof e&&""!==e||De("206"),this.isValidTimestamp(t.timestamp,"custom_stage "+e)&&(n=t.timestamp||Date.now(),r=this.customKeys.length-this.syncMetricNum,this.customKeys.includes(e)?u$4("204",e):t.sendTimeline&&2<this.syncMetricNum||!t.sendTimeline&&5<r?u$4("205",e):n&&(this.custom_metric[e+"_time"]=n,this.customKeys.push(e),!t||!0!==t.sendTimeline&&null!=t.sendTimeline||(r=this.getPerformanceData(),this.collect(p$2(p$2({},r),{stack:(new Error).stack,event_name:"h5_custom_metric",custom_metric_name:e,custom_metric_timestamp:n})),this.syncMetricNum++)))):u$4("200")},e.prototype.isValidTimestamp=function(e,t){var n;if(void 0===t&&(t="fmp"),void 0!==e&&"number"!=typeof e)De("201");else if(void 0!==e&&e<performance.timing.navigationStart)return s$2("210","".concat(t)),null!=(n=this.core)&&n.collect("event",{name:"radar_error",message:"【210】".concat(t),extra_info:{timestamp:e,navigationStart:performance.timing.navigationStart}}),!1;return!0},e.prototype.fmp=function(e){var t,n;this.isHit?this.isValidTimestamp(e)&&(e=e||Date.now(),this.hasFMP?s$2("202"):e&&performance.timing&&(null!=(n=null==(t=this.core)?void 0:t.setCommonDimension)&&n.call(t,"happen_stage","after_fmp"),this.hasFMP=!0,this.radarTiming.fmp_time=e,performance.timing.radarFmp=e,n=this.getPerformanceData(),performance.timing.fmp=this.radarTiming.fmp=n.fmp,this.collect(p$2({event_name:"fmp",stack:(new Error).stack},n)))):s$2("200")},e.prototype.getPerformanceData=function(){var t=p$2(p$2({},Te(performance.timing)),this.radarTiming),n=K(p$2(p$2({},u$3),f$3),t);return Object.keys(_$1).forEach(function(e){0<=t[_$1[e]]&&(n[e]=t[_$1[e]])}),["radar_main_js_start","lcp","cls","fid","fcp"].forEach(function(e){var t=window.__RADAR_PERFORMANCE_TIMING_&&window.__RADAR_PERFORMANCE_TIMING_[e];!t&&0!==t||(n[e]=t)}),n},e.prototype.cacheAndCalculateMainAPI=function(e){var t;void 0===this.radarTiming.fmp&&(e.before_hook_time&&(t=this.radarTiming.apiStart,this.radarTiming.apiStart=t?Math.min(t,e.before_hook_time):e.before_hook_time),e.after_hook_time&&(t=this.radarTiming.apiEnd,this.radarTiming.apiEnd=t?Math.max(t,e.after_hook_time):e.after_hook_time))},e.prototype.addMainApiResult=function(e){var t,n,r,o,i,a,s,c,l,u,p,f,d,m,h,v,_,g,y=h$2((e.api||"").replace(/\?.+$/,""),this.optionsMainAPI);-1<y&&(null==(g=this.mainAPIList[y])||!g.url)&&(g=e.api,t=e.status,n=e.size,r=e.cached,o=e.method,c=e.perfTime,i=e.protocol,a=e.custom_failed,s=e.res_type,_=l$2(e,["api","status","size","cached","method","perfTime","protocol","custom_failed","res_type"]),this.mainAPIList[y]=p$2({url:g,status:t,size_radar:n,cached:r,method:o,perfTime:c,protocol:i,res_type:s,custom_failed:a},_),c=_.fb,l=_.dns,u=_.tcp,p=_.ssl,f=_.ttfb,d=_.trans,m=_.total,h=_.fetch_start,v=_.duration,_=_.start_time,this.radarMainApiList[y]={api:g,status:t,size:n,cached:r,method:o,protocol:i,fb:c,dns:l,tcp:u,ssl:p,ttfb:f,trans:d,total:m,fetch_start:h,duration:v,custom_failed:a,res_type:s,reg:this.optionsMainAPI[y],start_time:_},this.radarTiming.fmp_time&&e.after_hook_time&&e.after_hook_time<this.radarTiming.fmp_time&&(g=this.getPerformanceData(),this.collect(p$2({event_name:"main_api"},g))))},e.prototype.destroy=function(){$(window,"load",this.h5Load),this.customStage=this.fmp=function(){s$2("213")}},e.prototype.collect=function(e){var t=e.protocol,n=e.event_name,r=(e.custom_metric,e.custom_metric_name),o=e.stack;e.main_api_list,e=l$2(e,["protocol","event_name","custom_metric","custom_metric_name","stack","main_api_list"]),this.baseCollect({value:e,dimension:{protocol:t,event_name:n,custom_metric_name:r,custom_metric:JSON.stringify(this.custom_metric),main_api_list:this.mainAPIList,radar_main_api_list:this.radarMainApiList,radar_main_js_list:this.radarMainJSList,is_official:1,stack:o}}),null!=(e=this.core)&&e.flush()},e}(d$3),g$3=function(e,t){return(g$3=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},y$3=function(){return(y$3=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function b$1(e,t){var n={};for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]]);return n}var k=M,L={navigation_start:"startTime",redirect_start:"redirectStart",redirect_end:"redirectEnd",dns_start:"domainLookupStart",dns_end:"domainLookupEnd",connect_start:"connectStart",connect_end:"connectEnd",ssl_start:"secureConnectionStart",request_start:"requestStart",response_start:"responseStart",response_end:"responseEnd"};function O(e,t){if(e)return"function"==typeof e.get?e.get(t):e[t.toLowerCase()]}function I(e){var t="";if("string"==typeof e)t=e;else try{t=JSON.stringify(e)}catch(n){t=String(e)}for(var n=0,r=0;r<t.length;r++){var o=t.charCodeAt(r);n+=o<128?1:o<2048?2:o<65536?3:o<1<<21?4:o<1<<26?5:o<1<<31?6:Number.NaN}return n}function P(e){var t=(n=document.location).protocol,n=n.host;return 0===e.indexOf("//")?t+e:0===e.indexOf("/")?"".concat(t,"//").concat(n).concat(e):e}function S$1(e){return e?"function"==typeof e.get?e.get("Content-Type"):e["content-type"]:null}var A=function(t){function e(e){var u=t.call(this,{core:null==(e=void 0===e?{}:e)?void 0:e.core,sampling:null==e?void 0:e.sampling,key:l$3.API,version:"1.2.5",name:"RadarAPICollect"})||this;return u.ignoreList=v$4,u.queue=[],u.logList=[],u.perfList=[],u.broadcastApi=ae(),u.initiatorTypeList=[],u.beforeHook=function(e){var t;0===(null==(t=e.url)?void 0:t.indexOf("data:"))||D(e.url,u.ignoreList)||D(e.url,(null==(t=u.core)?void 0:t.ignoreList)||[])||"js"===H(e.url)||"css"===H(e.url)||(t={api:P(e.url),method:e.method,request:e,startTime:Date.now()},u.queue.push(t))},u.afterHook=function(t,e){var n=u.queue.find(function(e){return e.request===t});if(n){delete n.request;var r=n.startTime,o=(n=b$1(n,["startTime"]),Date.now()),i=o-r,a=e.status;if("function"==typeof u.customizeRadarStatus)try{a=u.customizeRadarStatus(e)}catch(e){console.error(e)}var s=u.customHook({request:t,response:e,duration:i}),c=+O(e.headers,"Content-Length")||0,l=we(O(e.headers,"Server-Timing")),i=y$3(y$3(y$3({duration:i,logTime:Date.now(),status:a,size:+c,content_type:S$1(e.headers),custom_failed:!(200<=a&&a<300)},n),s),{before_hook_time:r,after_hook_time:o,trace_id:t.trace_id,server_timing:l});2===(null==(a=null==(c=O(e.headers,"Intercept-Result"))?void 0:c.split(";"))?void 0:a.length)&&null!=(n=u.core)&&n.setCommonDimension&&(u.core.setCommonDimension("intercept_result",a[0],!1),u.core.setCommonDimension("intercept_result_code",a[1],!1),i.api_intercept_result=a[0],i.api_intercept_result_code=a[1]),e.finalUrl&&(i.api=e.finalUrl),"string"==typeof e.text&&(i.responseData=e.text),0!==y$3(y$3({},e),{status:i.status}).status||s.intercept_report?u.mergeAPIPerf(void 0,i)||u.logList.push(i):(i.size&&0!=i.size||!i.responseData||(i.size=I(i.responseData)),delete i.responseData,delete i.server_timing,u.collect(i)),u.queue=u.queue.filter(function(e){return e.request&&e.request!==t})}},void 0!==(u.option=e)&&null!=e&&e.core||De("310"),void 0!==e.ignoreList&&(Array.isArray(e.ignoreList)||De("309"),e.ignoreList.forEach(function(e){"string"!=typeof e&&De("309")}),u.ignoreList=u.ignoreList.concat(e.ignoreList)),u.APIHook=e.APIHook,u.customizeRadarStatus=e.customizeRadarStatus,u.init(),u}var n=e,r=t;if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=n}return g$3(n,r),n.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o),e.prototype.init=function(){var t,n=this;try{this.observer=new PerformanceObserver(function(e){return n.observeAPI(e)}),this.observer.observe({entryTypes:["resource"]}),this.initiatorTypeList=[],!0!==this.option.ignoreXHR&&(this.initiatorTypeList.push("xmlhttprequest"),this.unhookXML=te(function(e){return n.beforeHook(e)},function(e,t){return n.afterHook(e,t)})),!0!==this.option.ignoreFetch&&(this.initiatorTypeList.push("fetch"),this.unhookFetch=ne(function(e){return n.beforeHook(e)},function(e,t){return n.afterHook(e,t)}))}catch(e){u$4("308"),null!=(t=this.core)&&t.collect("event",{name:"radar_error",message:"PerformanceObserver 不存在无法收集数据",category:l$3.API})}},e.prototype.customHook=function(e){var t={};if(void 0===this.APIHook)return t;if("function"!=typeof this.APIHook)return s$2("300"),t;var n={};try{n=this.APIHook(e)}catch(e){return s$2("301",e),{}}if(!n)return s$2("302"),t;e=n.response_msg;var r=n.response_code,o=n.status,i=n.custom_failed,a=n.intercept_report,n=n.broadcast_info;if(!0===Boolean(a)&&(t.intercept_report=!0),void 0!==e)try{var s=JSON.stringify(e);100<s.length&&s$2("307"),t.response_msg=s.slice(0,100)}catch(e){t.response_msg="response_msg返回结果异常",s$2("303")}return void 0!==r&&(a=Number(r),isNaN(a)?s$2("304"):t.response_code=a),void 0!==o&&(e=Number(o),isNaN(e)?s$2("305"):t.status=e),void 0!==i&&(!0===i||!1===i?t.custom_failed=i:s$2("306")),t.broadcast_info=n,t},e.prototype.observeAPI=function(e){var o=this;e.getEntriesByType("resource").forEach(function(t){var e,n,r;if(0===(null==(r=t.name)?void 0:r.indexOf("data:"))||D(t.name,o.ignoreList)||D(t.name,(null==(r=o.core)?void 0:r.ignoreList)||[]))return!1;"api"===J(t)&&((r=K(k,t)).perfTime=Date.now(),null!=(e=null==(e=t.serverTiming)?void 0:e.map(function(e){return{name:e.name,duration:e.duration,description:e.description||void 0}}))&&e.length||(e=void 0),n={encoded_body_size:t.encodedBodySize,decoded_body_size:t.decodedBodySize},Object.keys(L).forEach(function(e){n[e]=Number(t[L[e]]+performance.timing.navigationStart)}),r=y$3(y$3(y$3(y$3({},r),{api:r.file}),n),{server_timing:e}),o.mergeAPIPerf(r)||o.perfList.push(r))})},e.prototype.destroy=function(){this.unhookXML&&this.unhookXML(),this.unhookFetch&&this.unhookFetch(),this.observer&&this.observer.disconnect()},e.prototype.mergeAPIPerf=function(e,t){if(e?t=this.takeItem(e,this.logList):t&&(e=this.takeItem(t,this.perfList)),!e||!t)return!1;if(!0===t.intercept_report)return!0;var n,r=Object.assign({},t,e,{size:e.size||t.size});return delete r.file,r.size&&0!=r.size||!r.responseData||(r.size=I(r.responseData)),delete r.responseData,(t=t.server_timing||e.server_timing)&&(n=null,t.map(function(e){"total-timing"===e.name&&(n=null!=(e=e.duration)?e:null)}),r.total_server_timing=n,r.server_data_list=JSON.stringify(t)),delete r.server_timing,this.collect(r),!0},e.prototype.takeItem=function(e,t){var n,r=(e.api||"").replace(/\?.+$/,"");if(-1!==(e=t.findIndex(function(e){return e=(e.api||"").replace(/\?.+$/,""),r===e})))return n=t[e],t.splice(e,1),n},e.prototype.collect=function(o){var i=this,e=o.res_type,t=o.protocol,n=o.api,r=o.custom_failed,a=o.status,s=o.cached,c=o.method,l=o.response_code,u=o.response_msg,p=(o.has_fmp,o.server_data_list),f=o.content_type,d=o.broadcast_info,m=o.before_hook_time,h=o.after_hook_time,v=o.api_intercept_result,_=o.api_intercept_result_code,g={dimension:{before_hook_time:m,after_hook_time:h,res_type:e,protocol:t,api:n,custom_failed:r,status:a,cached:s,method:c,response_code:l,response_msg:u,content_type:f,broadcast_info:d,is_official:1,server_data_list:p,trace_id:o.trace_id,api_intercept_result:v,api_intercept_result_code:_,has_timing_allow:o.has_timing_allow},value:b$1(o,["res_type","protocol","api","custom_failed","status","cached","method","response_code","response_msg","has_fmp","server_data_list","content_type","broadcast_info","before_hook_time","after_hook_time","api_intercept_result","api_intercept_result_code","trace_id","has_timing_allow"])};this.broadcastApi.emit(Te(o)),0===a&&X(this.option.isIgnoreInvalidStatusCode)?new Promise(function(t,e){var n,r;i.option.isIgnoreInvalidStatusCode&&(U(n=i.option.isIgnoreInvalidStatusCode(o))?(r=setTimeout(function(){return t(!1)},2e3),n.then(function(e){clearTimeout(r),t(!0===e)},e)):t(!0===n))}).then(function(e){e?s$2("异步拦截日志"):i.baseCollect(g)},function(e){i.baseCollect(g),u$4(e)}):this.baseCollect(g)},e}(d$3),g$2=function(e,t){return(g$2=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},_=function(){return(_=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},y$2=Object.assign({},M,{duration:{end:"responseEnd",start:"fetchStart"},cached_type:{custom:function(e,t){var n="hit_browser";if(0===t.transferSize||0===t.duration)return n;if(null==t.transferSize&&(0===t.domainLookupStart||t.responseStart===t.fetchStart))return n;if(t.serverTiming&&t.serverTiming.some(function(e){return"cdn"===e.name})){if(t.serverTiming.some(function(e){return"miss"===e.name}))return"miss_cdn";if(t.serverTiming.some(function(e){return"hit"===e.name}))return"hit_cdn"}return"miss_browser"},crossOriginSkip:!0},cdn_duration:{custom:function(e,t){return t.serverTiming&&t.serverTiming.some(function(e){return"cdn"===e.name})?null==(t=null==(t=t.serverTiming)?void 0:t.find(function(e){return"total-timing"===e.name}))?void 0:t.duration:null},crossOriginSkip:!0,cachedSkip:!0},cdn_ip:{custom:function(e,t){if(t.serverTiming&&t.serverTiming.some(function(e){return"cdn"===e.name}))return null==(t=t.serverTiming.find(function(e){return"miss"===e.name||"hit"===e.name}))?void 0:t.description},crossOriginSkip:!0,cachedSkip:!0}}),v$1={fetch_start_time:"fetchStart",redirect_start:"redirectStart",redirect_end:"redirectEnd",dns_start:"domainLookupStart",dns_end:"domainLookupEnd",connect_start:"connectStart",connect_end:"connectEnd",ssl_start:"secureConnectionStart",request_start:"requestStart",response_start:"responseStart",response_end:"responseEnd"};function b(e){return Array.isArray(e)?e.map(function(e){var t=void 0===(t=e.tagName)?"":t,n=e.id;return e=e.getAttribute?e.getAttribute("class"):e.className||"",t=t.toLowerCase(),n&&(t+="#".concat(n)),e&&(t+=e.split(/\s+/g).map(function(e){return".".concat(e)}).join("")),t}).filter(function(e){return e}).join(","):""}var r,o,l,u,S=function(n){function e(e){var t,o=this;return(o=n.call(this,{core:null==e?void 0:e.core,sampling:null!=(t=null==e?void 0:e.sampling)?t:.1,version:"1.2.5",key:l$3.RES,name:"RadarResourceCollect"})||this).ignoreList=v$4,o.broadcastJs=ae(),o.onResError=function(e,t){var n;Q(e)||(n=(e.target.src||e.target.href||"").toString(),n={failed:!0,file:n="function"!=typeof e.target.getAttribute||""!==e.target.getAttribute("src")&&""!==e.target.getAttribute("href")?n:"",res_path:b(e&&e.path||e&&e.composedPath&&e.composedPath())},o.collect(n,t),o.broadcastJs.emit(n))},o.observeResource=function(e){e.getEntriesByType("resource").forEach(function(t){var e,n,r;if(0===t.name.indexOf("data:")||D(t.name,o.ignoreList)||D(t.name,(null==(e=o.core)?void 0:e.ignoreList)||[]))return!1;"resource"===J(t)&&(e=K(y$2,t),n={encoded_body_size:t.encodedBodySize,decoded_body_size:t.decodedBodySize},Object.keys(v$1).forEach(function(e){n[e]=Number(t[v$1[e]]+performance.timing.navigationStart)}),r=_(_({failed:!1},e),n),o.collect(r),setTimeout(function(){o.broadcastJs.emit(r)}))})},o.resourceHook=e.resourceHook,void 0!==e.ignoreList&&(Array.isArray(e.ignoreList)||De("802"),e.ignoreList.forEach(function(e){"string"!=typeof e&&De("802")}),o.ignoreList=o.ignoreList.concat(e.ignoreList)),o.init(),o}var t=e,r=n;if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=t}return g$2(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o),e.prototype.init=function(){var t,n=this;try{this.observeResource(performance),this.observer=new PerformanceObserver(function(e){return n.observeResource(e)}),this.observer.observe({entryTypes:["resource"]})}catch(e){u$4("801"),null!=(t=this.core)&&t.collect("event",{name:"radar_error",message:"PerformanceObserver 不存在无法收集数据",category:l$3.RES})}B(window,"error",function(e){return n.onResError(e)},!0),this.parseSeedLog()},e.prototype.parseSeedLog=function(){var n=this,e=Re(j,[]);e.length&&(e.map(function(e){var t=e.data;e=e.dimension||{},n.onResError(t,e)}),Oe(j,[]))},e.prototype.collect=function(e,t){var n=e.cached,r=e.failed,o=e.file,i=e.protocol,a=e.res_type,s=e.res_path,c=e.cached_type,l=e.cdn_ip,u=e.has_timing_allow;e=function(e,t){var n={};for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]]);return n}(e,["cached","failed","file","protocol","res_type","res_path","cached_type","cdn_ip","has_timing_allow"]);try{var p=this.resourceHook&&this.resourceHook({file:o,cached:n,protocol:i,res_type:a,failed:r});if(null!=p&&p.intercept_report)return}catch(e){u$4("803",e)}this.baseCollect({value:e,dimension:_({cached:n,failed:r,file:o,protocol:i,res_type:a,res_path:s,sample_rate:this.sampling,is_official:1,cached_type:c,cdn_ip:l,has_timing_allow:u},t)})},e.prototype.destroy=function(){this.isHit&&($(window,"error",this.onResError,!0),this.observer&&this.observer.disconnect())},e}(d$3),a$1=function(e,t){return(a$1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},c=function(){return"".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12)},s$1=function(e){return{name:e,value:1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1,delta:0,entries:[],id:c(),isFinal:!1}},u$2=function(e,t){try{var n;if(PerformanceObserver.supportedEntryTypes.includes(e))return(n=new PerformanceObserver(function(e){return e.getEntries().map(t)})).observe({type:e,buffered:!0}),n}catch(e){}},l$1=!1,p$1=!1,f$2=function(e){l$1=!e.persisted},m$1=function(){addEventListener("pagehide",f$2),addEventListener("beforeunload",function(){})},d$1=function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];p$1||(m$1(),p$1=!0),addEventListener("visibilitychange",function(e){e=e.timeStamp,"hidden"===document.visibilityState&&t({timeStamp:e,isUnloading:l$1})},{capture:!0,once:e})},v=function(e,t,n,r){var o;return function(){n&&t.isFinal&&n.disconnect(),0<=t.value&&(r||t.isFinal||"hidden"===document.visibilityState)&&(t.delta=t.value-(o||0),(t.delta||t.isFinal||void 0===o)&&(e(t),o=t.value))}},h$1=function(){return void 0===r&&(r="hidden"===document.visibilityState?0:1/0,d$1(function(e){return e=e.timeStamp,r=e},!0)),{get timeStamp(){return r}}},y$1=function(){return o=o||new Promise(function(t){return["scroll","keydown","pointerdown"].map(function(e){addEventListener(e,t,{once:!0,passive:!0,capture:!0})})})},F=[{name:"fid",collectFn:function(e){function t(e){e.startTime<r.timeStamp&&(n.value=e.processingStart-e.startTime,n.entries.push(e),n.isFinal=!0,i())}var n=s$1("FID"),r=h$1(),o=u$2("first-input",t),i=v(e,n,o);o?d$1(function(){o.takeRecords().map(t),o.disconnect()},!0):window.perfMetrics&&window.perfMetrics.onFirstInputDelay&&window.perfMetrics.onFirstInputDelay(function(e,t){t.timeStamp<r.timeStamp&&(n.value=e,n.isFinal=!0,n.entries=[{entryType:"first-input",name:t.type,target:t.target,cancelable:t.cancelable,startTime:t.timeStamp,processingStart:t.timeStamp+e}],i())})}},{name:"lcp",collectFn:function(e){function t(e){var t=e.startTime;t<i.timeStamp?(o.value=t,o.entries.push(e)):o.isFinal=!0,n()}var n,r=1<arguments.length&&void 0!==arguments[1]&&arguments[1],o=s$1("LCP"),i=h$1(),a=u$2("largest-contentful-paint",t);a&&(n=v(e,o,a,r),r=function(){o.isFinal||(a.takeRecords().map(t),o.isFinal=!0,n())},y$1().then(r),d$1(r,!0))}},{name:"cls",collectFn:function(e){function t(e){e.hadRecentInput||(o.value+=e.value,o.entries.push(e),n())}var n,r=1<arguments.length&&void 0!==arguments[1]&&arguments[1],o=s$1("CLS",0),i=u$2("layout-shift",t);i&&(n=v(e,o,i,r),d$1(function(e){e=e.isUnloading,i.takeRecords().map(t),e&&(o.isFinal=!0),n()}))}},{name:"fcp",collectFn:function(e){var t,n=s$1("FCP"),r=h$1(),o=u$2("paint",function(e){"first-contentful-paint"===e.name&&e.startTime<r.timeStamp&&(n.value=e.startTime,n.isFinal=!0,n.entries.push(e),t())});o&&(t=v(e,n,o))}}],g$1=function(t){function e(e){var r=t.call(this,{core:e.core,sampling:e.sampling,version:"1.2.5",key:l$3.EVENT,name:"RadarChromeMetricsCollect"})||this;return r.options={lcp:!1,cls:!1,fid:!1,fcp:!1},r.init=function(){var n=r.options;F.forEach(function(e){var t=e.name;n&&!n[t]||e.collectFn(function(e){var t=e.name;e=e.value,qe(t.toLocaleLowerCase(),Number(e)),r.baseCollect({dimension:{name:t.toLocaleLowerCase(),is_official:1},value:{duration:Number(e)}})})})},Object.assign(r.options,e.options),F.forEach(function(e){var t=se("radar_"+e.name);t&&(r.options[e.name]="1"===t)}),r.init(),r}var n=e,r=t;if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=n}return a$1(n,r),n.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o),e}(d$3),f$1=function(e,t){return(f$1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},s=function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},u$1=function(n){function e(e){var t=n.call(this,{core:e.core,sampling:e.sampling,key:l$3.EVENT,version:"1.2.5",name:"RadarEventCollect"})||this;return t.action={start:function(e){t._checkActionDimension(e),t.event({name:e.name,extra_info:e.extra_info,event_type:"radar_action_start"})},end:function(e){t._checkActionDimension(e),t.event({name:e.name,extra_info:e.extra_info,result_type:e.result_type,event_type:"radar_action_end"})}},t.parseSeedLog(),t}var t=e,r=n;if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=t}return f$1(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o),e.prototype.parseSeedLog=function(){var n=this,e=Re(A$1,[]);e.length&&(e.map(function(e){var t=e.dimension;e=e.value,n.event(t,e)}),Oe(A$1,[]))},e.prototype.event=function(e,t){var n;this.isHit?(e||De("402"),void 0!==e.name&&"string"==typeof e.name||De("402"),127<e.name.length&&(u$4("403"),e.name=e.name.slice(0,127)),e.is_official=1,t&&void 0!==t.duration&&("number"!=typeof t.duration||t.duration<0)&&De("404"),t&&void 0!==t.event_count&&("number"!=typeof t.event_count||t.event_count<0)&&De("405，".concat(t.event_count)),n={dimension:e,value:t},e&&e.extra_info&&"object"==typeof e.extra_info&&(n={dimension:s(s({},e),{extra_info:JSON.stringify(e.extra_info)}),value:t}),this.baseCollect(n)):s$2("401")},e.prototype.destroy=function(){this.event=function(){s$2("407")},this.action={start:function(){s$2("407")},end:function(){s$2("407")}}},e.prototype._checkActionDimension=function(e){if(!e)throw Error("408");void 0===e.extra_info||e.extra_info instanceof Object||De("406")},e}(d$3),a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},p=function(){return(p=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function f(e,t){var n={};for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]]);return n}(u=l=l||{}).SCRIPT="script",u.RES="res",u.API="api",u.VIDEO="video";var y=[];function m(e,t,n){var r,o;if(t&&(t instanceof Error||"object"==typeof t&&"string"==typeof t.message)){if("BridgeError"===(r=t.name||"ErrorLikeObject")&&"function"==typeof t.toJSON)try{var i=t.toJSON();delete i.name,delete i.message,o="".concat(t.message," (").concat(JSON.stringify(i),")")}catch(e){o=t.message||""}else o=t.message||"";i=t.stack||void 0}else o=null==t&&"Script error."===(null==n?void 0:n.message)?(r="CrossOriginError","".concat(e," - message: ").concat((null==n?void 0:n.message)||"<UNKNOWN>")):null===t&&null!=n&&n.message&&"Uncaught null"!==n.message?(r="Error","".concat(e," - message: ").concat(n.message)):(r=null==t?"".concat(t):typeof t,n=function(e){var t;try{t=e.toString(),e&&"object"==typeof e&&(t=JSON.stringify(e))}catch(e){}return"string"!=typeof t||""===t?t=null===e?"<NULL>":void 0===e?"<UNDEFINED>":""===t?"<EMPTY>":"<UNKNOWN>":2e3<t.length&&(t=t.substring(0,2e3)+"<<< ……"),t}(t),"".concat(e," - value: ").concat(n));return{error_type:l.SCRIPT,error_cons_type:r,msg:o,stack:i}}function g(e){for(var t=0;t<y.length;t++)if(d(y[t],e))return t;return-1}function d(e,t){return e.msg===t.msg&&e.stack===t.stack&&e.file===t.file&&e.line===t.line&&e.col===t.col}var h=function(t){function e(e){var r=t.call(this,{core:e.core,sampling:e.sampling,key:l$3.ERROR,version:"1.2.5",name:"RadarErrorCollect"})||this;return r.onError=function(e,t){var n;!(n=e).message&&null==n.lineno||(e=p(p({},m("Global Uncaught Exception",e.error,e)),{file:e.filename,line:e.lineno,col:e.colno}),r.isSameErrorAndReport(e,t))},r.onPromiseError=function(e,t){e=m("Unhandled Promise Rejection",e.reason),r.isSameErrorAndReport(e,t)},r.core=e.core,r.init(),r}var n=e,r=t;if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=n}return a(n,r),n.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o),e.prototype.init=function(){y.splice(0),B(window,"error",this.onError,!0),B(window,"unhandledrejection",this.onPromiseError),this.parseSeedLog()},e.prototype.destroy=function(){$(window,"error",this.onError,!0),$(window,"unhandledrejection",this.onPromiseError),this.captureException=function(){s$2("600")}},e.prototype.parseSeedLog=function(){var n=this,e=Re(T,[]);e.length&&(e.map(function(e){var t=e.data;e=e.dimension||{},"unhandledrejection"===(null==t?void 0:t.type)?n.onPromiseError(t,e):n.onError(t,e)}),Oe(T,[]))},e.prototype.isSameErrorAndReport=function(e,t){0<=g(e)||(y.push(e),setTimeout(function(){y.splice(g(e),1)},2e3),this.collect(e,t))},e.prototype.collect=function(e,t){var n,r,o,i,a,s,c,l;r=(n=e).error_cons_type,o=n.file,i=n.error_type,a=n.msg,s=n.col,c=n.line,l=n.stack,e={key:"error",value:f(n,["error_cons_type","file","error_type","msg","col","line","stack"]),dimension:{error_cons_type:r,file:o,error_type:i,msg:a,col:s,line:c,stack:l}},t=p(p({},e.dimension),t||{}),this.baseCollect({dimension:t,value:e.value})},e.prototype.captureException=function(e){this.isSameErrorAndReport(m("Captured Exception",e))},e}(d$3),extendStatics=function(e,t){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function __extends(e,t){function n(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var RADAR_KEY,__assign$1=function(){return(__assign$1=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function __read$1(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function __spreadArray(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||((r=r||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}function consoleWarn(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{var n=null===console||void 0===console?void 0:console.warn;return n&&n.call.apply(n,__spreadArray([console,"radar:"],__read$1(e),!1))}catch(e){return}}function samplingControl(e){return null!==e&&"number"==typeof e&&Math.random()<e}!function(e){e.LOAD="load",e.RES="resource",e.API="api",e.ERROR="error",e.SDK_ERROR="sdk_error",e.CUSTOM="custom",e.BATCH="batch",e.EVENT="event"}(RADAR_KEY=RADAR_KEY||{});var LOAD_EVENT_NAME,BaseCollect=function(){function e(e){if(void 0===(e=void 0===e?{}:e))throw new Error("radar error 100");if(!e.key)throw new Error("radar error 101");if(e.core&&("object"!=typeof e.core.sampleData||"function"!=typeof e.core.collect))throw new Error("radar error 121");this.baseOptions=e,this.key=e.key,this.version=e.version,this.name=e.name,e.core&&(this.core=e.core,this.sampling=this.getSample(e.sampling),void 0!==this.sampling&&(this.isHit=this.samplingControl(this.sampling)))}return e.prototype.updateCore=function(e){if("object"!=typeof e.sampleData||"function"!=typeof e.collect)throw new Error("radar error 121");this.core=e,this.sampling=this.getSample(this.baseOptions.sampling),this.sampling&&(this.isHit=this.samplingControl(this.sampling))},e.prototype.getSample=function(e){var t=null==(t=this.core)?void 0:t.sampleData.core;if(this.key===RADAR_KEY.LOAD)return t;if("number"!=typeof(e=void 0===e?1:e)||e<0||1<e)return consoleWarn("102，".concat(this.key,"，采用Core的采样率").concat(null==(n=this.core)?void 0:n.sampleData.core)),t;var n=null!=(n=this.core)&&n.isInYoda?void 0===(null==(n=this.core)?void 0:n.sampleData[this.key])?1:this.core.sampleData[this.key]:e;return t&&t<n?(consoleWarn("115，".concat(this.key)),t):n},e.prototype.samplingControl=function(e){var t;return(null==(t=this.core)?void 0:t.sampleData.isHit)&&samplingControl(e/this.core.sampleData.core)},e.prototype.baseCollect=function(e){var n;this.core?this.isHit?(n=e.value||{},n=Object.keys(n).filter(function(e){return null!==n[e]&&void 0!==n[e]}).reduce(function(e,t){return __assign$1(__assign$1({},e),((e={})[t]=n[t],e))},{}),this.core.collect(e.key||this.key,__assign$1(__assign$1({},e.dimension),{sample_rate:this.sampling,event_client_timestamp:handleNumber(Date.now()),collect_version:this.version,collect_name:this.name}),n)):consoleWarn("105,".concat(this.key,"：").concat(this.sampling)):consoleWarn("110,".concat(this.key))},e}();function handleNumber(e){return"number"==typeof e?e.toFixed():e}RADAR_KEY.LOAD,RADAR_KEY.RES,RADAR_KEY.API,RADAR_KEY.ERROR,RADAR_KEY.EVENT,function(e){e.RADAR_INIT="radar_init",e.H5_LOAD="h5_load",e.FMP="fmp",e.MAIN_API="main_api",e.H5_CUSTOM_METRIC="h5_custom_metric"}(LOAD_EVENT_NAME=LOAD_EVENT_NAME||{}),LOAD_EVENT_NAME.FMP,LOAD_EVENT_NAME.H5_LOAD,LOAD_EVENT_NAME.MAIN_API,LOAD_EVENT_NAME.RADAR_INIT,LOAD_EVENT_NAME.H5_CUSTOM_METRIC;var RadarSpaFmpCollect=function(n){function o(e){var t,r=this;return(r=n.call(this,{name:"radarSpaFmpSdk",core:e.core,sampling:e.sampling,key:RADAR_KEY.EVENT,version:"0.0.2-alpha.7"})||this).metricReportInit=function(e){r.routerBeforeachTimestamp=Date.now(),r.firstRoutePath||(r.firstRoutePath=e),r.checkPageSwitched(e),r.reportedMetrics||(r.reportedMetrics={sfmp:{},sffp:{},fmp:{},ffp:{}})},r.spa=function(e,t){var n;void 0===e&&(e="UNKNOWN"),void 0===t&&(t={}),null!=(n=r.core)&&n.collect?(r.ffp(e,t),r.sffp(e,t),r.checkPageRendered(e,function(){r.fmp(e),r.sfmp(e,t)})):console.error("RadarSpaFmpCollect----\x3e未找到core包中的collect方法")},r.fmp=function(e,t){void 0===e&&(e="UNKNOWN"),void 0===t&&(t=Date.now()),!r.baseCollect||r.pageSwitched||r.reportedMetrics.fmp&&r.reportedMetrics.fmp[e]||(t="number"==typeof t&&0<t?t:Date.now(),r.navCollectInstance&&r.navCollectInstance.fmp?(r.navCollectInstance.fmp(t),t=t-performance.timing.navigationStart,r.reportedMetrics.fmp&&(r.reportedMetrics.fmp[e]=t),r.isDebugger&&console.log("RadarSpaFmpCollect----\x3eFMP上报成功:",t,"ms")):console.error("请传入navCollect参数"))},r.sfmp=function(e,t,n){void 0===e&&(e="UNKNOWN"),void 0===t&&(t={}),void 0===n&&(n=Date.now()),!r.baseCollect||e&&r.reportedMetrics.sfmp&&r.reportedMetrics.sfmp[e]||(r.contentRendedTimestamp="number"==typeof n&&0<n?n:Date.now(),r.contentRendedTimestamp&&r.routerBeforeachTimestamp?!(n=r.contentRendedTimestamp-r.routerBeforeachTimestamp)||n<0?console.warn("RadarSpaFmpCollect----\x3esfmp的值小于0"):(r.baseCollect({key:o.key,dimension:{name:"radar_spa_sfmp",src:window.location.href,extra_info:t},value:{duration:n}}),r.routerBeforeachTimestamp=null,r.reportedMetrics.sfmp&&(r.reportedMetrics.sfmp[e]=n),r.isDebugger&&console.log("RadarSpaFmpCollect----\x3eSFMP上报成功:",n,"ms")):console.warn("RadarSpaFmpCollect----\x3econtentRendedTimestamp或者routerBeforeachTimestamp内部打点出现问题"))},r.ffp=function(e,t){var n;void 0===e&&(e="UNKNOWN"),void 0===t&&(t={}),!r.baseCollect||r.pageSwitched||r.reportedMetrics.ffp&&r.reportedMetrics.ffp[e]||(n=performance.now(),r.baseCollect({key:o.key,dimension:{name:"radar_spa_ffp",src:window.location.href,extra_info:t},value:{duration:n}}),r.reportedMetrics.ffp&&(r.reportedMetrics.ffp[e]=n),r.isDebugger&&console.log("RadarSpaFmpCollect----\x3eFFP上报成功:",n,"ms"))},r.sffp=function(e,t){var n;void 0===t&&(t={}),!r.baseCollect||e&&r.reportedMetrics.ffp&&r.reportedMetrics.sffp[e]||(r.routerBeforeachTimestamp?(r.sffpTimestamp=Date.now(),!(n=r.sffpTimestamp-r.routerBeforeachTimestamp)||n<0?console.warn("RadarSpaFmpCollect----\x3esffp的值小于0"):(r.baseCollect({key:o.key,dimension:{name:"radar_spa_sffp",src:window.location.href,extra_info:t},value:{duration:n}}),r.reportedMetrics.sffp&&(r.reportedMetrics.sffp[e]=n),r.isDebugger&&console.log("RadarSpaFmpCollect----\x3eSFFP上报成功:",n,"ms"))):console.warn("RadarSpaFmpCollect----\x3erouterBeforeachTimestamp内部打点出现问题"))},r.checkPageSwitched=function(e){r.pageSwitched||e!==r.firstRoutePath&&(r.pageSwitched=!0)},r.checkPageRendered=function(e,t){var n,e=r.pageMainElMap[e];e&&((n=document.querySelector(e))?r.domObserve(n,t):console.warn("RadarSpaFmpCollect----\x3e未找到MutationObserver元素".concat(e)))},r.domObserve=function(e,t){var n=new MutationObserver(function(e){n.disconnect(),t(e)});n.observe(e,{childList:!0,subtree:!0,characterDataOldValue:!1})},r.pageMainElMap=(null==(t=null==e?void 0:e.config)?void 0:t.pageMainElMap)||{},r.VueRouterInstance=null==e?void 0:e.router,r.isDebugger=(null==(t=null==e?void 0:e.config)?void 0:t.isDebugger)||!1,r.enableReportRpv=(null==(t=null==e?void 0:e.config)?void 0:t.enableReportRpv)||!1,r.routerBeforeachTimestamp=null,r.contentRendedTimestamp=null,r.sffpTimestamp=null,r.navCollectInstance=null==e?void 0:e.navCollect,r.firstRoutePath="",r.pageSwitched=!1,r.reportedMetrics={sfmp:{},sffp:{},fmp:{},ffp:{}},r.init(),r}return __extends(o,n),o.prototype.updateDependence=function(e){e.navCollect&&(this.navCollectInstance=null==e?void 0:e.navCollect),e.core&&this.updateCore(e.core)},o.prototype.init=function(){var r=this;try{this.VueRouterInstance&&(this.VueRouterInstance.beforeEach(function(e,t,n){try{r.metricReportInit(e.path)}finally{n()}}),this.VueRouterInstance.afterEach(function(e,t,n){n||t.path&&e.path!==t.path&&r.enableReportRpv&&r.reportRpv()}))}catch(e){console.error("RadarSpaFmpCollect----\x3e插件初始化错误",e)}},o.prototype.routeChange=function(e){this.VueRouterInstance?console.warn("RadarSpaFmpCollect----\x3e已初始化router，routeChange方法不可用"):this.metricReportInit(e)},o.prototype.reportRpv=function(e){void 0===e&&(e={}),this.baseCollect({key:o.key,dimension:{name:"radar_spa_pv",src:window.location.href,extra_info:e},value:{}}),this.isDebugger&&console.log("RadarSpaFmpCollect----\x3eRPV上报成功")},o.key=RADAR_KEY.EVENT,o}(BaseCollect),RadarVueSpa=function(){function e(t){var n=this;this.core=new w({weblogger:t.weblog,projectId:t.projectId,sampling:t.sampling||1,httpReportFirst:t.httpReportFirst,customDimensions:t.customDimensions}),this.navigationCollect=new v$2({core:this.core,mainApi:t.mainApi||[],mainJs:t.mainJs||[]}),t.unuseAPIPlugin||(this.apiCollect=new A({core:this.core,sampling:t.apiSampling,APIHook:function(e){return t.APIHook?t.APIHook(e):{}},customizeRadarStatus:t.customizeRadarStatus,ignoreList:t.ignoreList,ignoreXHR:t.ignoreXHR,ignoreFetch:t.ignoreFetch,isIgnoreInvalidStatusCode:t.isIgnoreInvalidStatusCode}),this.apiCollect.broadcastApi.on(function(e){return n.navigationCollect.dealAPI(e)})),t.unuseResourcePlugin||(this.resourceCollect=new S({sampling:t.resourceSampling,core:this.core,ignoreList:t.ignoreList,resourceHook:t.resourceHook}),this.resourceCollect.broadcastJs.on(function(e){return n.navigationCollect.addMainJSResult(e)})),this.chromeMetricsCollect=new g$1({core:this.core,options:{lcp:t.lcp,cls:t.cls,fid:t.fid,fcp:t.fcp}}),this.eventCollect=new u$1({core:this.core}),this.action=this.eventCollect.action,this.spaFMPCollector=new RadarSpaFmpCollect({core:this.core,router:t.router,config:{pageMainElMap:t.pageMainElMap||{},isDebugger:t.isSpaDebugger,enableReportRpv:t.enableReportRpv},navCollect:this.navigationCollect}),t.unuseErrorPlugin||(this.errorCollect=new h({core:this.core})),_e()}return e.prototype.apply=function(e){this.bindWeblogger(e)},e.prototype.bindWeblogger=function(e){this.weblogger=e,this.core.bindWeblogger(this.weblogger)},e.prototype.event=function(e,t){this.eventCollect.event(e,t)},e.prototype.customStage=function(e,t){this.navigationCollect.customStage(e,t)},e.prototype.setDimensions=function(e){this.core.setDimensions(e)},e.prototype.fmp=function(e){"number"==typeof e?this.spaFMPCollector.fmp(void 0,e):"object"==typeof e?this.spaFMPCollector.fmp(e.currentRoutePath,e.timestamp):this.spaFMPCollector.fmp()},e.prototype.sfmp=function(e){this.spaFMPCollector.sfmp(e.currentRoutePath,e.extendInfo,e.timestamp)},e.prototype.ffp=function(e){this.spaFMPCollector.ffp(e.currentRoutePath,e.extendInfo)},e.prototype.sffp=function(e){this.spaFMPCollector.sffp(e.currentRoutePath,e.extendInfo)},e.prototype.spa=function(e){this.spaFMPCollector.spa(e.currentRoutePath,e.extendInfo)},e.prototype.captureException=function(e){var t;this.errorCollect?null!=(t=this.errorCollect)&&t.captureException(e):console.warn("902")},e.prototype.destroy=function(){var e;null!=(e=this.navigationCollect)&&e.destroy(),null!=(e=this.apiCollect)&&e.destroy(),null!=(e=this.resourceCollect)&&e.destroy(),null!=(e=this.eventCollect)&&e.destroy(),null!=(e=this.errorCollect)&&e.destroy(),this.sfmp=this.ffp=this.sffp=this.spa=function(){s$2("903")}},e.key="radar_spa_plugin",e.version="1.2.5",e}();"undefined"!=typeof window&&"function"!=typeof window.Radar&&(window.Radar=RadarVueSpa);export{RadarVueSpa as default};
