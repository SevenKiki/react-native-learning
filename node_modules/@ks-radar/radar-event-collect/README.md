# 雷达 Event 采集器

Event 采集器为雷达官方采集器，负责进行自定义事件上报，上报数据可以在[雷达平台](https://radar-plus.corp.kuaishou.com/projects)查看。

## 前置需求

需要提前按照 @ks/weblogger @ks-radar/radar-core 两个包

## 接入教程

### 安装依赖

```bash
npm install @ks/weblogger
npm install @ks-radar/radar-core
npm install @ks-radar/radar-event-collect
```

### 初始化插件

```typescript
import { Weblog } from '@ks/weblogger';
import RadarCore from '@ks-radar/radar-core';
import RadarChromeMetricsCollect from '@ks-radar/radar-event-collect';

const weblog = new Weblog();

// 初始化core 用于采集公共数据，上报日志，需要在采集器初始化时传入，以供采集器使用
const core = new RadarCore({
    weblogger: weblog, // 传入weblogger实例
    projectId: '*****', // 传入项目id
});

const eventCollect = new RadarEventCollece({
    core,
});
```

# 配置

| 属性     | 类型      | 说明                      | 是否必传 |
| -------- | --------- | ------------------------- | -------- |
| core     | RadarCore | @ks-radar/radar-core 实例 | 是       |
| sampling | number    | 采样率                    | 否       |

# API

## event

上报自定义事件，value 中的内容是透传。

```typescript
eventCollect.event({
    name: '事件名', // 必填
    event_type: '事件类型', // 【可选】
    category: '业务分类', // 【可选】
    src: '事件相关源文件', // 【可选】
    result_type: '事件结果', // 【可选】
    message: '消息', // 【可选】
    extra_info: '额外信息（建议使用json string）' // 【可选】
}, {
    event_count: 123 //  【可选】 时间触发计数，一般用于记录当前页面下某个事件的触发次数 不涉及可不传
    duration: 123 // 【可选】时长（单位ms），可以计算分位数，不涉及可以不传
});

// 对标 ksLog.sendCountTag 的简单用法为：
eventCollect.event({
    name: '事件名', // 必填
});
```

## 关键动作

关键动作的上报需要报开始和结束两个点，调用方式如下：

-   关键动作开始：

```typescript
eventCollect.action.start({
    name: 'pay', // 关键动作名
    extra_info: {}, //【可选】需要是对象
});
```

-   关键动作结束

```typescript
eventCollect.action.end({
    name: 'pay', // 关键动作名
    extra_info: {}, //【可选】需要是对象
    result_type: '', //【可选】 事件结果
});
```
