# 雷达 Error 采集器

Error 采集器为雷达官方采集器，通过监听 weindow error 和 unhandledrejection 自动采集上报脚本异常。上报后的数据可以在[雷达平台](https://radar-plus.corp.kuaishou.com/projects)查看。

## 前置需求

需要提前按照 @ks/weblogger @ks-radar/radar-core 两个包

## 接入教程

### 安装依赖

```bash
npm install @ks/weblogger
npm install @ks-radar/radar-core
npm install @ks-radar/radar-error-collect
```

### 初始化插件

```typescript
import { Weblog } from '@ks/weblogger';
import RadarCore from '@ks-radar/radar-core';
import RadarErrorCollect from '@ks-radar/radar-error-collect';

const weblog = new Weblog();

// 初始化core 用于采集公共数据，上报日志，需要在采集器初始化时传入，以供采集器使用
const core = new RadarCore({
    weblogger: weblog, // 传入weblogger实例
    projectId: '*****', // 传入项目id
});

const errorCollect = new RadarErrorCollect({
    core,
});
```

# 配置

| 属性     | 类型      | 说明                      | 是否必传 |
| -------- | --------- | ------------------------- | -------- |
| core     | RadarCore | @ks-radar/radar-core 实例 | 是       |
| sampling | number    | 采样率                    | 否       |

# API

## captureException

用于主动记录某个错误，并在雷达后台中跟踪它们。

```typescript
/*
* @param error  错误信息，最好是传入一个 Error 对象，因为这可以让我们记录下该错误发生的地点以及其它有用的信息。
*/
captureException(error: Error): void {

}
```

使用场景：

场景 一： 对于使用 try...catch... 捕获的错误，若想要记录并跟踪它们，则可以使用该方法

```typescript
try {
    doSomething();
} catch (error) {
    errorCollect.captureException(error);
}
```

场景 二：用于记录 Vue 组件中的未捕获异常

```typescript
Vue.config.errorHandler = function (error) {
    errorCollect.captureException(error);
};
```
