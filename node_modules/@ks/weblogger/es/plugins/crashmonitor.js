var t=function(o,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)Object.prototype.hasOwnProperty.call(o,e)&&(t[e]=o[e])})(o,e)};var o=function(){return(o=Object.assign||function(t){for(var o,e=1,n=arguments.length;e<n;e++)for(var r in o=arguments[e])Object.prototype.hasOwnProperty.call(o,r)&&(t[r]=o[r]);return t}).apply(this,arguments)},e=function(){function t(){}return t.prototype.apply=function(t){this.weblog=t},t}();var n={updateInterval:2e4,crashThreshold:1e4},r=function(e){function r(t){var r,i,a,s,c=e.call(this)||this;return c.eventName="onpagehide"in window?"pagehide":"beforeunload",c.options=o({},n),c.historyMoniorInfo=null,c.stop=function(){clearInterval(c.updateIntervalId);try{localStorage.removeItem(c.monitorId)}catch(t){}},(null==t?void 0:t.collect)&&c.apply(t),r=window,i=c.eventName,a=c.stop,"attachEvent"in r?r.attachEvent("on"+i,a):r.addEventListener(i,a,s),c}return function(o,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=o}t(o,e),o.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(r,e),r.prototype.apply=function(t){t&&(this.weblog=t,this.monitorId="@ks.monitor.crash_"+this.weblog.sessionId,this.start())},r.prototype.destroy=function(){var t,o,e,n;this.stop(),t=window,o=this.eventName,e=this.stop,"attachEvent"in t?t.detachEvent("on"+o,e):t.removeEventListener(o,e,n)},r.prototype.pickHistoryInfo=function(){for(var t in localStorage)if(0===t.indexOf("@ks.monitor.crash_"))try{var o=localStorage.getItem(t),e=JSON.parse(o);this.checkHistoryCrash(e)}catch(t){}},r.prototype.checkHistoryCrash=function(t){var o=(new Date).valueOf();t&&t.time&&o-t.time>this.options.crashThreshold&&this.weblog.collect("CUSTOM",{key:"crash",value:t})},r.prototype.start=function(){var t=this;this.pickHistoryInfo(),this.updateIntervalId=window.setInterval((function(){t.update()}),this.options.updateInterval),this.update()},r.prototype.update=function(){var t,o;if(window.performance&&window.performance.memory){var e={time:(new Date).valueOf(),memory:{limit:Math.floor(window.performance.memory.jsHeapSizeLimit/1024),total:Math.floor(window.performance.memory.totalJSHeapSize/1024),used:Math.floor(window.performance.memory.usedJSHeapSize/1024)},href:null===(t=null===window||void 0===window?void 0:window.location)||void 0===t?void 0:t.href,sessionId:null===(o=this.weblog)||void 0===o?void 0:o.sessionId};try{localStorage.setItem(this.monitorId,JSON.stringify(e))}catch(t){}}},r.key="crachMonitor",r}(e);export{r as default};
//# sourceMappingURL=crashmonitor.js.map
