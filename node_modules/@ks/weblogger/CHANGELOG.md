# 变更记录
## 3.10.23(20230621)
- Radar: [fix]修复Object.values在低端机上不兼容的问题
- Radar: [refactor]优化 console 代码，增加雷达错误码说明文档

## 3.10.22(20230517)
- node: [fix] 切换 node 上报链路为公司内部域名，支持容器云上报 
- node: [fix] 修复 mjs ts 引入 https 模块的问题


## 3.10.20(20230509)
- Radar: [feat]新增子应用、灰度监控公共维度
- Radar: [fix]修复 ssl、ssl_start 不存在时上报为 0 的问题
- Radar: [feat]`fmp` 和 `h5_load` 时机上报 fcp、lcp、cls、fid
- Radar: [refactor]资源加载失败时判断是否为空地址的逻辑优化

## 3.10.19(20230424)
- Radar: [feat]雷达种子包第一版
- Radar: [fix]解决spa合集包页面切换fmp上报问题
- Radar: [feat]添加判断是否发生在fmp期间的维度
- Radar: [fix]component采集器event方法duration参数校验问题修复
- Radar: [feat]sendTimeline=false时自定义指标限制放宽为6条

## 3.10.18(20230410)
- kds 平台埋点上报支持
- node 支持 mjs 类型文件

## 3.10.17(20230323)
- 桥接事件页面参数优化


## 3.10.16(20230302)
- Radar: [feat]导出 Radar 传入配置的类型
- Radar: [feat]对@yoda/bridge 抛出的 BridgeError 错误，采集更多信息
- Radar: [feat]krn 从 props 获取 scheme 并上报
- Radar: [fix]修复打包声明文件缺失的问题
- Radar: [feat]合集包 key 更改，兼容 weblog.radar.xxx
- Radar: [feat]雷达使用教程更新到独立包使用
- Radar: [refactor]调整打包方式优化体积
- Radar: [refactor]API、资源判断是否跨域无法获取部分数据
- Radar: [feat]资源上报缓存状态，判断是否命中 cdn 缓存
- Radar: [fix]core 默认采样率为 1,修复 core 不传入采样率抛出错误的问题
- Radar: [fix]更新 core 的依赖,修复 krn 合集包 wei 引入 radar-core-krn，导致 ts 类型报错
- Radar: [fix]修复数据校验异采样率上报异常,保证资源日志上报的 file 为字符串类型
- Radar: [fix]修复 APIHook 在某些情况下 response.headers 为空导致雷达 SDK 报错的问题

## 3.10.15（20230301）

- krn 桥接上报自定义事件添加页面属性

## 3.10.14（20230207）

- browser 以及 hybrid 包 ts 优化，避免 yoda ts 依赖引用。
- bridge 以及 hybrid 支持 urlPage

## 3.10.13（20221221）

- Radar 插件更新:
    - [feat] 上报接口拦截状态
    - [fix] 兼容处理端内无法获取采样率

## 3.10.12 （20221214）

- hybrid 包端外兼容 autopv 第一个 pv 埋点发送

## 3.10.11 （20221212）

- krn 任务事件类型透传支持

## 3.10.10 （20221129）

- Radar 插件更新:
    - [feat] 配合yoda设备采样，在dimension中上报did_rate用于采样还原(yoda 10.10.40 以上版本生效)
    - [feat] 初始化时设置 isIgnoreInvalidStatusCode，支持异步拦截日志上报
    - [fix] 修复msg为空字符串时无法上报异常数据

## 3.10.9 （20221115）

- typescript 兼容修改

## 3.10.8 （20221111）

- 小程序页面信息兜底

## 3.10.7 （20221108）

- krn urlpage 页面id 优化
- Radar 插件更新:
    - [fix] 修复资源上报默认采集率不生效

## 3.10.6（20221025）

- sendBeacon 发送优化

## 3.10.5（20221025）

- AutoTrack 插件更新:
    - [feature] 支持 followCurPage 参数，决定页面标识是否跟随当前页面page上报，默认取当前 url

## 3.10.4（20221019）

- lite 包更新雷达发送方式以及分流字段

## 3.10.3（20220927）

- Radar 插件更新:
    - [feature] 支持 window 下访问 Radar 构造函数
    - [fix] 去掉 basePlugin 的使用和相关资源引入

## 3.10.2（20220926）

- Radar 插件更新:
    - [feature] 支持解析 API 请求头的 traceId 信息并上报
    - [fix] 修复 fetch 使用 form 请求上传文件报错
    - [fix] 修复上报自定义性能配置时间戳后不默认开启汇总上报的问题
    - [fix] 修复action方法为undefined的问题
    

## 3.10.1（20220916）

- 1.【重要】支持半屏页面桥事件 closeClosePage 调用
- 2.【重要】KRN pv 事件支持 status 以及 timeCost 字段透传
- 2.【重要】浏览器端支持判断来源 iframe 页面字段

## 3.10.0（20220902）

- 1.【重要】更新 yoda sdk 版本依赖，由原来的 @ks/yoda-js-sdk 改为 @@yoda/bridge^2.0.0；
- 2.【重要】优化 typescript 声明，通过 ts 提示规范 Weblog 实例化参数和接口调用参数；
- 3.【重要】根据不同上报方式引用的 js 包提示不同的传参配置；
- 4.新增 lib/types/types 接口和参数类型文件；
- 5.log.browser 版本 yoda 配置调整为传 invoke 函数或包含 invoke 方法的对象；
- 6.端内采样逻辑调整，不再单独由 KSwitch 控制；
- 7.package.json 添加 exports map，import 使用 es 模式；
- 8.Radar 插件更新:
    - [feature]去除老链路上报逻辑
    - Radar: [feature]增加server-timing采集
    - Radar: [feature]增加resourceHook能力，可选择当前资源日志是否上报

## 3.9.56（20221025）
- 
- sendBeacon 发送优化

## 3.9.55（20220901）

- riskMgt 风控插件更新：
    1.logid拆分，仅包含核心字段，提高的上报率
    2.添加监控和统计
    3.风控检测字段升级
    4.行为埋点统计
- 压缩 script 注入，加入 crossOrigin 属性

## 3.9.54（20220825）

- 修复 DataUrl iframe 场景下 sessionStorage 报错问题
- package.json exports 补充 log.lite

## 3.9.53（20220817）

- 移除 RN CUSTOM_EVENT 事件版本号兼容判断（主站已全量支持）
- RN console.error 改为 console.log
- 优化 package.json，添加 exports map 优先使用 esm 包，添加 peerDependenciesMeta 避免 npm 安装异常
- 支持服务端返回采样字段
- krn urlPage 透传
- 
## 3.9.52 (20220713)

- 小程序获取 SystemInfo 报错问题修复
- log.lite.d.ts 声明文件补全

## 3.9.51 (20220606)

- KRN bridge 上报 PV 事件支持 feedLogCtx 信息上报
- 修复 H5 log.bridge.js yoda 引用报错问题
- 支持小程序版本上报地理位置信息（location_package）

## 3.9.50 (20220505)

- 修复支付宝小程序 Storage 操作兼容问题
- 在 h5_extra_attr 中补充小程序屏幕尺寸、小程序客户端版本号等信息

## 3.9.49 (20220427)

- Radar: [fix]修复 api 上报缺少 host 的问题，修复了 api 补全规则
- Radar: [fix] fetch 的 clone 增加 content-type 的过滤,修复内存泄漏问题
- Radar: [fix]修改调用 weblogger 上报的方式,优先使用 sendByHttp，修复 httpReportFirst 在 hybrid.js 中失效的问题
- Radar: [feature]增加初始化雷达时设置自定义维度功能
- Radar: [feature] api 上报增加 content-type 的上报
- Radar: [feature] apihook 中 request 增加 _config，代表请求参数
- Radar: [feature] apihook 增加 broadcast_info，在 get-radar-next-data 事件中透出
- 优化 node js 版本埋点上报逻辑
- http v2 上报 CLICK 和 TASK 事件优化，统一事件逻辑
- 优化小程序 PV 发送逻辑，与 H5 一致

## 3.9.48（20220419）

- 风控插件（riskMgt）增加容错能力
- 移除无用的 peerDependencies 包

## 3.9.47（20220407）

- 小程序兼容支持，支持微信小程序、快手小程序、支付宝小程序
- 风控插件（riskMgt）更新：
  - 1.丰富设备指纹特征
  - 2.增强风险探测能力
- 修复桥接模式下 updateCurrentUrlPackage 方法在未发送 enter PV 时触发 PV 的问题
- 增加 es 格式打包，文件目录为 `@ks/weblogger/es/`

## 3.9.46（20220302）

- 桥接上报元素事件支持不携带页面信息
- log.bridge 版本支持 attachUrl 设置
- fps 插件优化：页面 hidden 状态暂停上报

## 3.9.45（20220223）

- Radar: 修复fetch hook中内存泄漏问题

## 3.9.44(20220222)

- 确保部分字段为正整数，保证埋点成功入库
- 修改 log 逻辑，保证 log 代码不被 terser 插件删除

## 3.9.43(20220211)

- Radar: 修复xhrHook在百度浏览器的兼容性
- Radar: h5_extra_attr中增加downlink和rtt
- Radar: 修复fetch clone在ios11上的问题

## 3.9.42(20220120)

- updateCurrentUrlPackage 方法处理 page 为空情况
- RN 桥接上报支持上报 type: 'visible' 类型 PV
- autoTrack 插件 page 值变为 pathname

## 3.9.41(20220106)

- yoda.tool.sendSummarizedLog 方法主动注册监听
- autoPV 复写 history 方法时机调整

## 3.9.40(20220106)

- 修复 hybrid 包 autopv 插件 发送第一个 pv 事件被拦截问题

## 3.9.39(20220104)

- 修复 console.log.call 在低版本安卓中报错的问题

## 3.9.38(20211228)

- Radar: 调整新链路上报时重置URLPackage的时机
- Radar: 修复fetch hook中关于video的问题
- Radar: 增加不上报老雷达配置逻辑
- Radar: api/resource上报增加字段
- Radar: 汇总上报增加main_api逻辑
- Radar: 汇总上报增加一些dom信息上报
- Radar: value中上报的字段从number类型换成string类型

## 3.9.37(20211227)

- 增加 customStatToCustom 配置字段，支持桥上报自动将 custom_stat_event 转换为 custom_event
- 增加 enableV3CustomEvent 配置字段，将所有 custom 日志上报到 V3
- 将异步判断 yoda 是否就绪的逻辑转为使用队列缓存 yoda 就绪前上报的埋点，去掉异步过程

## 3.9.36(20211223)

- autoTrack插件兼容没有getBoundingClientRect的元素

## 3.9.35(20211215)

- 增加禁止压缩配置项，避免某些情况确实无法使用压缩导致用户报错

## 3.9.33(20211214)

- iOS 审核移除 webchat、baidu 等敏感词汇
- 小程序兼容新雷达插件ks-radar-mini-program
- 小程序错误事件上报格式bug修复，去除插件内部错误监控代码，交给雷达实现功能

## 3.9.32(20211206)

- 修复 http v2 埋点抓包查找问题

## 3.9.31(20211203)

- error上报信息修改
- xhrHook bug修复

## 3.9.28(20211125)

- 添加统一的命名空间管理多类和多实例
- 添加全局静默函数  
- 为 krn sdk 新增兼容性配置：新增referUrl、增加对老上报接口格式的兼容
- 优化 weblogger 多实例，压缩互相影响的问题

## 3.9.21(20211029)

- RN 桥接上报 status 设置不生效问题修复
- Radar新版本sdk发布，具体改动参见[改动](https://docs.corp.kuaishou.com/d/home/fcADdW-56zfC7lPbP3qArOW2P#)
- 修改yoda对象获取方式
- 修改radar service_name上报方式
- 修改weblogger对radar的采样控制

## 3.9.20(20211021)

- Radar 插件更新
- log.lite node 环境报错修复

## 3.9.19(20211013)

- 支持桥接事件设置 stid 参数
- 支持 KRN 上报自定义事件

## 3.9.18(20211009)

- 自定义事件支持设置 biz 信息
- 控制台异常信息输出

## 3.9.17(20210926)

- 添加 disablePV 配置，用于在部分端内桥接场景不上报 PV，继承客户端页面信息
- 优化桥接 PV 上报逻辑

## 3.9.16(20210923)

- 控制台日志输出优化
- 纯桥接上报兼容 updateCommonPackage 接口
- 小程序 SDK session_id 逻辑优化

## 3.9.15(20210914)

- log.core 支持非 node 环境
- 添加 `attachUrl: boolean` 配置，开启后默认附加页面原始 url 信息
- radar 修复 CustomEvent 兼容报错问题
- radar: 增加采样率上报

## 3.9.14(20210910)

- 修复 HTTP v2 上报日志不落库问题
- riskMgt插件 使用 webworker 修复上报率

## 3.9.13(20210907)

- 雷达插件添加对关键动作上报的支持
- 移除控制台 log

## 3.9.12(20210907)

- http v2 上报测试接口问题修复

## 3.9.10(20210901)

- radar: 增加fcp数据采集
- radar: xhrhook单例处理

## 3.9.9(20210830)

- 支持 log.hybrid 设置 disableBridge 禁用桥接上报

```javascript
import { Weblog } from '@ks/weblogger/lib/log.hybrid';
const weblog = new Weblog({
    disableBridge: true, // 默认为 false
});
```

- 支持本地调试时禁止 http 上报请求

```javascript
// 打开浏览器控制台，输入
Weblog.silence(1); // 停止请求
Weblog.silence(0); // 回复正常
```

## 3.9.7(20210825)

- 优化 sendImmediately 方法，提高埋点上报性能
- 点击事件支持设置染色参数信息

## 3.9.6(20210818)

- 移除 ua-parser-js 依赖
- 增加 env: 'oversea' 海外线上环境

## 3.9.5(20210816)

- H5_extra_attr 新增设备屏幕信息
- 新增 log.lite 包支持项目内组件日志上报

## 3.9.4(20210809)

- 雷达插件 flushNext 函数报错处理

## 3.9.3(20210809)

- 雷达插件上报信息格式优化

## 3.9.2(20210805)

- yoda 接口容错处理

## 3.9.0(20210802)

- 多平台支持：支持 krn、kds、小程序、node
- 新增端内 H5 纯桥接版本，大大减小包体积
- 添加开发环境异常日志输出
- 上报接口添加 kpn 信息，服务端可以通过接口统计单独业务 QPS 和异常

----------------

## 3.8.33(20210809)

- misc2 和 radar 接口上报格式改为 text/plain，并添加 query
- 支持 `env: 'oversea'` 设置海外线上环境
- radar 插件 api模块添加业务hook api的能力

## 3.8.32(20210809)

- 风控插件开关增加同异步逻辑功能
https://docs.corp.kuaishou.com/d/home/fcABi58lWsOTAqqr_meOVfMwV

## 3.8.31(20210802)

- 类型声明问题修复

## 3.8.30(20210802)

- radar 插件 xhr hook 请求拦截模块复写

## 3.8.29(20210722)

- 接口参数兜底处理
- radar: 增加对undefined指标的兼容处理
- radar: yoda内获取webview数据时做单例处理，并加入 失败后有限次重复获取 逻辑

## 3.8.28(20210709)

- 修复 crashMonitor 插件报错问题

## 3.8.27(20210628)

- 修复 send 异步导致 autoPV leave 事件 page 信息错误问题。
- 更新 autoShow 插件，支持立即上报配置
- 风控插件新增数据采集能力，见文档：https://docs.corp.kuaishou.com/d/home/fcADfmVjDzPB-ZdSy4MAtc6vs#

## 3.8.25(20210623)

- 移除桥接低版本兼容处理
- 更新 autoShow 插件，修复兼容报错问题

## 3.8.24(20210617)

- PV 事件默认添加默认 enter 处理
- peerDependence 规范处理

## 3.8.23(20210609)

- 支持端内 H5 添加染色参数（entry_tag）
- autoPV: PV 上报由 collect 改为 sendImmediately
- radar: 修复在上报「未处理 Promise 错误」时，没有包含错误堆栈信息的问题
- radar: 提供 captureException 方法，用于主动上报错误

## 3.8.22(20210526)

- 风控sdk支持海外

## 3.8.21(20210526)

- 修复 Radar className 处理报错问题
- 关闭 fps/crash/timing 插件加载问题

## 3.8.20(20210526)

- 修复 polyfill 与业务冲突报错问题
- 添加 page 规范提示

## 3.8.18(20210426)

- riskMgt风控插件接入native上报&动态选择接口上报&上报数据sha1加密

## 3.8.17(20210419)

- 修复 xhook 改写 FormData 导致 sendBeacon 发送数据格式不对问题
- 修复 Radar 插件语法兼容问题
- 更新 autoShow 插件

## v3.8.16(20210409)

- 添加测试接口上报安全域名限制
- 更新雷达插件

## v3.8.15(20210331)

- 修复 device_id 默认值处理问题

## v3.8.14(20210330)

- 修复 commonPackage 参数默认类型判断报错问题
- 修复 autoPVFilter 兼容问题
- 修复 v2 上报 show_event 类型设置问题
- 新增 v2 上报 video_stat_event 事件


## v3.8.13(20210326)

- 修复 lib 下文件 types 路径问题
- 修复 v2 上报更新 commonPackage 问题

## v3.8.12(20210313)

- 雷达插件恢复 lcp 上报至 load
- 雷达插件新增配置优先通过 http 上报数据

## v3.8.11(20210305)

- 修复雷达插件 created 时机 防止 weblogger 先调用 created 方法导致无法触发插件的 created 事件
- 修复 script 脚本异步加载插件 radar 方法调用失败问题

## v3.8.10(20210301)

- 修复旧式引用插件重复 apply 导致事件多报问题

## v3.8.9(20210224)
- 添加类型声明
- 全埋点插件新增点击图和触达率图消费功能
## v3.8.8(20210219)
- 修复雷达插件composedPath函数className兜底处理

## v3.8.7(20210209)
- 修复部分 SSR 环境报错问题

## v3.8.6(20210207)
- 修改 HTTP 上报页面停留时长逻辑：在浏览器 Tab 切换时会上报停留时长
- 修复桥接上报页面参数未正常设置的问题

## v3.8.5(20210204)
- 端内 HTTP 上报通过 yoda 接口可以矫正设备和应用信息

## v3.8.4(20210203)
- radar 插件更新

## v3.8.3(20210202)
- radar 插件更新

## v3.8.1(20210129)
- radar 插件更新

## v3.8.0(20210129)
- 支持 http 上报埋点到 v2 库
- 支持插件按需加载
- 优化 script 引用
- 优化埋点丢失问题
- 修复 updateCurrentUrlPackage 会影响 refer 信息问题
- 新增 updateReferUrlPackage 接口，方便更新 refer 信息
- 新增全埋点插件
- 移除 ksBridge，全量使用 yodaBridge 接口
- 雷达 http 上报到单独接口
- 端内雷达优先使用桥接上报接口上报
- 雷达上报信息补充
## v3.7.31(20201229)

- 修复桥接上报 contentPackage 格式问题
 ## v3.7.30(20201228)
 - 修复在浏览器隐私模式下 iframe 跨域访问本地存储报错问题
## v3.7.29(20201223)
 - 修复 package.json types 误删问题

## v3.7.28(20201222)
 - 修复雷达报错问题

## v3.7.27(20201222)

- 端内环境雷达优先使用桥接上报
## v3.7.26(20201209)

- 添加埋点测试激活接口
## v3.7.23(20201130)

- 新增对线上 H5 页面埋点测试的功能

## v3.7.22(20201119)

- 修复 autoPV 窗口关闭前未上报 leave 事件问题

## v3.7.21(20201116)

- 雷达插件更新

## v3.7.20(20201105)

- 雷达插件更新

## 3.7.19 (20201104)

- 雷达插件更新

## 3.7.18 (20201102)

- 自定义事件添加 refer_url_package 信息

## 3.7.17 (202009027)

- SSR 兼容问题，logger 上报改为由 https 改为 http

## 3.7.16 (202009024)

- 修复桥接环境兼容问题

## 3.7.15 (202009022)

- 优化自增 id 方案，自定义事件和常规事件自增 id 分开统计

## 3.7.14 (202009021)

- 修复雷达插件 - 新增 channel 上报，dom_num 报 load

## 3.7.13 (202009019)

- 修复 SSR 环境支持问题，并添加发版前 SSR 环境兼容测试

## 3.7.12 (202009018)

- 修复雷达插件 - 修复 lcp 上报问题

## 3.7.11 (202009014)

- 新增 updateCommonPackage 方法，支持多次修改 common_package 字段

## 3.7.10 (20200907)

- 支持初始化时设置 platform

## 3.7.9 (20200904)

- 修复 common_package 字段缺失问题

## 3.7.8 (20200831)

- bridge 上报时携带时间戳

## 3.7.7 (20200831)

- 修复 log 时间戳和自增 id 顺序不一致问题
- 新增 bridge 相关信息

## 3.7.6 (20200831)

- 修复雷达插件 - 新增 LCP、FID、CLS 指标上报

## 3.7.5 (20200829)

- 修复雷达插件 - fetch 请求上报优化

## 3.7.4 (20200828)

- 修复雷达插件 - 支持 fetch 请求数据上报

## 3.7.3 (20200828)

- 修复雷达插件 - 兼容 ie 浏览器不支持 event.composedPath 的 bug

## 3.7.2 (20200827)

- 添加 yoda-js-sdk 和 ks-bridge 依赖版本校验提示
- bridge 上报模式同样携带 domin 信息

## 3.7.0 (20200825)

- log 信息携带自增 id
- 支持 bridge 上报的同时进行 http 上报
- 支持自定义 http 上报模式

## 3.6.20 (20200824)

- 修复 radar 代码报错问题，新增 urlMap 接受传入方法类型

## 3.6.19 (20200810)

- 修复 visibilityChange 没有经过 autoPVFilter 校验问题

## 3.6.18 (20200804)

- 快手极速版使用ksbridge上报数据

## 3.6.15 (20200730)

- 新增快手极速版ua检测

## 3.6.14 (20200722)

- 修复currentUrlPackage赋值错误问题

## 3.6.2 (20200618)

- urlMap 匹配规则修改

## 3.6.1 (20200618)

- logger 平台链接改成 https://

## 3.6.0 (20200618)

- 增加 URL 映射(urlMap) 的支持

## 3.5.7 (20200602)

- 删除多余 console.log

## 3.5.6 (20200527)

- oppo findIndex pollyfill 报错修复

## 3.5.5 (20200526)

- 增加端内 UA：ZIKZAK

## 3.5.3 (20200522)

- sendImmediately、collect ts 类型修正

## 3.5.2 (20200519)

- 实例上增加 version 字段用于标识 weblogger 版本

## 3.5.1 (20200519)

- 修复超过 max-length 时候的 logQueue 最后一条 log 丢失问题

## 3.5.0 (20200519)

- 梳理文档
- 扩展传参方式，推荐使用新的传参方式，老的传参方式移入 api-deprecated 过时 API，本质上没有太大变化，只是扩展性好一点
- 对所有事件支持 eventId 设置

## 3.2.24 (20200401)

- 添加海外 UA 用于判断在 APP 内，isApp，并且要求不区分大小写

## 3.2.23 (20200310)

- 增加 logger baseConfig，用于控制和 logger 平台打通

## 3.2.19 (20200108)

- 增加采样配置 sampleRate & sampleRateFn

## 3.2.18 (20191217)

- 同步 xhr 逻辑修改，尝试发送同步 xhr，如果失败，尝试使用 sendBeacon 发送

## 3.2.13 (20191128)

- logOptions 支持 showValidateMsg 控制是否显示校验的 warning log

## 3.2.10 (20191127)

- 可配置发送 url

## 3.2.9 (20191122)

- native setCurrentPage leave 导致 page2 混乱的问题

## 3.2.8 (20191121)

- collect & sendImmediately 支持传 SendOptions object 类型的第一个参数，可以通过 async 参数控制同步/异步

## 3.2.7 (20191121)

- PV 发送支持 page、params 参数，完善文档

## 3.2.6 (20191121)

- 修复极速版ua大小写问题……

## 3.2.5 (20191114)

- 解决 ts 项目引入 bridge 版本的时候类型错误问题

## 3.2.3 (20191113)

- 请求域名增加 protocol，解决端内请求上报出错问题

## 3.2.2 (20191112)

- 更换测试接口域名

## 3.2.0 (20191108)

- 通过 @ks/ks-bridge & @ks/yoda-js-sdk 发送 sendClientLog 支持 native 打通

## 3.1.1 (20191028)

- autoPVFilter 在 constructor 即调用

## 3.1.0 (20191028)

- weblog.plugins.timingMonitor.mark 支持额外参数，endPoint 时间

## 3.0.1-beta1 (20190927)

- showEvent 和 taskEvent 上报添加 contentPackage 参数

## 3.0.0-beta8 (20190904)

- 页面唯一标示 identity，每次上报随机生成

## 3.0.0-beta7 (20190720)

- 初始化 logger 的时候增加 referer，用于手动标记初始来源

## 3.0.0-beta6 (20190718)

- 修复 performance 对低版本的兼容

## 3.0.0-beta5 (20190717)

- version_code 改为 sdk 自己获取
- 修复 performance.timing 在低版本上引起的问题
- timingMonitor，fpsMonitor，crachMonitor 上报字段增加 url_package 字段，用于辅助查询

## 3.0.0-beta4 (20190710)

- 修复获取 currentUrl 以及 refererUrl 时的异常

## 3.0.0-beta3 (20190710)

- 修改TS类型，补充手动PV上报文档缺失部分

## 3.0.0-beta2 (20190709)

- SSR 模式兼容
- 自动 PV 增加 customUrlFilter 控制自动 PV 逻辑
- 由于 Chrome 78 以后版本默认关闭同步 xhr，所以默认在 Chrome78 以后版本自动使用 sendBeacon 上报（已测试，暂无问题）
- 增加 builtin 插件配置开关

## 3.0.0-beta1(breaking change) (20190706)

- 日志格式与客户端PB同步
- 自动PV，停留时长收集
- fps，crash，timing插件内置化
- 插件机制变更

## 2.0.10 (20190513)

- 增加updateBase，用于SPA更新基础信息操作

## 2.0.9 (20190412)

- module下也同样引入polyfill，兼容老Android= =

## 2.0.8 (20190411)

- 修复unplugAll逻辑

## 2.0.7 (20190409)

- common与module模式均打包为es5

## 2.0.6 (20190322)

- 更改已有did情况下cookie的过期时间
- 移除获取script标签config设置及相应处理
- 默认关闭lazy模式

## 2.0.5 (20190322)

- 更改did过期时间(法务要求)，更改normal包为umd打包模式

## 2.0.4 (20190321)

- 修复类型，传参拼写bug，debug模式依赖window的问题

## 2.0.3 (20190319)

- 修复esm包导出问题

## 2.0.2 (20190318)

- 修复因method导致的发送日志失败问题

## 2.0.1 (20190305)

- base字段新增network信息上报

## 2.0.0-beta3 (20190130)

- 移除runtime对es6方法的依赖

## 2.0.0-beta2 (20190128)

- 在不支持performance api时的降级处理

## 2.0.0-beta1 (20181229)

- 迁移代码部分到ts
- 增加crash monitor插件
- 增加fps monitor插件
- 增加time monitor插件

## 1.4.9 (20181219)

- 修改inViewPort方法 向上查找至根结点判断是否显示在视口内
- 优化debounce方法 使用requestAnimationFrame

## 1.4.8 (20181210)

- 修改时间戳取值为new Date().getTime() 放弃使用Date.now()
- 修改inViewPort方法 添加display、visibility和opacity属性以及宽高的判断

## 1.4.7 (20181122)

- 修复页面卸载不上报问题： handler添加this绑定

## 1.4.6 (20181122)

- 处理ie11下readyState Property被移除的容错

## 1.4.5 (20181121)

- util添加获取当前script方法 getCurrentScript
- 动态设置上报: 根据sdk script标签dom中 config配置动态设置上报 prod/preonline环境时发送上报请求，beta和dev环境控制台console打印上报数据
- 去除公参 client_id字段
- 添加实例方法 destroy, 解绑所有插件和dom事件
- 修改log_time取值方式为new Date()

## 1.4.4 (20181116)

- 事件对齐app端，事件名统一使用toUpperCase()转为大写

## 1.4.3 (20181113)

- 修复weblog 上报mtimeout设置为500ms导致部分cancel情况出现的问题，设置timeout 为默认的30000ms

## 1.4.3 (20181109)

- 固定上报的 request Content-type
    * `ajax: text/plain`
    * `form: application/x-www-form-urlencoded`
- 上报base中refer_show_id动态显示当前sdk版本号
