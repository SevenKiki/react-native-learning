!function(t,o){"object"==typeof exports&&"undefined"!=typeof module?module.exports=o():"function"==typeof define&&define.amd?define(o):(t="undefined"!=typeof globalThis?globalThis:t||self).FPSMonitor=o()}(this,(function(){"use strict";var t=function(o,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i])})(o,i)};var o=function(){return(o=Object.assign||function(t){for(var o,i=1,n=arguments.length;i<n;i++)for(var e in o=arguments[i])Object.prototype.hasOwnProperty.call(o,e)&&(t[e]=o[e]);return t}).apply(this,arguments)},i=function(){function t(){}return t.prototype.apply=function(t){this.weblog=t},t}();var n={interval:1e4,decimals:2};function e(t){return setTimeout(t,62.5)}var r=clearTimeout;return function(i){function s(t,e){var r=i.call(this)||this;return r.options=o({},n),r.count=0,r.visibilityChange=function(){var t=document.visibilityState;"visible"===t?r.start():"hidden"===t&&r.stop()},e||t&&(null==t?void 0:t.collect)&&r.apply(t),Object.assign(r.options,e),function(t,o,i,n){"attachEvent"in t?t.attachEvent("on"+o,i):t.addEventListener(o,i,n)}(window,"visibilitychange",r.visibilityChange),r.start(),r}return function(o,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=o}t(o,i),o.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}(s,i),s.prototype.destroy=function(){var t,o,i,n;this.stop(),t=window,o="visibilitychange",i=this.visibilityChange,"attachEvent"in t?t.detachEvent("on"+o,i):t.removeEventListener(o,i,n)},s.prototype.start=function(){this.loopId||this.fpsTickId||(this.loop(),this.fpsTick())},s.prototype.fpsTick=function(){var t=this;this.fpsTickId=function(t){return(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||e).call(this,t)}((function(){t.count++,t.fpsTick()}))},s.prototype.loop=function(){var t=this;this.loopBeginTime=(new Date).valueOf(),this.loopId=window.setTimeout((function(){t.loopEndTime=(new Date).valueOf();var o=t.calculate();t.weblog.collect("CUSTOM",{key:"fps",value:{key:"fps",value:o}}),t.count=0,t.loop()}),this.options.interval)},s.prototype.stop=function(){!function(t){(window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||r).call(this,t)}(this.fpsTickId),window.clearTimeout(this.loopId),this.loopId=0,this.fpsTickId=0},s.prototype.calculate=function(){return+(1e3/((this.loopEndTime-this.loopBeginTime)/this.count)).toFixed(this.options.decimals)},s.key="fpsMonitor",s}(i)}));
