{"version":3,"file":"log.bridge.js","sources":["../node_modules/tslib/tslib.es6.js","../src/util/cookie.ts","../src/util/console.ts","../src/util/index.ts","../src/util/increment-id.ts","../src/util/history-polyfill.ts","../src/util/ua.ts","../src/util/yodav2.ts","../src/io/util.ts","../src/io/xhr.ts","../src/platform/browser/url-package.ts","../src/platform/hybrid/bridge.ts","../src/util/uuid.ts","../src/core/url-package.ts","../src/platform/hybrid/log.ts","../src/plugins/base.ts","../src/entries/bridge.ts"],"sourcesContent":["/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n","\n// TODO后面这里面的东西要拆一下，不能全一口气扔在util下面\ninterface CookieOptions {\n    expires?: Date;\n    path?: string;\n    domain?: string;\n    secure?: boolean;\n    raw?: boolean;\n}\n\n/**\n * 创建一个cookie字符串，可被赋值给document.cookie.\n * @param {string} name cookie名称.\n * @param {string} value cookie值.\n * @param {boolean} encode 是否对值进行编码.\n * @param {Object} options (Optional) 配置项.\n * @return {string} 返回 cookie 字符串.\n */\nfunction createCookieString(\n    name: string,\n    value: string,\n    encode: boolean,\n    options: CookieOptions = {},\n) {\n    let text = `${encodeURIComponent(name)}=${(encode ? encodeURIComponent(value) : value)}`;\n    const expires = options.expires;\n    const path = options.path || '/';\n    const domain = options.domain || '';\n\n    if (expires instanceof Date) {\n        text += `; expires=${expires.toUTCString()}`;\n    }\n\n    if (typeof expires === 'number') {\n        text += `; max-age==${expires}`;\n    }\n\n    if (path !== '') {\n        text += `; path=${path}`;\n    }\n\n    if (domain !== '') {\n        text += `; domain=${domain}`;\n    }\n\n    if (options.secure === true) {\n        text += '; secure';\n    }\n\n    return text;\n}\n\n/**\n * 将cookie序列化成对象.\n * @param {string} text cookie值.\n * @param {boolean=} shouldDecode cookie是否需要被解码. 默认为true.\n * @param {object=} options 如何读取cookie的配置.\n * @return {object} 可访问cookie的序列化结果\n */\nexport function parseCookieString(\n    text: string,\n    shouldDecode: boolean,\n    options: any = {},\n) {\n    const cookies: { [key: string]: any } = {};\n\n    if (text.length > 0) {\n        const decodeValue = !shouldDecode\n            ? function (s: string) {\n                return s;\n            }\n            : decodeURIComponent;\n        const cookieParts = text.split(/;\\s/g);\n        let cookieName = null;\n        let cookieValue = null;\n        let cookieNameValue = null;\n\n        for (let i = 0, len = cookieParts.length; i < len; i++) {\n            cookieNameValue = cookieParts[i]?.match(/([^=]+)=/i);\n            if (cookieNameValue && cookieNameValue !== null) {\n                try {\n                    cookieName = decodeURIComponent(cookieNameValue[1]!);\n                    cookieValue = decodeValue(cookieParts[i]!.substring(cookieNameValue[1]!.length + 1));\n                } catch (ex) {\n                    // 忽略\n                }\n            } else {\n                // cookie 中没有 \"=\", 当成布尔值\n                cookieName = decodeURIComponent(cookieParts[i]!);\n                cookieValue = '';\n            }\n            if (cookieName !== null) {\n                // 默认后面的cookie覆盖前面的\n                cookies[cookieName] = cookieValue;\n            }\n        }\n\n    }\n\n    return cookies;\n}\n\nlet cookiesMap: {[key: string]: any} = {};\nlet prevCookie: string;\n/**\n * 获取cookie值.\n * @param {string} name cookie名称.\n * @param {object=} options 配置项\n *                    raw: 是否进行编码，true则是未编码\n * @return {*} 不存在返回null.\n */\nexport function getCookie(name: string, options: CookieOptions = {}, force = false) {\n    try {\n        if (!force && name in cookiesMap) {\n            return cookiesMap[name];\n        }\n        if (!window?.document) return;\n        // 处理 cookie 动态更新情形\n        const curCookie = document.cookie || '';\n        if (curCookie === prevCookie) return cookiesMap[name];\n        prevCookie = curCookie;\n        cookiesMap = parseCookieString(curCookie, !options.raw, options);\n        return cookiesMap[name];\n    } catch (err) {}\n}\n\n/**\n * 给定的键值设置cookie\n * @param {string} name 名称.\n * @param {*} value cookie值.\n * @param {object=} options (Optional) 配置项:\n *      path 路径\n *      domain 域名\n *      expires 过期时间，一个Date对象\n *      secure 是否安全cookie\n *      raw (true/false). Setting raw to true indicates that the cookie should not be URI encoded before being set.\n */\nexport function setCookie(name: string, value: string, options: CookieOptions = {}) {\n    try {\n        document.cookie = createCookieString(name, value, !options.raw, options);\n        cookiesMap[name] = value;\n    } catch (err) {}\n}\n// 测试用例清除cookie缓存使用\nexport function clearCacheCookies() {\n    cookiesMap = {};\n    prevCookie = '';\n}\n\nexport default {\n    getCookie,\n    setCookie,\n    parseCookieString\n};\n","export function log(...args: any[]) {\n    try {\n        const log = console?.log;\n        return log && log.call(console, ...args);\n    } catch (e) {\n        return;\n    }\n}\n\nexport function warn(...args: any[]) {\n    try {\n        const warn = console?.warn;\n        return warn && warn.call(console, ...args);\n    } catch (e) {\n        return;\n    }\n}\nconst sdkName: string = '__SDK_NAME__';\nexport function error(...args: any[]) {\n    try {\n        const error = sdkName === 'webLogger_krn' ? console?.log : console?.error;\n        return error && error.call(console, ...args);\n    } catch (e) {\n        return;\n    }\n}\n","import { ksAppList } from './const';\nimport { getCookie } from '@/util/cookie';\nimport type { UrlMapFn, UrlMap, UrlMapFnParam } from '../config/types';\nimport { error } from './console';\n\n/**\n * 获取 localStorage 缓存\n */\nexport function getLocalStorageItem(key: string) {\n    try {\n        if (window && window.localStorage) {\n            const value = window.localStorage.getItem(key);\n            if (value) {\n                try {\n                    return JSON.parse(value);\n                } catch (err) {\n                    return value;\n                }\n            }\n        }\n    } catch (err) {\n        return null;\n    }\n    return null;\n\n}\n/**\n * 设置 localStorage 缓存\n */\nexport function setLocalStorageItem(key: string, value: any) {\n    try {\n        if (window && window.localStorage) {\n            window.localStorage.setItem(key, JSON.stringify(value));\n            return true;\n        }\n    } catch (err) {\n        return false;\n    }\n    return false;\n}\n\n/**\n * 判断item是否在目标数组arr中\n * @param {*} arr   目标数组\n * @param {*} item  item\n */\nexport function inArray(arr: any[], item: any) {\n    return arr.indexOf(item) > -1;\n}\n/**\n * 从目标arr中删除item\n * @param {*} arr  目标数组\n * @param {*} item  item\n */\nexport function deleteArray(arr: any[], item: any) {\n    const index = arr.indexOf(item);\n\n    if (index > -1) {\n        arr.splice(index, 1);\n    }\n}\n\n/**\n * 事件监听兼容处理\n * @param {*} evtTarget  事件监听目标\n * @param {*} evtName   事件名\n * @param {*} callback  回调函数\n * @param {*} options  相关参数设置\n */\nexport function addMonitor(\n    evtTarget: Element | Window | Document,\n    evtName: string,\n    callback: EventListenerOrEventListenerObject,\n    options?: boolean | AddEventListenerOptions,\n) {\n    if ('attachEvent' in evtTarget) {\n        return evtTarget.attachEvent('on' + evtName, callback);\n    }\n    return evtTarget.addEventListener(evtName, callback, options);\n}\n\n/**\n * 事件监听解绑兼容处理\n * @param {*} evtTarget  事件监听目标\n * @param {*} evtName   事件名\n * @param {*} callback  事件回调\n */\nexport function removeMonitor(\n    evtTarget: Element | Window | Document,\n    evtName: string,\n    callback: EventListenerOrEventListenerObject,\n    options?: boolean | AddEventListenerOptions,\n) {\n    if ('attachEvent' in evtTarget) {\n        return evtTarget.detachEvent('on' + evtName, callback);\n    }\n    return evtTarget.removeEventListener(evtName, callback, options);\n}\n\nexport function leftPad(str: string, len: number, ch = ' ') {\n    len = len - str.length;\n    if (len <= 0) {\n        return str;\n    }\n    let pad = '';\n    while (len) {\n        if (len & 1) {\n            pad += ch;\n        }\n        len >>= 1;\n        ch += ch;\n    }\n    return pad + str;\n}\n\n/**\n * 是否是快手系APP\n */\nexport const isInApp = (ua = window.navigator.userAgent.toLowerCase()) => {\n    try {\n        for (let i = 0; i < ksAppList.length; i++) {\n            if (ua.indexOf(ksAppList[i]!.toLowerCase()) > -1) {\n                return true;\n            }\n        }\n    } catch (err) {\n        return false;\n    }\n};\n\nexport function parseQueryString(queryString: string) {\n    const result: any = {};\n    const queries = queryString.split('&');\n    for (const query of queries) {\n        const [key, value] = query.split('=');\n        if (!(key! in result)) {\n            result[key!] = value;\n            continue;\n        }\n        if (result[key!] instanceof Array) {\n            result[key!].push(value);\n            continue;\n        }\n        result[key!] = [result[key!], value];\n    }\n    return result;\n}\n\nexport function stringifyQuery(paramsString: any) {\n    const params = typeof paramsString === 'string' ? JSON.parse(paramsString) : paramsString;\n    const queries: string[] = [];\n    Object.keys(params).forEach(key => {\n        if (params[key] instanceof Array) {\n            for (const val of params[key]) {\n                queries.push(`${key}=${val}`);\n            }\n        } else if (typeof params[key] === 'object' && params[key] !== null) {\n            queries.push(`${key}=${JSON.stringify(params[key])}`);\n        } else {\n            queries.push(`${key}=${params[key]}`);\n        }\n    });\n    return queries.join('&');\n}\n\n// 参考：https://codereview.stackexchange.com/questions/37512/count-byte-length-of-string\nexport function getStringBytes(data: any) {\n    let dataStr = '';\n\n    // Force string type\n    if (typeof data === 'string') {\n        dataStr = data;\n    } else {\n        try {\n            dataStr = JSON.stringify(data);\n        } catch (e) {\n            dataStr = String(data);\n        }\n    }\n\n    let byteLen = 0;\n    for (let i = 0; i < dataStr.length; i++) {\n        const c = dataStr.charCodeAt(i);\n        byteLen += c < (1 << 7) ? 1 :\n            c < (1 << 11) ? 2 :\n                c < (1 << 16) ? 3 :\n                    c < (1 << 21) ? 4 :\n                        c < (1 << 26) ? 5 :\n                            c < (1 << 31) ? 6 : Number.NaN;\n    }\n    return byteLen;\n}\n\n/**\n * lodash 的 pick 方法\n */\nexport function pick(data: any, paths: string[]) {\n    let index = -1;\n    const length = paths.length;\n    const result: any = {};\n\n    while (++index < length) {\n        const path = paths[index];\n        const value = data[path!];\n        result[path!] = value;\n    }\n\n    return result;\n}\n\n/**\n * lodash的omit方法\n * @param data\n * @param paths\n */\nexport function omit(data: any, paths: string[]) {\n    const result: any = {};\n\n    for (const i in data) {\n        if (data.hasOwnProperty(i)) {\n            if (Array.isArray(paths) && paths.indexOf(i) === -1) {\n                result[i] = data[i];\n            }\n        }\n    }\n\n    return result;\n}\n\n/**\n * 检查依赖版本号是否不小于推荐版本\n */\nexport function checkVersion(recommendVersion: string, version: string) {\n    if (!version) return false;\n    if (version.indexOf('alpha') !== -1) return false;\n    if (version.indexOf('beta') !== -1) return false;\n    try {\n        let matches = recommendVersion.match(/\\d+\\.\\d+\\.\\d+/);\n        recommendVersion = matches?.[0] || '';\n        if (!recommendVersion) return true;\n\n        matches = version.match(/\\d+\\.\\d+\\.\\d+/);\n        version = matches?.[0] || '';\n        if (!version) return false;\n\n        const [rMajor, rMinor, rPatch] = recommendVersion.split('.').map((i: string) => Number(i));\n        const [major, minor, patch] = version.split('.').map((i: string) => Number(i));\n\n        if (major! < rMajor!) return false;\n        if (major! > rMajor!) return true;\n\n        if (minor! < rMinor!) return false;\n        if (minor! > rMinor!) return true;\n\n        if (patch! < rPatch!) return false;\n\n        return true;\n    } catch (err) {\n        return false;\n    }\n}\n\nexport function checkSupportCloseCoPage() {\n    const version = getCookie('appver', undefined, true);\n    return version && checkVersion('10.8.30', version);\n}\n/**\n * 获取元素xpath\n * @param element 元素\n */\nexport function getXpathFromNode(element: HTMLElement): string {\n    // if (element && element.id !== '')\n    //     return 'id(\"' + element.id + '\")';\n    if (element === document.body)\n        return 'HTML/' + element.tagName;\n\n    let ix = 0;\n    if (element && element.parentNode) {\n        const siblings = element.parentNode.childNodes;\n        for (let i = 0; i < siblings.length; i++) {\n            const sibling = siblings[i] as HTMLElement;\n            if (sibling === element)\n                return getXpathFromNode(element.parentNode as HTMLElement) + '/' + element.tagName + '[' + (ix + 1) + ']';\n            if (sibling.nodeType === 1 && sibling.tagName === element.tagName)\n                ix++;\n        }\n    }\n    return '';\n}\n\n/**\n * url中获取path和query\n */\nexport function getPathAndQueryFromUrl() {\n    const { protocol, host, pathname, search, href } = window.location;\n    const pageUrl = href;\n    const pagePath = protocol + host + pathname;\n    const pageParams = parseQueryString(search.slice(1));\n    return { pageUrl, pagePath, pageParams };\n}\n\nexport function getUrlAndQueryFromUrl(url = location.href) {\n    const queryIndex = url.lastIndexOf('?');\n    if (queryIndex === -1) {\n        return {\n            page: url\n        };\n    }\n    const page = url.slice(0, queryIndex);\n    const queryString = url.slice(queryIndex + 1);\n    return {\n        page,\n        params: parseQueryString(queryString),\n    };\n};\n\nexport const getMappingPage = (urlPackage: UrlMapFnParam, urlMap?: UrlMap | UrlMapFn) => {\n    let { url, page, params, pageId } = urlPackage;\n    if (!page && typeof url === 'string') {\n        const parsed = getUrlAndQueryFromUrl(url);\n        page = parsed.page;\n        params = parsed.params;\n    }\n    if (typeof urlMap === 'function') {\n        try {\n            const res = urlMap({ url, page, params });\n            if (typeof res === 'string') {\n                page = res;\n            } else if (typeof res === 'object') {\n                if (res.page) {\n                    page = res.page;\n                }\n                if (res.params) {\n                    params = res.params;\n                }\n                if (res.pageId) {\n                    pageId = res.pageId;\n                }\n            }\n        } catch (err) { }\n    } else if (typeof urlMap === 'object') {\n        let mappingPage = '';\n        for (const key in urlMap) {\n            if ((url || page || '').indexOf(key) > -1) {\n                mappingPage = urlMap[key]!;\n                break;\n            }\n        }\n        if (mappingPage) {\n            page = mappingPage;\n        }\n    }\n    return {\n        page,\n        params,\n        pageId\n    };\n};\n\nexport function cloneDeep(obj: [] | {}): [] | {} {\n    if (typeof obj !== 'object') return {};\n    const newObj = obj instanceof Array ? [] : {};\n    for (const key in obj) {\n        if (obj.hasOwnProperty(key)) {\n            // @ts-ignore\n            newObj[key] = typeof obj[key] === 'object' ? cloneDeep(obj[key]) : obj[key];\n        }\n    }\n    return newObj;\n}\n\n/**\n * 非空纯对象判定\n * @param obj\n * @returns\n */\n const isObj = (obj: any) => obj && typeof obj === 'object' && !Array.isArray(obj);\n /**\n  * 对象打平赋值\n  * @param target\n  * @param options\n  * @returns\n  */\n export const flattenAssign = (target: any, options: any) => {\n    if (!isObj(target) || !isObj(options)) return;\n    const merge = (obj1: any, obj2: any, key: string) => {\n        if (isObj(obj1[key]) && isObj(obj2[key])) {\n            Object.assign(obj1[key], obj2[key]);\n        } else if (!isObj(obj1[key]) && !isObj(obj2[key])){\n            obj1[key] = obj2[key];\n        }\n    }\n    for (const key in options) {\n        if (target.hasOwnProperty(key)) {\n            merge(target, options, key);\n            continue;\n        }\n        for (const deepKey in target) {\n            if (isObj(target[deepKey]) && target[deepKey].hasOwnProperty(key)) {\n                merge(target[deepKey], options, key);\n            }\n        }\n    }\n}\n\nexport function pageUrlValidate(page: string) {\n    // 对于上报到v2，page为url的埋点，给予警告\n    if (page && /^(https?:)?\\/\\//.test(page)) {\n        error('[error 108]',`请注意当前埋点页面信息为 ${page}，不符合规范，上报失败！`);\n        return false;\n    }\n    return true;\n}\n\nexport const getResolution = (() => {\n    let resolution = '';\n    return () => {\n        if (resolution) {\n            return resolution;\n        }\n        try {\n            const ratio = window.devicePixelRatio || 1;\n            const width = Math.floor(screen.width * ratio); // 有的devicePixelRatio为小数，在此转为整数\n            const height = Math.floor(screen.height * ratio);\n            resolution = `${width}x${height}`;\n            return resolution;\n        } catch (err) {\n            return '';\n        }\n    };\n})();\n\n// 从vue-router里面拿的……\nexport function supportsPushState() {\n    const ua = window.navigator.userAgent;\n    if (\n        (ua.indexOf('Android 2.') !== -1 || ua.indexOf('Android 4.0') !== -1)\n        && ua.indexOf('Mobile Safari') !== -1\n        && ua.indexOf('Chrome') === -1\n        && ua.indexOf('Windows Phone') === -1\n    ) {\n        return false;\n    }\n    return window.history && 'pushState' in window.history;\n}\n\nexport function deleteUrlQueryAndReturnFullUrl(url: string, deleteKeyArray: string[]) {\n    const { page, params } = getUrlAndQueryFromUrl(url);\n    if (Array.isArray(deleteKeyArray) && deleteKeyArray.length) {\n        deleteKeyArray.forEach(key => {\n            delete params[key];\n        });\n        let paramsString = '';\n        for (const i in params) {\n            if (params.hasOwnProperty(i)) {\n                paramsString += paramsString ? '&' : '';\n                paramsString += `${i}=${params[i]}`;\n            }\n        }\n        return paramsString ? `${page}?${paramsString}` : page;\n    }\n    return url;\n}\n\ninterface TypeQueryMap {\n    [key: string]: string | number;\n}\n\n/**\n * 设置url中的参数，并返回完整url\n * @param url\n * @param configQueryMap\n */\nexport function setUrlQueryAndReturnFullUrl(url: string, configQueryMap: TypeQueryMap): string {\n    if (typeof configQueryMap !== 'object') {\n        return url;\n    }\n    let paramsString = '';\n    for (const i in configQueryMap) {\n        if (configQueryMap.hasOwnProperty(i)) {\n            const paramString = `${i}=${configQueryMap[i]}`;\n            paramsString += paramsString ? `&${paramString}` : paramString;\n        }\n    }\n    let partUrl;\n    const lastChar = url[url.length - 1];\n    if (url.indexOf('?') === -1) {\n        // 不存在变量\n        partUrl = `?${paramsString}`;\n    } else if (lastChar === '?' || lastChar === '&') {\n        // 处理最后一个字符是 ? 以及 & 的特殊情况\n        partUrl = paramsString;\n    } else {\n        // 正常添加变量\n        partUrl = `&${paramsString}`;\n    }\n    return url + partUrl;\n}\n\nexport function isMobileAndIpad() {\n    const ua = window?.navigator?.userAgent || '';\n    const isMobile = /mobile|tablet|ip(ad|hone|od)|android|(windows phone)/i.test(ua);\n    // 兼容最新版本 ipad 版本 ua 判断\n    const isiPad = window?.navigator.platform === 'MacIntel' && window?.navigator?.maxTouchPoints > 1;\n    return isMobile || isiPad;\n}\n\n/**\n * 是否支持 worker gzip 压缩\n * @returns\n */\nexport const enableAsyncGzip = () => !!(\n    window?.Worker // 可以新建 worker\n    && window?.Uint8Array // 支持二进制存储\n    && window.URL // 可以创建文件路径\n    && window.Promise // 可以使用 promise\n    && !isMobileAndIpad() // 移动端禁止使用压缩\n);\n\n/**\n * 返回正整数数值\n * @param value\n */\nexport const getPositiveInteger = (value: number) => {\n    try {\n        return Math.abs(Math.floor(value));\n    } catch (e) {\n        return value;\n    }\n};\n\nexport function stringifyParams(params: string | any) {\n    return typeof params === 'string' ? params : typeof params === 'object' ? JSON.stringify(params) : '';\n}\n","import { getLocalStorageItem, setLocalStorageItem } from '../util';\n// 常规业务事件自增 id key\nconst LOCAL_INCREAMENT_ID_KEY = 'WEBLOGGER_INCREAMENT_ID_KEY';\n// 自定义事件自增 id key\nconst LOCAL_CUSTOM_INCREAMENT_ID_KEY = 'WEBLOGGER_CUSTOM_INCREAMENT_ID_KEY';\n// Bridge 常规事件自增 id 本地缓存 key\nconst H5_SEQ_ID_KEY = 'WEBLOGGER_H5_SEQ_ID';\n// Bridge 自定义事件自增 id 本地缓存 key\nconst H5_CUSTOM_SEQ_ID_KEY = 'WEBLOGGER_H5_CUSTOM_SEQ_ID';\n// http 请求自增 id 本地缓存 key\nconst LOCAL_HTTP_INCREMENT_ID_KEY = 'WEBLOGGER_HTTP_SEQ_ID';\n// v2 自增 id 本地缓存 key\nconst V2_INCREMENT_ID_KEY = 'WEBLOGGER_V2_SEQ_ID';\nconst CHANNEL_INCREMENT_ID_KEY = 'WEBLOGGER_CHANNEL_SEQ_ID';\n// 自增 id 最大值\nconst maxId = 1e8;\n// 如果没有 localStorage 则使用运行时自增 id，用于非浏览器场景，比如 React Native\nconst runtimeIdMap:{[key: string]: number} = {};\nconst genId = (key: string) => {\n    try {\n        if (window && window.localStorage && typeof Storage !== 'undefined' && window.localStorage instanceof Storage) {\n            let id = Number(getLocalStorageItem(key)) || 0;\n            if (id + 1 > maxId) {\n                id = 0;\n            }\n            setLocalStorageItem(key, id + 1);\n            return id;\n        }\n    } catch (err) {};\n    if (!runtimeIdMap[key]) {\n        runtimeIdMap[key] = 0;\n    }\n    return runtimeIdMap[key] ++;\n}\n/**\n * 常规事件自增 id\n */\nexport const getNomalIncrementId = () => {\n    return genId(LOCAL_INCREAMENT_ID_KEY);\n};\n/**\n * 自定义事件自增 id\n */\nexport const getCustomIncrementId = () => {\n    return genId(LOCAL_CUSTOM_INCREAMENT_ID_KEY);\n};\n/**\n * 桥接常规事件自增 id\n */\nexport const getBridgeNormalIncrementId = () => {\n    return genId(H5_SEQ_ID_KEY);\n};\n/**\n * 桥接自定义事件自增 id\n */\nexport const getBridgeCustomIncrementId = () => {\n    return genId(H5_CUSTOM_SEQ_ID_KEY);\n};\n/**\n * http 请求自增 id\n */\nexport const getHttpIncrementId = () => {\n    return genId(LOCAL_HTTP_INCREMENT_ID_KEY);\n};\n/**\n * v2 channel 自增 id\n */\nexport const getChannelIncrementId = (channel: string = '') => {\n    return genId(`${CHANNEL_INCREMENT_ID_KEY}_${channel}`);\n};\n/**\n * v2 事件自增 id\n */\nexport const getV2EventIncrementId = (event: string) => {\n    return genId(`${V2_INCREMENT_ID_KEY}_${event}`);\n};","import type {\n    EventType as IEventType,\n    EventOptions as IEventOptions,\n    DangerCunstomEventOption\n} from '@/types/event';\n\nexport const oldApiTransformer = <T extends IEventType>(\n    type: T | { type: T },\n    name: string | IEventOptions<T> = {},\n    params?: any,\n    contentPackage?: {[key: string]: any} | string\n): [T, IEventOptions<T>] => {\n    let realType: T;\n    if (typeof type !== 'string') {\n        realType = type.type;\n    }\n    realType = (type as T).toUpperCase() as T;\n    let options: any = {};\n    if (typeof name === 'string') {\n        console.warn('[warn 105]', '接口参数为旧式，后续版本将不再兼容，推荐使用新的参数形式');\n        options.contentPackage = contentPackage;\n        if (type === 'CUSTOM') {\n            options.key = name;\n            options.value = params;\n        } else {\n            options.params = params;\n            if (type === 'PV') {\n                options.page = name;\n            }else {\n                options.action = name;\n            }\n        }\n    } else {\n        options = name;\n        if (['CUSTOM', 'CUSTOM_EVENT'].includes(realType)) {\n            const customParams = name as DangerCunstomEventOption & { key?: string; value?: any };\n            if (customParams.action && !customParams.key) {\n                options.key = customParams.action;\n            }\n            if (customParams.params && !customParams.value) {\n                options.value = customParams.params;\n            }\n        }\n    }\n    return [\n        realType,\n        options\n    ];\n};","import { supportsPushState, isInApp } from './index';\nimport { getCookie } from './cookie';\n\nlet uaInfo: {\n    os: {\n        name?: string;\n        version?: string;\n    },\n    model?: string;\n};\n\nlet lastUA = window?.navigator?.userAgent || ''\n\nexport const getUAInfo = (ua = window?.navigator?.userAgent) => {\n    if (uaInfo && ua === lastUA) {\n        return uaInfo;\n    }\n    const UNKNOWN = 'unknow';\n    const androidReg = /android/i;\n    const MacOS = 'Mac OS';\n    const Windows = 'Windows';\n    const Android = 'Android';\n    const iPhone = 'iPhone';\n    const iPad = 'iPhone';\n    const WinPhone = 'Windows Phone';\n    const Linux = 'Linux';\n    uaInfo = {\n        os: {\n            name: UNKNOWN,\n            version: UNKNOWN\n        },\n        model: UNKNOWN\n    };\n    try {\n        const uaMatches = ua.match(/\\((.*?)\\)/);\n        if (!uaMatches) {\n            const isAndroid = androidReg.test(ua);\n            if (isAndroid) {\n                uaInfo.os.name = Android;\n            }\n            return uaInfo;\n        }\n        const uaMain = uaMatches[1] + ')';\n        const uaArr = uaMain.split(';').map(str => str.trim());\n        let osName, osVersion, model;\n        if (ua.indexOf(WinPhone) > -1) {\n            model = osName = WinPhone;\n            const matches = uaMain.match(/Windows\\sPhone\\s(.*?)[;\\)\\s]/);\n            if (matches) {\n                osVersion = matches[1];\n            }\n            model = uaArr[uaArr.length - 1]?.replace(')', '');\n        } else if (androidReg.test(ua)) {\n            // 安卓 ua 信息解析\n            osName = Android;\n            const modelMatches = uaMain.match(/android.*?;(.*?)build\\//i);\n            if (modelMatches) {\n                model = modelMatches[1]?.split(';').pop();\n                model = model && model.trim();\n            }\n            for (let i = 0; i < uaArr.length; i++) {\n                if (androidReg.test(uaArr[i]!)) {\n                    osVersion = uaArr[i]?.replace(androidReg, '');\n                    if (!model) {\n                        model = uaArr[i + 1];\n                    }\n                    break;\n                }\n            }\n        } else if (ua.indexOf(iPhone) > -1 || ua.indexOf(iPad) > -1) {\n            // iOS 系统信息解析\n            model = ua.indexOf(iPhone) > -1 ? iPhone : iPad;\n            osName = 'iOS';\n            const matches = uaMain.match(/OS\\s(.*?)\\slike/);\n            if (matches) {\n                osVersion = matches[1];\n            }\n        } else if (ua.indexOf(MacOS) > -1) {\n            // Mac OS 系统信息解析\n            model = osName = MacOS;\n            const matches = uaMain.match(/OS\\sX\\s(.*?)[;\\)\\s]/);\n            if (matches) {\n                osVersion = matches[1];\n            }\n        } else if (ua.indexOf(Windows) > -1) {\n            model = osName = Windows;\n            const matches = uaMain.match(/Windows\\s(.*?)[;\\)]/);\n            if (matches) {\n                osVersion = matches[1];\n            }\n        } else if (ua.indexOf('Nokia') > -1) {\n            osName = 'Symbian';\n            const vMatches = ua.match(/Symbian.*?\\/(.*?);/);\n            if (vMatches) {\n                osVersion = vMatches[1];\n            }\n            const mMatches = ua.match(/Nokia(.*?)\\//);\n            if (mMatches) {\n                model = mMatches[1];\n            }\n        } else if (uaMain.indexOf(Linux) > -1) {\n            osName = model = Linux;\n        }\n        uaInfo = {\n            os: {\n                name: osName || UNKNOWN,\n                version: osVersion && osVersion.replace(/_/g, '.').trim() || UNKNOWN\n            },\n            model: model || UNKNOWN\n        };\n    } catch (err) {\n        console.error('[109]', 'UA 信息解析错误', (err as Error).message);\n    }\n    return uaInfo;\n};\n\n\n/**\n * http://git.corp.kuaishou.com/ks-frontend/modules/web-util/blob/master/src/device.js\n */\nconst kpnFromUA = () => {\n    if (typeof window === 'undefined') return '';\n    let ua = window.navigator.userAgent;\n    // 注意顺序很重要\n    let rules = [\n        [/ Kwai\\//, 'KUAISHOU'],\n        [/ ksthanos\\//, 'THANOS'],\n        [/ ksNebula\\//i, 'NEBULA'],\n\n        // iOS 审核移除敏感信息\n        // [/ wxwork\\//, 'workWechat'],\n        // [/ MicroMessenger\\//, 'wechat'],\n        // [/ QQ\\//, 'qq'],\n        // [/__weibo__([^_]+)/, 'weibo'],\n        // [/ livemate\\//, 'livemate'],\n        // [/ baiduboxapp\\//, 'baidu'],\n\n        // [/ MQQBrowser\\//, 'qqBrowser'],\n        // [/\\(MSIE ([^;]+);/, 'ie'],\n    ];\n\n    for (let i = 0; i < rules.length; i++) {\n        let tmp = rules[i]!;\n        let rule = tmp[0];\n        let name = tmp[1];\n        let rRes = (rule as RegExp).exec(ua);\n        if (rRes) {\n            return name;\n        }\n    }\n    return '';\n};\n\n/**\n * 获取默认的 KPN,TODO: 副作用函数\n */\nlet defaultKpn: string;\nexport function getDefaultKpn() {\n    if (defaultKpn === undefined) {\n        defaultKpn = isInApp() && getCookie('kpn') || kpnFromUA() || '';\n    }\n    return defaultKpn;\n}\n\n/**\n * 判断是否是 kds 环境\n */\nexport const isKDSNative = (() => {\n    let res: boolean | undefined;\n    return () => {\n        if (typeof res !== undefined) return res;\n        const platform = window?.navigator?.platform?.toLowerCase();\n        res = !!(platform && ['ios', 'android'].indexOf(platform) !== -1);\n        return res;\n    }\n})();\n\nexport default {\n    supportsPushState,\n    getUAInfo,\n    getDefaultKpn\n};","import type { Invoke, YodaInterface } from '@/types/bridge-invoke';\nimport { error } from './console';\nimport type { SetClientLogTypes } from '@/types/bridge';\n\nexport { SetClientLogTypes } from '@/types/bridge';\nexport type { Invoke, YodaInterface } from '@/types/bridge-invoke';\n\nlet invoke!: Invoke;\n\nexport const isInYoda = () => {\n    // @ts-ignore\n    return typeof window?.__yodaBridge__?.invoke === 'function';\n};\n\n/**\n * 是否支持桥接 canIUse\n */\nconst isSupportBridge = async (name: string, namespace = 'tool') => {\n    if (typeof invoke === 'undefined') return false;\n    const res = await invoke('tool.canIUse', {\n        namespace,\n        name\n    });\n    return (res as any)?.canUse as boolean || false;\n};\n\n/**\n * 是否支持桥接上报埋点接口\n */\nexport const isSupportBridgeLog = () => {\n    return isSupportBridge('setClientLog');\n};\n\n/**\n * 传入 invoke 方法\n */\nexport const postInvoke = (invokeOrYoda: YodaInterface | Invoke) => {\n    if (typeof invokeOrYoda === 'function') {\n        invoke = invokeOrYoda;\n    } else {\n        invoke = invokeOrYoda.invoke;\n    }\n};\n\n/**\n * 发送业务事件\n */\nexport const setClientLog = async (type: SetClientLogTypes, data: unknown) => {\n    try {\n        return await invoke('tool.setClientLog', { type, data });\n    } catch (err) {\n        error(\n            '[error 206]', `yoda.tool.setClientLog() 报错: ${(err as Error).message}`,\n        );\n    }\n};\n\n/**\n * 发送雷达事件\n */\nexport const sendRadarLog = async (params: any) => {\n    try {\n        return await invoke('tool.sendRadarLog', params);\n    } catch (err) {\n        error(\n            '[error 207]', `yoda.tool.sendRadarLog() 报错: ${(err as Error).message}`,\n        );\n    }\n};\n\n/**\n * 发送web日志，支持日志回捞\n */\nexport const sendWebLog = async (params: any) => {\n    try {\n    return  invoke('tool.sendWebLog', params);\n} catch (err) {\n    error(\n        '[error 214]', `yoda.tool.sendWebLog() 报错: ${(err as Error).message}`,\n    );\n}\n};\n\n/**\n * 发送汇总数据\n */\nexport const sendSummarizedLog = async (params: any) => {\n    try {\n        return await invoke('tool.sendSummarizedLog', params);\n    } catch (err) {\n        error(\n            '[error 208]', `yoda.tool.sendSummarizedLog() 报错: ${(err as Error).message}`,\n        );\n    }\n};\n\n/**\n * 获取应用信息\n * @returns\n */\nexport const getAppInfo = async () => {\n    try {\n        return await invoke('system.getAppInfo');\n    } catch (err) {\n        error(\n            '[error 209]', `yoda.system.getAppInfo() 报错: ${(err as Error).message}`,\n        );\n    }\n};\n\n/**\n * 获取 webview 信息\n */\nexport const getWebviewLoadPerf = async (params: any = {}, options: any) => {\n    try {\n        return await invoke('webview.getPageLoadData', params, options);\n    } catch (err) {\n        error(\n            '[error 209]', `yoda.webview.getPageLoadData() 报错: ${(err as Error).message}`,\n        );\n    }\n};\n\n/**\n * 获取 webview 加载信息\n */\nexport const getWebviewInfo = async () => {\n    try {\n        return await invoke('webview.getLaunchParams');\n    } catch (err) {\n        error(\n            '[error 209]', `yoda.webview.getPageLoadData() 报错: ${(err as Error).message}`,\n        );\n    }\n};\n\n/**\n * 获取 ksd相关webview 信息\n */\nexport const getKDSWebviewLoadPerf = async (params: any = {}) => {\n    try {\n        return await invoke('system.getPageLoadData', params);\n    } catch (err) {\n        error(\n            '[error 209]', `yoda.system.getPageLoadData() 报错: ${(err as Error).message}`,\n        );\n    }\n};\n\n/**\n * 获取设备信息\n * @returns\n */\nexport const getDeviceInfo = async () => {\n    try {\n        return await invoke('system.getDeviceInfo');\n    } catch (err) {\n        error(\n            '[error 209]', `yoda.system.getDeviceInfo() 报错: ${(err as Error).message}`,\n        );\n    }\n};\n\n\nexport default {\n    setClientLog,\n    sendRadarLog,\n    sendWebLog,\n    sendSummarizedLog,\n    getWebviewLoadPerf,\n    getKDSWebviewLoadPerf,\n    isSupportBridgeLog,\n    isSupportBridge,\n    invoke\n};\n\n","import { error } from '@/util/console';\n\nexport const xhrErrorLog = (err: any, url: string, data: any) => error('[error 400]', '埋点上报接口请求报错', '\\nurl:', url, '\\ndata', data, '\\nerror:', err || 'server decode log failed');\n\nexport const logXhrResponseCheck = (status: number, response: string, url: string, data: any) => {\n    let err;\n    if (status < 200 || (status >= 300 && status !== 304)) {\n        const err = response || status || 'unknonw error';\n    } else {\n        try {\n            const { exception, result, error_msg } = JSON.parse(response);\n            if (exception) {\n                err = exception;\n            }\n            if (result !== 1) {\n                err = error_msg || `result is ${result}`\n            }\n        } catch (e){\n            err = (e as Error).message;\n        }\n    }\n    err && xhrErrorLog(err, url, data);\n    return err;\n}","import type { DataOptions } from './types';\nimport { logXhrResponseCheck, xhrErrorLog } from './util';\nimport { error } from '@/util/console';\n\nexport default function send(\n    { url, data, timeout }: DataOptions,\n    callback?: (error?: any) => void,\n): Promise<{\n    error?: string;\n    response?: string\n}> {\n    return new Promise(resolve => {\n        const xhr = new XMLHttpRequest();\n        // async 同步情况会报错，而且影响性能，取消使用同步\n        xhr.open('POST', url);\n        xhr.setRequestHeader('Content-Type', 'text/plain;charset=UTF-8');\n        if (typeof data === 'object' && !(data instanceof Uint8Array)) {\n            data = JSON.stringify(data);\n        }\n        if (timeout) {\n            xhr.timeout = timeout;\n        }\n        xhr.onload = () => {\n            const err = logXhrResponseCheck(xhr.status, xhr.response, url, data);\n            callback && callback(err);\n            resolve({\n                error: err,\n                response: err ? undefined : xhr.response,\n            });\n        };\n\n        xhr.ontimeout = xhr.onerror = err => {\n            if (err) xhrErrorLog(err, url, data);\n            // err 不能直接传入 postMessage，会导致 postMessage 直接报错，误认为 worker 内部直接逻辑报错，以后发送埋点直接无法压缩\n            callback && callback(err ? 'networkTimeout' : '');\n            resolve({\n                error: 'networkTimeout',\n            });\n        };\n        xhr.send(data);\n        return xhr;\n    });\n}\n\nexport const get = (url: string) => {\n    const errorHandler = (err: any) => error('[error 401]', `GET 请求出错 url: ${url}`, err);\n    try {\n        const xhr = new XMLHttpRequest();\n        xhr.open('GET', url);\n        xhr.setRequestHeader('Content-Type', 'text/plain;charset=UTF-8');\n        xhr.send();\n        xhr.onerror = errorHandler;\n    } catch (err) {\n        errorHandler(err);\n    }\n};\n","import type { UrlMapFn, UrlMap, PageTypeKey, UrlObj } from '@/config/types';\n\nimport BaseUrlPackage from '@/core/url-package';\nimport { getMappingPage, getUrlAndQueryFromUrl } from '@/util';\nimport { uuid } from '@/util/uuid';\n\nexport default class UrlPackage extends BaseUrlPackage {\n    sampled?: boolean | {radar: {[key: string]: number}};\n    constructor(url: string | UrlObj, pageType: PageTypeKey, urlMap?: UrlMap | UrlMapFn) {\n        super({}, pageType);\n        if (typeof url === 'string') {\n            // TODO: 避免兼容问题，暂不处理\n            // try {\n            //     url = window.decodeURIComponent(url);\n            // } catch (err) {}\n            const obj = getUrlAndQueryFromUrl(url);\n            this.page = obj.page;\n            this.params = obj.params;\n        } else {\n            this.page = (url || {}).page || '';\n            this.params = (url || {}).params || undefined;\n        }\n        this.identity = this.generatePageId();\n        if (urlMap && typeof url === 'string') {\n            this.init(url, urlMap);\n        }\n    }\n\n    init(url: string, urlMap: UrlMap | UrlMapFn = {}) {\n        const { page, params } = getMappingPage({url, page: this.page, params: this.params}, urlMap);\n        this.update(page, params);\n    }\n\n    attachUrl() {\n        if (!this.params) {\n            this.params = {};\n        }\n        if (location?.href) {\n            // 电商需求，页面信息携带原始 url 和 pathname\n            this.params.origin_url = this.params.origin_url || location?.href;\n            const { page = '' } = getUrlAndQueryFromUrl(location.href);\n            this.params.origin_pathname = page;\n        }\n    }\n\n    getRealUrlPackage() {\n        const { page, params } = getUrlAndQueryFromUrl(location.href);\n        return {\n            page,\n            params: JSON.stringify({\n                page_code: this.page,\n                url: location.href,\n                query: params,\n                ...params\n            }),\n            page_type: this.page_type,\n            identity: this.identity\n        };\n    }\n\n    override generatePageId() {\n        return uuid();\n    }\n\n}","/**\n * 纯端内桥接版本，最小化包体积\n */\nimport type { BasePlugin, BasePluginConstructor } from '@/plugins/base';\nimport type { BridgeWeblogInitParams, UrlObj, PageTypeKey } from '@/types/configuration';\nimport type {\n    EventType as IEventType,\n    EventOptions as IEventOptions,\n} from '@/types/event';\nimport {\n    getBridgeNormalIncrementId,\n    getBridgeCustomIncrementId,\n} from '@/util/increment-id';\nimport cookieUtils, { getCookie } from '@/util/cookie';\nimport { oldApiTransformer } from '@/util/history-polyfill';\nimport { logFactory } from './log';\nimport yodaUtils, { setClientLog, postInvoke } from '@/util/yodav2';\nimport type { SetClientLogTypes } from '@/util/yodav2';\nimport sendData from '@/io/xhr';\nimport UrlPackage from '../browser/url-package';\nimport {\n    pageUrlValidate,\n    getResolution,\n    supportsPushState,\n    getPositiveInteger,\n    checkSupportCloseCoPage,\n    stringifyParams\n} from '@/util';\nimport { error } from '@/util/console';\nimport { isKDSNative } from '@/util/ua';\nimport { invoke, version } from '@yoda/bridge';\n\npostInvoke(invoke);\n/**\n * 判断当前yoda的状态\n * INIT: 初始状态\n * READY：可用，此时上报的埋点会以桥接方式上报\n * DISABLED：不可用，此时上报的埋点会以 http 方式上报\n * CHECKING：检查是否可用中，此时上报的埋点都会推入等待队列\n */\n enum YodaStatus {\n    INIT = -1,\n    CHECKING = 0,\n    READY = 1,\n    DISABLED = 2,\n}\n\nlet pluginIndex = 0;\n\nexport default class Weblogger {\n    static __instance: Weblogger;\n    version = '__VERSION__';\n    currentUrlPackage!: UrlPackage & { category?: string };\n    referUrlPackage?: UrlPackage;\n    commonPackage: CommonPackage;\n    logConfig: BridgeWeblogInitParams[0];\n    baseOption?: BridgeWeblogInitParams[1];\n    // 插件\n    plugins: {\n        [key: string]: BasePlugin | any;\n    } = {};\n    // 记录页面是否已发送过 enter pv;\n    entered: String = '';\n    constructor(configOption: BridgeWeblogInitParams[0], baseOption?: BridgeWeblogInitParams[1]) {\n        this.logConfig = configOption;\n        this.baseOption = baseOption;\n        this.commonPackage = new CommonPackage(baseOption);\n        this.updateCurrentUrlPackage();\n        this.addPlugins();\n        if (!Weblogger.__instance) {\n            Weblogger.__instance = this;\n        }\n        console.warn('[webLogger] 您正在使用的是',  '【纯桥接上报】的 js 包，端外打开不会上报埋点。');\n    }\n\n    get Utils() {\n        return {\n            yoda: yodaUtils,\n            cookie: cookieUtils,\n            ua: {\n                getDefaultKpn: () => getCookie('kpn'),\n                supportsPushState,\n            },\n            io: {\n                sendData,\n            },\n        }\n    }\n    get sessionId() {\n        return getCookie('session_id') || getCookie('sid');\n    }\n    /**\n     * 初始化插件\n     * @param plugins\n     */\n    addPlugins() {\n        if (!this.logConfig.plugins || !this.logConfig.plugins.length) return;\n        // 类似 webpack plugins 的实例数组\n        this.logConfig.plugins.forEach((plugin: any) => {\n            if (typeof plugin === 'object' && typeof plugin.apply === 'function') {\n                this.addPluginInstance(plugin);\n            }\n        });\n    }\n    /**\n     * 加载插件实例\n     */\n    addPluginInstance(pluginInstance: any) {\n        if (pluginInstance) {\n            const key = pluginInstance.key || pluginInstance.constructor && pluginInstance.constructor.key || `plugin_auto_key_${pluginIndex++}`;\n            if (typeof pluginInstance.apply === 'function'\n                && (!pluginInstance.weblog || pluginInstance.weblog !== this)\n            ) {\n                pluginInstance.apply(this);\n            }\n            this.plugins[key] = pluginInstance;\n        }\n    }\n    /**\n     * 加载插件构造函数\n     * @param plugin\n     * @param pluginOptions\n     */\n    plug(plugin: BasePluginConstructor, pluginOptions?: any) {\n        if (this.plugins[plugin.key]) {\n            return error('[code 301]', `${plugin.key} 插件重复加载！`)\n        }\n        this.addPluginInstance(new plugin(this, pluginOptions));\n    }\n\n    /**\n     * 收集上报\n     * @param type\n     * @param options\n     * @returns\n     */\n     collect<T extends IEventType>(type: T, options: IEventOptions<T>): void;\n     collect<T extends IEventType>(type: T, name: string, params?: any, contentPackage?: { [keys: string]: any } | string): void;\n     collect<T extends IEventType>(\n         type: T,\n         name: string | IEventOptions<T>,\n         params?: any,\n         contentPackage?: { [keys: string]: any } | string,\n     ) {\n        const [logType, logParams] = oldApiTransformer(type, name, params, contentPackage);\n        return this.send(logType, logParams, false);\n    }\n\n    /**\n     * 立即上报\n     * @param type\n     * @param options\n     * @returns\n     */\n     sendImmediately<T extends IEventType>(type: T, options: IEventOptions<T>): void;\n     sendImmediately<T extends IEventType>(type: T, name: string, params?: any, contentPackage?: { [keys: string]: any } | string): void;\n     sendImmediately<T extends IEventType>(\n         type: T,\n         name: string | IEventOptions<T>,\n         params?: any,\n         contentPackage?: { [keys: string]: any } | string,\n     ) {\n        const [logType, logParams] = oldApiTransformer(type, name, params, contentPackage);\n        return this.send(logType, logParams, true);\n    }\n    sendByBridge<T extends IEventType>(\n        eventType: T,\n        eventOptions: IEventOptions<T>,\n        immediately?: boolean,\n    ) {\n        const { disablePV: configDisablePV, biz } = this.logConfig;\n        let { contentPackage, disablePV: eventDisablePV, bridgeFields = {}, urlPage } = eventOptions as IEventOptions<'CLICK'>;\n        const disablePV = configDisablePV || eventDisablePV;\n        if (contentPackage) {\n            contentPackage = typeof contentPackage === 'string' ? contentPackage : JSON.stringify(contentPackage);\n        }\n        let setClientLogType: SetClientLogTypes = 'addTaskEvent';\n        const isPVEvent = eventType === 'PV';\n        if (isPVEvent) {\n            if (disablePV) return;\n            // bridge PV 仅支持 enter 和 visible\n            const supportPVTypes = ['enter', 'visible'];\n            let { page, type, params, coPage, category } = eventOptions as IEventOptions<'PV'>;\n            // 半屏离开事件，直接调用新的方法\n            if (type === 'leave' && this.currentUrlPackage.coPage && checkSupportCloseCoPage()) {\n                setClientLog('closeCoPage', {\n                    ...eventOptions,\n                    ...this.currentUrlPackage,\n                });\n                return;\n            }\n            if (!type) (eventOptions as IEventOptions<'PV'>).type = type = 'enter';\n            if (supportPVTypes.indexOf(type) === -1) {\n                return;\n            }\n            // enter 则强行重新生成新的 currentUrlPackage，否则局部更新\n            if (type === 'enter') {\n                // params 和 page 的处理和 hybrid 保持一致，兼容 autopv 插件发送 pv 时在插件内部已经修改 currentUrlPackage 内容\n                params = !page ? this.currentUrlPackage.params : params;\n                page = page || this.currentUrlPackage.page;\n                this.updateCurrentUrlPackage({ page, params, force: true });\n                if (coPage) {\n                    this.currentUrlPackage.coPage = coPage;\n                }\n                if (category) {\n                    this.currentUrlPackage.category = category;\n                }\n                this.entered = page;\n            } else if (page === this.entered) {\n                this.currentUrlPackage.update(page, params);\n            }\n            // 对于上报到v2，page为url的埋点，给予提示\n            if (!pageUrlValidate(this.currentUrlPackage.page)) return;\n            setClientLogType = 'setCurrentPage';\n        }\n        const coPage = !!this.currentUrlPackage.coPage;\n        const urlPackage = urlPage?.page && !isPVEvent ? {\n            page: urlPage.page,\n            identity: urlPage.identity,\n            params: stringifyParams(urlPage.params),\n            page_type: this.currentUrlPackage.page_type\n        } : this.currentUrlPackage.toJSON();\n        const log = logFactory(eventType, {\n            biz,\n            ...eventOptions,\n            contentPackage,\n            currentUrlPackage: disablePV ? undefined : urlPackage,\n        } as any); // TODO: 暂时 any\n        const isCustomType = ['CUSTOM', 'RADAR', 'CUSTOM_EVENT'].indexOf(eventType) !== -1;\n        // 保持 h5ExtraAttr 来源统一\n        this.commonPackage.increaseH5SeqId(isCustomType);\n        // 设置 log 公共属性\n        const { service_name, sub_biz, need_encrypt } = this.baseOption || {};\n        // TODO: 桥接上报不需要 common_package 信息，可以优化\n        log.h5ExtraAttr = JSON.stringify(this.commonPackage.getH5ExtraAttr({ coPage }));\n        log.realtime = !!immediately;\n        log.serviceName = service_name || '';\n        log.subBiz = sub_biz || '';\n        log.needEncrypt = need_encrypt || false;\n        log.container = isKDSNative() ? 'REACT_NATIVE' : 'H5';\n        if (eventType === 'SHOW') {\n            setClientLogType = 'addElementShowEvent';\n        } else if (isCustomType) {\n            // 兼容业务一些迁移行为，自动把 custom_stat_event 转为 custom_event\n            setClientLogType = (eventType === 'CUSTOM_EVENT' || this.logConfig.customStatToCustom) ? 'addCustomEvent' : 'addCustomStatEvent';\n        }\n        setClientLog(setClientLogType, {\n            ...bridgeFields,\n            ...log,\n        });\n    }\n    send<T extends IEventType>(eventType: T, eventOptions: IEventOptions<T> = {}, immediately?: boolean) {\n        eventType = eventType.toUpperCase() as T;\n        this.sendByBridge(eventType, eventOptions, immediately);\n    }\n    updateCurrentUrlPackage(url: string | UrlObj = location?.href || '', type: PageTypeKey = 'web') {\n        if (typeof url === 'object' && !url.force && this.currentUrlPackage) {\n            const { page = this.currentUrlPackage.page, params = {} } = url;\n            if (!page || page === this.currentUrlPackage.page) {\n                const isPageEntered = this.entered === page;\n                if (!isPageEntered) {\n                    this.currentUrlPackage.update(page, params);\n                    return;\n                }\n                // 客户端内直接使用 updateCurrentUrlPackage 更改页面参数是无法成功的\n                // 客户端只认 pv 上报时候带上去的参数，因此此处发送一个visible类型的pv，改变客户端维护的页面参数\n                this.send('PV', {\n                    type: 'visible',\n                    page,\n                    params,\n                }, true);\n                return;\n            }\n        }\n        this.currentUrlPackage = new UrlPackage(url, type, this.logConfig.urlMap);\n        if (this.logConfig.attachUrl) this.currentUrlPackage.attachUrl();\n    }\n\n    /**\n     * 更新 refer url 信息\n     * @param url\n     * @param type\n     */\n    updateReferUrlPackage(url: string | UrlObj | UrlPackage = this.currentUrlPackage, type: PageTypeKey = 'web') {\n        if (url instanceof UrlPackage) {\n            this.referUrlPackage = url;\n        } else {\n            this.referUrlPackage = new UrlPackage(url, type, this.logConfig.urlMap);\n        }\n    }\n    updateCommonPackage(options: BridgeWeblogInitParams[1]) {\n        this.commonPackage.update(options);\n    }\n    flush() {}\n    on() {}\n    emit() {}\n}\n\nclass CommonPackage {\n    /**\n     * 容器类型\n     */\n    container?: 'REACT_NATIVE' | 'H5';\n    /**\n     * 中台服务名称，比如积木、im sdk等，如果业务log未使用中台服务，该字段置空\n     */\n    service_name?: string;\n    /**\n     * 子业务场景\n     */\n    sub_biz?: string;\n    /**\n     * 是否需要加密\n     */\n    need_encrypt?: boolean;\n    h5_extra_attr: {[key: string]: any} = {\n        // SDK 版本信息\n        sdk_name: '__SDK_NAME__',\n        sdk_version: '__VERSION__',\n        sdk_bundle: '__SDK_BUNDLE__',\n        host_product: getCookie('kpn'),\n        resolution: getResolution(),\n        domain: window.location.origin,\n        app_version_name: getCookie('appver') || '',\n        bridge_info: version || true,\n    };\n    app_package?: {\n        version_name: string;\n        container?: 'REACT_NATIVE' | 'H5'\n    };\n\n    constructor(option?: BridgeWeblogInitParams[1]) {\n        this.update(option);\n    }\n\n    getVersionName() {\n        return this.app_package?.version_name;\n    }\n\n    update(option?: BridgeWeblogInitParams[1]) {\n        Object.assign(this.h5_extra_attr, option?.h5_extra_attr);\n        this.container = option?.container;\n        this.service_name = option?.service_name;\n        this.sub_biz = option?.sub_biz;\n        this.need_encrypt = option?.need_encrypt;\n        this.app_package = {\n            version_name: this.h5_extra_attr.app_version_name,\n            container: isKDSNative() ? 'REACT_NATIVE' : 'H5'\n        }\n    }\n\n    // 用于统计桥接丢失率\n    increaseH5SeqId(isCustom?: Boolean) {\n        this.h5_extra_attr.client_timestamp = getPositiveInteger(Date.now());\n        this.h5_extra_attr.seq_id = isCustom ? getBridgeCustomIncrementId() : getBridgeNormalIncrementId();\n    }\n\n    getH5ExtraAttr(extraInfo?: {[key: string]: any}) {\n        return Object.assign({}, this.h5_extra_attr, extraInfo);\n    }\n}\n","import { isInApp } from '.';\nimport { getCookie, setCookie } from './cookie';\n\nexport function uuid() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\n    return v.toString(16);\n  });\n}\n\n/**\n * 生成nano id\n * @return {string} 16长度的字符串\n */\nexport function nanoId() {\n    const ts = ((Math.random() * 1e9) >>> 0);\n    const randomer = [];\n    const seed = '0123456789ABCDEF';\n    for (let i = 0; i < 7; i++) {\n        randomer.push(seed.charAt(Math.random() * 16));\n    }\n\n    return ts + randomer.join('');\n}\n/**\n * 提取顶级域名\n * @param {?string=} hostname\n * @return {string} 返回顶级域名\n */\nfunction resolveTopLevelDomain(hostname: string = typeof location !== 'undefined' ? location.hostname : '') {\n    if (!hostname) {\n        return '';\n    }\n\n    const ret = hostname.split('.');\n    const len = ret.length;\n    return (len <= 2 ? '' : `.${ret[len - 2]}.${ret[len - 1]}`);\n}\nconst didKey: string = 'did';\n/**\n * 生成did\n * @return {string}\n */\nexport function generateDID() {\n    try {\n        // 兼容一下原下发的did逻辑，如果能从did获取，那么就走did\n        // 如果不能，那就通过log sdk自行维护的_did来搞\n        let did = getCookie(didKey) || getCookie('_did');\n        if (!did) {\n            did = `web_${nanoId()}`;\n            const expires = new Date();\n            expires.setFullYear(expires.getFullYear() + 1);\n            setCookie('_did', did, {\n                expires,\n                domain: resolveTopLevelDomain(),\n                path: '/',\n            });\n        }\n        return did;\n    } catch (err) {\n        return '';\n    }\n}\nconst sessionKey = 'WEBLOGGER_SESSIONID';\n// session_id 用来串联在一次打开 App 期间跳转不同页面的用户行为\nexport const getSessionId = () => {\n    let sessionId: string = '';\n    const defaultKey = 'session_id';\n    try {\n        if (isInApp()) {\n            sessionId = getCookie(defaultKey) || getCookie('sid'); // 端内从 cookie 中获取客户端传来的 session_id\n            if (sessionId) return sessionId;\n        } else if (typeof sessionStorage !== 'undefined') {\n            sessionId = sessionStorage.getItem(sessionKey) || '';\n            if (!sessionId) {\n                sessionId = uuid();\n                sessionStorage.setItem(sessionKey, sessionId);\n            }\n        }\n    } catch (err) {\n        sessionId = uuid();\n    }\n    return sessionId || uuid();\n};\n","import type { UrlObj, PageTypeKey } from '@/config/types';;\nexport default class UrlPackage {\n    // 一级页面。参考埋点需求填写即可\n    page: string = '';\n    // 参数列表参考埋点需求填写，并转成 json 字符串格式\n    params?: {[key: string]: any};\n    // 实例的全局唯一标识，使用UUID即可\n    identity: string = '';\n    // 应用页面类型\n    page_type: 1 | 2 | 3 | 0;\n    // 是否是半屏页\n    coPage?: boolean;\n    // 桥接新添加字段\n    category?: string;\n    constructor(url: UrlObj, pageType?: PageTypeKey) {\n        switch (pageType) {\n            case 'web':\n                this.page_type = 2;\n                break;\n            case 'native':\n                this.page_type = 1;\n                break;\n            case 'mina':\n                this.page_type = 3;\n                break;\n            default:\n                this.page_type = 0; // unknown\n        }\n        this.update(url.page, url.params);\n    }\n\n    // 更新urlPackage\n    update(page: string = '', params?: any) {\n        if (page && page !== this.page) {\n            this.page = page;\n            this.identity = this.generatePageId(page);\n        }\n        if (params) {\n            this.params = Object.assign(this.params || {}, params);\n        }\n    }\n    toJSON() {\n        return {\n            page: this.page,\n            identity: this.identity,\n            page_type: this.page_type,\n            params: JSON.stringify(this.params),\n            category: this.category,\n        };\n    }\n    /**\n     * 生成页面唯一id\n     * 未自定义页面唯一ID生成方法，请自行添加后重新尝试\n     * @param page\n     */\n    generatePageId(page: string) {\n        return page + new Date().getTime();\n    }\n}\n","import type {\n    TaskEventOperationTypes,\n    PVOptions,\n    TaskOptions,\n    CustomOptions,\n    EventOptions,\n    ShowEventOptions,\n    UrlPage,\n} from '@/config/types';\nimport type { SendEventTypes } from '@/types/event';\nimport type { CurrentPageOptions, ElementShowEventOptions, CustomStatEventOptions, TaskEventOptions } from './types';\nimport { isKDSNative } from '@/util/ua';\n\nexport function logFactory(type: SendEventTypes, data: EventOptions) {\n    const {\n        action,\n        params,\n        eventId,\n        contentPackage,\n        currentUrlPackage,\n        status = 'SUCCESS',\n        name,\n        feedLogCtx,\n    } = data as ShowEventOptions;\n    if (type === 'PV') {\n        const { type: actionType, beginTime } = data as PVOptions;\n        return {\n            ...currentUrlPackage,\n            actionType,\n            contentPackage,\n            status,\n            beginTime,\n            eventId,\n            pageType: isKDSNative() ? 'NATIVE' : 'H5',\n        } as CurrentPageOptions;\n    }\n    let urlPage: UrlPage | undefined;\n    if (currentUrlPackage) {\n        const { page, params, identity, coPage } = currentUrlPackage;\n        urlPage = {\n            page,\n            params,\n            identity,\n            coPage,\n        };\n    }\n    if (['RADAR', 'CUSTOM', 'CUSTOM_EVENT'].includes(type)) {\n        const { key, value, biz } = data as CustomOptions;\n        return {\n            key,\n            value: JSON.stringify({\n                ...value,\n                url_package: currentUrlPackage,\n            }),\n            biz,\n            eventId,\n            urlPage\n        } as CustomStatEventOptions;\n    }\n    const elementLogParams: ElementShowEventOptions = {\n        action,\n        params: JSON.stringify(params),\n        contentPackage,\n        feedLogCtx,\n        eventId,\n        urlPage\n    };\n    if (type !== 'SHOW') {\n        const { type: taskType } = data as TaskOptions;\n        Object.assign(elementLogParams as TaskEventOptions, {\n            type: taskType || 'USER_OPERATION',\n            status: status || 'UNKNOWN_STATUS',\n            operationType: type as TaskEventOperationTypes,\n            operationDirection: 'UNKNOWN2',\n        });\n    }\n    return elementLogParams;\n}\n","import type { BaseWeblogInstance } from '@/types/index';\n\nexport abstract class BasePlugin {\n    declare weblog: BaseWeblogInstance;\n    abstract destroy(): void;\n    apply(weblog: BaseWeblogInstance) {\n        this.weblog = weblog;\n    }\n    /**\n     * 统一由 weblog 在页面关闭前调用的生命周期函数\n     */\n    beforeUnload?: (event: Event) => void;\n    static key: string;\n}\n\nexport interface BasePluginConstructor {\n    new(options?: any): any;\n    new(weblogger?: any, options?: any): any;\n    key: string;\n}\n/**\n * 在 bootstrap 环境下自动注册插件\n * @param Plugin\n * @param optionKey\n */\nexport const autoRegister = (Plugin: any, optionKey?: string) => {\n    if (\n        typeof window === 'undefined' ||\n        typeof window._GLOBAL_KS_WEBLOGGER_ === 'undefined' ||\n        typeof Plugin !== 'function') return;\n    const { weblog, config } = window._GLOBAL_KS_WEBLOGGER_;\n    let option = optionKey ? config.plugins[optionKey]?.options : undefined;\n    weblog.addPluginInstance(new Plugin(option));\n}\n","import type { BridgeWeblogInitParams } from '@/types/configuration';\nimport Weblog from '@/platform/hybrid/bridge';\nimport { BasePlugin } from '../plugins/base';\nexport type {\n    SupportTypes,\n    SendConfig,\n    PVOptions,\n    ShowOptions,\n    TaskOptions,\n    CustomOptions,\n    BaseOptions,\n    VideoEventOptions,\n} from './types';\nexport type LoggerConfigByUser = BridgeWeblogInitParams[0];\n\nexport type WeblogInitParams = BridgeWeblogInitParams;\n// 注册到全局对象\nif (typeof window !== 'undefined') {\n    if (typeof window._GLOBAL_KS_WEBLOGGER_ !== 'undefined') {\n        window._GLOBAL_KS_WEBLOGGER_.Factory = Weblog;\n    } else {\n        window.Weblog = Weblog;\n    }\n}\n\nexport {\n    Weblog,\n    BasePlugin,\n};\n\nexport default Weblog;"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","__assign","assign","t","s","i","n","arguments","length","apply","this","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","adopt","done","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","Symbol","iterator","v","op","TypeError","pop","push","__spreadArray","to","from","pack","ar","l","slice","concat","parseCookieString","text","shouldDecode","options","cookies","decodeValue","decodeURIComponent","cookieParts","split","cookieName","cookieValue","cookieNameValue","len","_a","match","substring","ex","prevCookie","cookiesMap","getCookie","name","force","window","document","curCookie","cookie","raw","err","cookieUtils","setCookie","encode","encodeURIComponent","expires","path","domain","Date","toUTCString","secure","createCookieString","error","args","_i","error_1","console","parseQueryString","queryString","queries_1","key","checkSupportCloseCoPage","version","undefined","recommendVersion","indexOf","matches","map","Number","rMajor","rMinor","rPatch","_b","major","minor","patch","checkVersion","getUrlAndQueryFromUrl","url","location","href","queryIndex","lastIndexOf","page","params","resolution","getResolution","ratio","devicePixelRatio","width","Math","floor","screen","height","supportsPushState","ua","navigator","userAgent","history","stringifyParams","JSON","stringify","runtimeIdMap","genId","localStorage","Storage","id","getItem","parse","getLocalStorageItem","setItem","setLocalStorageItem","oldApiTransformer","type","contentPackage","realType","toUpperCase","action","includes","customParams","invoke","isKDSNative","isSupportBridge","namespace","res","canUse","setClientLog","data","err_1","message","yodaUtils","sendRadarLog","err_2","sendWebLog","sendSummarizedLog","err_3","getWebviewLoadPerf","err_5","getKDSWebviewLoadPerf","err_7","isSupportBridgeLog","xhrErrorLog","send","callback","timeout","xhr","XMLHttpRequest","open","setRequestHeader","Uint8Array","onload","status","response","exception","error_msg","logXhrResponseCheck","ontimeout","onerror","invokeOrYoda","YodaStatus","UrlPackage","_super","pageType","urlMap","_this","obj","identity","generatePageId","init","String","__","constructor","create","__extends","urlPackage","pageId","parsed","mappingPage","getMappingPage","update","attachUrl","origin_url","origin_pathname","getRealUrlPackage","page_code","query","page_type","replace","c","r","random","toString","toJSON","category","getTime","pluginIndex","Weblogger","configOption","baseOption","plugins","entered","logConfig","commonPackage","CommonPackage","updateCurrentUrlPackage","addPlugins","__instance","defineProperty","get","yoda","getDefaultKpn","io","sendData","forEach","plugin","addPluginInstance","pluginInstance","weblog","plug","pluginOptions","collect","logType","logParams","sendImmediately","sendByBridge","eventType","eventOptions","immediately","configDisablePV","disablePV","biz","eventDisablePV","_c","bridgeFields","urlPage","setClientLogType","isPVEvent","_d","coPage_1","currentUrlPackage","coPage","test","pageUrlValidate","log","eventId","feedLogCtx","actionType","beginTime","url_package","elementLogParams","taskType","operationType","operationDirection","logFactory","isCustomType","increaseH5SeqId","_e","service_name","sub_biz","need_encrypt","h5ExtraAttr","getH5ExtraAttr","realtime","serviceName","subBiz","needEncrypt","container","customStatToCustom","updateReferUrlPackage","referUrlPackage","updateCommonPackage","flush","on","emit","option","h5_extra_attr","sdk_name","sdk_version","sdk_bundle","host_product","origin","app_version_name","bridge_info","getVersionName","app_package","version_name","isCustom","client_timestamp","abs","getPositiveInteger","now","seq_id","extraInfo","BasePlugin","_GLOBAL_KS_WEBLOGGER_","Factory","Weblog"],"mappings":"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"}